<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anime4U - عرض الأنميات</title>
    <link rel="icon" type="image/png" href="anime4u.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Unity Ads SDK -->
    <script src="https://webview.unityads.unity3d.com/webview.js"></script>
    <!-- App Scripts -->
    <script src="js/unity-ads-manager.js"></script>
    <script src="js/app-manager.js"></script>
    <script>
        try {
            if (localStorage.getItem('anime4u_initial_load_done') === '1') {
                document.documentElement.setAttribute('data-initial-loaded', 'true');
            }
        } catch (e) {}
    </script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        secondary: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75',
                        },
                        accent: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                        },
                        success: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d',
                        },
                        danger: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            200: '#fecaca',
                            300: '#fca5a5',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                            800: '#991b1b',
                            900: '#7f1d1d',
                        },
                        gray: {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                        }
                    },
                    fontFamily: {
                        'arabic': ['Cairo', 'Arial', 'sans-serif'],
                    },
                    animation: {
                        'spin-slow': 'spin 3s linear infinite',
                        'bounce-slow': 'bounce 2s infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'shimmer': 'shimmer 2s infinite',
                    },
                    keyframes: {
                        shimmer: {
                            '0%': { transform: 'translateX(-100%)' },
                            '100%': { transform: 'translateX(100%)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        [data-initial-loaded="true"] #animeContainer > div { display: none; }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #3b82f6;
            --secondary-color: #8b5cf6;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f97316;
            --info-color: #06b6d4;
            --dark-color: #1f2937;
            --light-color: #f8fafc;
            --white: #ffffff;
            --black: #000000;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --blue-50: #eff6ff;
            --blue-100: #dbeafe;
            --blue-200: #bfdbfe;
            --blue-300: #93c5fd;
            --blue-400: #60a5fa;
            --blue-500: #3b82f6;
            --blue-600: #2563eb;
            --blue-700: #1d4ed8;
            --blue-800: #1e40af;
            --blue-900: #1e3a8a;
            --purple-50: #faf5ff;
            --purple-100: #f3e8ff;
            --purple-200: #e9d5ff;
            --purple-300: #d8b4fe;
            --purple-400: #c084fc;
            --purple-500: #a855f7;
            --purple-600: #9333ea;
            --purple-700: #7c3aed;
            --purple-800: #6b21a8;
            --purple-900: #581c87;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
            --shadow-blue: 0 10px 25px -5px rgb(59 130 246 / 0.3);
            --shadow-purple: 0 10px 25px -5px rgb(139 92 246 / 0.3);
            --shadow-green: 0 10px 25px -5px rgb(16 185 129 / 0.3);
            --shadow-orange: 0 10px 25px -5px rgb(245 158 11 / 0.3);
            --shadow-red: 0 10px 25px -5px rgb(239 68 68 / 0.3);
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --gradient-success: linear-gradient(135deg, var(--success-color), #059669);
            --gradient-warning: linear-gradient(135deg, var(--warning-color), var(--accent-color));
            --gradient-danger: linear-gradient(135deg, var(--danger-color), #dc2626);
            --gradient-dark: linear-gradient(135deg, var(--gray-800), var(--gray-900));
            --gradient-light: linear-gradient(135deg, var(--white), var(--gray-50));
        }

        body {
            font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--gradient-light);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(16, 185, 129, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }



        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 50px;
            position: relative;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            position: relative;
        }

        .logo {
            width: 80px;
            height: 80px;
            margin-left: 20px;
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.3));
        }

        .logo:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-xl);
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 15px;
            text-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            color: #0f172a;
            letter-spacing: 1px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 10px;
            font-weight: 500;
            color: #1e293b;
        }

        .header .subtitle {
            font-size: 1rem;
            opacity: 0.8;
            font-style: italic;
            font-weight: 300;
            margin-bottom: 30px;
            color: #475569;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #0f172a;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 25px;
            border-radius: 15px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(15, 23, 42, 0.15);
        }

        .stat-item:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 12px 35px rgba(15, 23, 42, 0.15);
        }

        .stat-item i {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: #6366f1;
        }

        .stat-item span:first-of-type {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-item span:last-of-type {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .search-container {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .search-wrapper {
            position: relative;
            display: inline-block;
            width: 500px;
            max-width: 90%;
        }

        .search-input {
            width: 100%;
            padding: 15px 50px 15px 25px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            outline: none;
            box-shadow: var(--shadow-lg);
            background: white;
            transition: all 0.3s ease;
            font-family: 'Cairo', sans-serif;
            color: var(--gray-700);
        }

        .clear-search {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--gray-400);
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .clear-search:hover {
            color: var(--danger-color);
            background: var(--gray-100);
        }

        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow-xl);
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid var(--gray-100);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .suggestion-item:hover {
            background: var(--gray-100);
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-item img {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            object-fit: cover;
        }

        .search-input:focus {
            transform: scale(1.02);
            box-shadow: var(--shadow-xl);
        }

        .search-icon {
            position: absolute;
            left: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-size: 18px;
            z-index: 10;
        }

        .filters {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-family: 'Cairo', sans-serif;
        }

        .filter-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background: white;
            color: var(--primary-color);
            transform: scale(1.05);
            border-color: var(--primary-color) !important;
            box-shadow: 0 0 0 3px rgba(14,165,233,0.15), 0 10px 20px rgba(14,165,233,0.2);
        }

        /* تخصيص زر "الكل | جميع الأنميات" */
        .filter-btn[data-filter="all"] {
            background: #ffffff !important;
            color: #000000 !important;
            border-color: var(--secondary-color) !important;
            box-shadow: 0 0 0 3px rgba(217,70,239,0.3), 0 0 20px rgba(217,70,239,0.2), 0 10px 20px rgba(203,213,225,0.25);
        }
        .filter-btn[data-filter="all"].active {
            background: var(--secondary-color) !important;
            color: #ffffff !important;
            border-color: var(--secondary-color) !important;
            box-shadow: 0 0 0 4px rgba(217,70,239,0.18), 0 12px 24px rgba(217,70,239,0.3);
            transform: scale(1.05);
        }

        /* ألوان حالة التفعيل لكل زر فلتر */
        .filter-btn[data-filter="ongoing"].active {
            background: #22c55e !important; /* success-500 */
            color: #ffffff !important;
            border-color: #22c55e !important;
            box-shadow: 0 0 0 4px rgba(34,197,94,0.18), 0 12px 24px rgba(34,197,94,0.3);
        }
        .filter-btn[data-filter="completed"].active {
            background: #16a34a !important; /* green-600 */
            color: #ffffff !important;
            border-color: #16a34a !important;
            box-shadow: 0 0 0 4px rgba(22,163,74,0.18), 0 12px 24px rgba(22,163,74,0.3);
        }
        .filter-btn[data-filter="movie"].active {
            background: #f59e0b !important; /* orange-500 */
            color: #ffffff !important;
            border-color: #f59e0b !important;
            box-shadow: 0 0 0 4px rgba(245,158,11,0.18), 0 12px 24px rgba(245,158,11,0.3);
        }
        .filter-btn[data-filter="favorite"].active {
            background: #ef4444 !important; /* red-500 */
            color: #ffffff !important;
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 4px rgba(239,68,68,0.18), 0 12px 24px rgba(239,68,68,0.3);
        }

        .filter-btn i {
            margin-left: 8px;
            font-size: 14px;
        }

        /* تصميم البطاقات الجديد */
        .anime-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            padding: 20px 0;
        }

        .anime-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            aspect-ratio: 2/3;
            min-height: 200px;
            border: 2px solid rgba(255, 255, 255, 0.4);
            animation: cardFloat 0.6s ease both;
        }
        
        @keyframes cardFloat {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .anime-card:nth-child(1) { animation-delay: 0.1s; }
        .anime-card:nth-child(2) { animation-delay: 0.2s; }
        .anime-card:nth-child(3) { animation-delay: 0.3s; }
        .anime-card:nth-child(4) { animation-delay: 0.4s; }
        .anime-card:nth-child(5) { animation-delay: 0.5s; }

        .anime-card .favorite-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10;
            backdrop-filter: blur(15px);
            box-shadow: var(--shadow-sm);
        }

        .anime-card .favorite-btn:hover {
            background: var(--gradient-danger);
            border-color: var(--danger-color);
            transform: scale(1.15) rotate(5deg);
            box-shadow: var(--shadow-red);
        }

        .anime-card .favorite-btn.active {
            background: var(--gradient-danger);
            border-color: var(--danger-color);
            animation: heartBeat 1.5s ease-in-out infinite;
        }
        
        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1.15); }
            75% { transform: scale(1.1); }
        }
        
        .anime-card .favorite-btn i {
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .anime-card .favorite-btn:hover i {
            transform: scale(1.2);
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
        }

        .anime-card .status-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: var(--gradient-success);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 11px;
            font-weight: 700;
            backdrop-filter: blur(15px);
            box-shadow: var(--shadow-green);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
            z-index: 15;
        }

        .anime-card .status-badge.ongoing {
            background: var(--gradient-success);
            box-shadow: var(--shadow-green);
        }

        .anime-card .status-badge.completed {
            background: var(--gradient-danger);
            box-shadow: var(--shadow-red);
        }
        
        .anime-card .status-badge i {
            transition: all 0.3s ease;
            font-size: 12px;
        }
        
        .anime-card:hover .status-badge {
            transform: scale(1.1);
            box-shadow: var(--shadow-green), 0 0 20px rgba(16, 185, 129, 0.4);
        }
        
        .anime-card:hover .status-badge.ongoing {
            box-shadow: var(--shadow-orange), 0 0 20px rgba(245, 158, 11, 0.4);
        }
        
        .anime-card:hover .status-badge i {
            transform: scale(1.2) rotate(5deg);
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
        }

        .anime-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: var(--shadow-2xl), 0 0 40px rgba(139, 92, 246, 0.2);
            border-color: var(--purple-300);
        }
        
        .anime-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(139, 92, 246, 0.05) 0%, 
                rgba(59, 130, 246, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 1;
            pointer-events: none;
        }
        
        .anime-card:hover::before {
            opacity: 1;
        }

        .anime-image-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .anime-image-container .img-placeholder {
            display: none;
            width: 100%;
            height: 100%;
            color: #ccc;
            font-size: 1.2rem;
            align-items: center;
            justify-content: center;
            background: #f3f4f6;
        }

        .anime-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            filter: brightness(0.9);
        }

        .anime-card:hover .anime-image {
            transform: scale(1.1) rotate(1deg);
            filter: brightness(1.1) contrast(1.1);
        }
        
        .anime-image::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(139, 92, 246, 0.1) 0%, 
                transparent 50%);
            opacity: 0;
            transition: opacity 0.4s ease;
            pointer-events: none;
        }
        
        .anime-card:hover .anime-image::after {
            opacity: 1;
        }

        .anime-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: var(--shadow-2xl), 0 0 40px rgba(139, 92, 246, 0.2);
            border-color: var(--purple-300);
        }
        
        .anime-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(139, 92, 246, 0.05) 0%, 
                rgba(59, 130, 246, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 1;
            pointer-events: none;
        }
        
        .anime-card:hover::before {
            opacity: 1;
        }

        .episode-badge {
            position: absolute;
            bottom: 12px;
            right: 12px;
            background: var(--gradient-dark);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            box-shadow: var(--shadow-lg);
        }
        
        .anime-card:hover .episode-badge {
            transform: scale(1.1);
            background: var(--gradient-primary);
            border-color: var(--primary-color);
            box-shadow: var(--shadow-blue), 0 0 20px rgba(59, 130, 246, 0.4);
        }

        .anime-info {
            padding: 16px;
            height: auto;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to top, 
                rgba(0,0,0,0.8) 0%, 
                rgba(0,0,0,0.6) 40%, 
                rgba(0,0,0,0.3) 70%, 
                rgba(0,0,0,0) 100%);
            color: #fff;
            backdrop-filter: blur(10px);
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
        }
        
        .anime-title {
            font-size: 15px;
            font-weight: 700;
            color: #ffffff;
            line-height: 1.4;
            margin-bottom: 10px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-shadow: 0 2px 4px rgba(0,0,0,0.9);
            transition: all 0.3s ease;
        }
        
        .anime-card:hover .anime-title {
            text-shadow: 0 3px 6px rgba(0,0,0,0.9), 0 0 20px rgba(139, 92, 246, 0.5);
            transform: translateY(-2px);
        }

        .rating-container {
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .anime-card:hover .rating-container {
            transform: scale(1.05);
        }

        .stars {
            display: flex;
            gap: 3px;
        }

        .star {
            color: var(--accent-color);
            font-size: 13px;
            filter: drop-shadow(0 1px 3px rgba(0,0,0,0.8));
            transition: all 0.3s ease;
        }
        
        .anime-card:hover .star {
            color: #fbbf24;
            filter: drop-shadow(0 2px 6px rgba(251, 191, 36, 0.8));
            transform: scale(1.1);
        }

        .rating-text {
            font-size: 13px;
            font-weight: 600;
            color: #ffffff;
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
            transition: all 0.3s ease;
        }
        
        .anime-card:hover .rating-text {
            text-shadow: 0 2px 6px rgba(0,0,0,0.9), 0 0 15px rgba(139, 92, 246, 0.6);
        }

        .loading {
            text-align: center;
            color: var(--gray-800);
            font-size: 1.5rem;
            margin: 0;
            padding: 80px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            min-height: 60vh;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.1), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .loading i {
            font-size: 4rem;
            margin-bottom: 25px;
            color: var(--primary-color);
            animation: spin 1.5s linear infinite;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 4px 8px rgba(139, 92, 246, 0.3));
        }

        .loading-text {
            font-size: 1.6rem;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .loading-progress {
            font-size: 1rem;
            color: var(--gray-600);
            font-weight: 600;
            background: rgba(139, 92, 246, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid rgba(139, 92, 246, 0.2);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
        }

        /* ===== تجاوب رسالة التحميل ===== */
        @media (max-width: 1200px) {
            .loading {
                min-height: 55vh;
                padding: 70px 18px;
            }

            .loading i {
                font-size: 3.5rem;
                margin-bottom: 22px;
            }

            .loading-text {
                font-size: 1.5rem;
                margin-bottom: 14px;
            }

            .loading-progress {
                font-size: 0.95rem;
                padding: 7px 14px;
            }
        }
        
        /* ===== تحسينات رسالة التحميل الجديدة ===== */
        .loading-container {
            position: relative;
            overflow: hidden;
        }
        
        .loading-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            animation: rotate 8s linear infinite;
        }
        
        .loading-container::after {
            content: '';
            position: absolute;
            inset: 2px;
            background: inherit;
            border-radius: inherit;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .loading-dots {
            display: inline-block;
            animation: loadingDots 1.5s infinite;
        }
        
        .loading-dots::after {
            content: '...';
            animation: loadingDots 1.5s infinite;
        }
        
        @keyframes loadingDots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        
        .loading-glow {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(59, 130, 246, 0.3); }
            to { box-shadow: 0 0 30px rgba(139, 92, 246, 0.5), 0 0 40px rgba(59, 130, 246, 0.3); }
        }

        @media (max-width: 992px) {
            .loading {
                min-height: 50vh;
                padding: 60px 16px;
            }

            .loading i {
                font-size: 3.2rem;
                margin-bottom: 20px;
            }

            .loading-text {
                font-size: 1.4rem;
                margin-bottom: 12px;
            }

            .loading-progress {
                font-size: 0.9rem;
                padding: 6px 12px;
            }
        }

        @media (max-width: 768px) {
            .loading {
                min-height: 45vh;
                padding: 50px 15px;
                border-radius: 15px;
            }

            .loading i {
                font-size: 3rem;
                margin-bottom: 18px;
            }

            .loading-text {
                font-size: 1.3rem;
                margin-bottom: 10px;
            }

            .loading-progress {
                font-size: 0.85rem;
                padding: 5px 10px;
            }
        }

        @media (max-width: 480px) {
            .loading {
                min-height: 40vh;
                padding: 40px 12px;
                border-radius: 12px;
            }

            .loading i {
                font-size: 2.5rem;
                margin-bottom: 15px;
            }

            .loading-text {
                font-size: 1.2rem;
                margin-bottom: 8px;
            }

            .loading-progress {
                font-size: 0.8rem;
                padding: 4px 8px;
            }
        }

        @media (max-width: 360px) {
            .loading {
                min-height: 35vh;
                padding: 30px 10px;
                border-radius: 10px;
            }

            .loading i {
                font-size: 2.2rem;
                margin-bottom: 12px;
            }

            .loading-text {
                font-size: 1.1rem;
                margin-bottom: 6px;
            }

            .loading-progress {
                font-size: 0.75rem;
                padding: 3px 6px;
            }
        }

        .error {
            text-align: center;
            color: var(--danger-color);
            background: white;
            padding: 40px;
            border-radius: 16px;
            margin: 40px 0;
            box-shadow: var(--shadow-lg);
        }

        .error i {
            font-size: 3rem;
            margin-bottom: 20px;
            color: var(--danger-color);
        }

        /* التجاوب */
        @media (max-width: 1400px) {
            .anime-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 20px;
            }
        }
        
        @media (max-width: 1200px) {
            .anime-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 18px;
            }
            
            .anime-card {
                aspect-ratio: 2/3;
            }
            
            .anime-title {
                font-size: 14px;
            }
        }

        @media (max-width: 992px) {
            .anime-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 16px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .anime-card {
                aspect-ratio: 2/3;
            }
            
            .anime-title {
                font-size: 14px;
            }
            
            .episode-badge {
                width: 34px;
                height: 34px;
                font-size: 11px;
            }
            
            .anime-card .favorite-btn {
                width: 34px;
                height: 34px;
            }
            
            .anime-card .status-badge {
                font-size: 10px;
                padding: 5px 10px;
            }
        }

        @media (max-width: 768px) {
            .anime-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 14px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .logo {
                width: 60px;
                height: 60px;
            }
            
            .search-input {
                padding: 12px 20px;
                font-size: 14px;
            }
            
            .filters {
                gap: 10px;
            }
            
            .filter-btn {
                padding: 10px 18px;
                font-size: 13px;
            }

            .stats {
                gap: 20px;
            }

            .stat-item {
                padding: 10px 15px;
            }

            .stat-item span:first-of-type {
                font-size: 1.5rem;
            }
            
            .anime-card {
                aspect-ratio: 3/4;
            }
            
            .anime-title {
                font-size: 13px;
                -webkit-line-clamp: 2;
            }
            
            .rating-container {
                gap: 4px;
            }
            
            .stars {
                gap: 1px;
            }
            
            .star {
                font-size: 11px;
            }
            
            .rating-text {
                font-size: 11px;
            }
            
            .episode-badge {
                width: 32px;
                height: 32px;
                font-size: 10px;
                bottom: 8px;
                right: 8px;
            }
            
            .anime-card .favorite-btn {
                width: 32px;
                height: 32px;
                top: 8px;
                right: 8px;
            }
            
            .anime-card .status-badge {
                top: 8px;
                left: 8px;
                font-size: 9px;
                padding: 4px 8px;
            }
        }

        @media (max-width: 480px) {
            .anime-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            body {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .search-input {
                width: 100%;
                padding: 10px 18px;
                font-size: 14px;
            }
            
            .filters {
                flex-direction: column;
                align-items: center;
            }
            
            .filter-btn {
                width: 200px;
            }
            
            .anime-card {
                aspect-ratio: 2/3;
            }
            
            .anime-title {
                font-size: 12px;
                margin-bottom: 6px;
            }
            
            .anime-info {
                padding: 12px;
            }
            
            .episode-badge {
                width: 30px;
                height: 30px;
                font-size: 9px;
                bottom: 6px;
                right: 6px;
            }
            
            .anime-card .favorite-btn {
                width: 30px;
                height: 30px;
                top: 6px;
                right: 6px;
            }
            
            .anime-card .favorite-btn i {
                font-size: 12px;
            }
            
            .anime-card .status-badge {
                top: 6px;
                left: 6px;
                font-size: 8px;
                padding: 3px 6px;
            }
            
            .stats {
                gap: 15px;
            }
            
            .stat-item {
                padding: 8px 12px;
            }
            
            .stat-item span:first-of-type {
                font-size: 1.3rem;
            }
            
            .stat-item span:last-of-type {
                font-size: 0.8rem;
            }
        }
        
        @media (max-width: 360px) {
            .anime-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .anime-card {
                aspect-ratio: 2/3;
            }
            
            .anime-title {
                font-size: 11px;
            }
            
            .episode-badge {
                width: 28px;
                height: 28px;
                font-size: 8px;
                bottom: 6px;
                right: 6px;
            }
            
            .anime-card .favorite-btn {
                width: 28px;
                height: 28px;
                top: 6px;
                right: 6px;
            }
            
            .anime-card .status-badge {
                top: 6px;
                left: 6px;
                font-size: 7px;
                padding: 2px 5px;
            }
        }

        /* خلفية أورورا متحركة لطيفة */
        .bg-aurora { display: none; }

        @keyframes auroraMove {
            0% { transform: translate3d(0, 0, 0) scale(1); }
            50% { transform: translate3d(0, -10px, 0) scale(1.02); opacity: 0.65; }
            100% { transform: translate3d(0, 10px, 0) scale(1.03); opacity: 0.7; }
        }

        /* تحسينات أيقونات البحث */
        .search-icon { transition: transform 0.25s ease, color 0.25s ease, filter 0.25s ease; }
        .search-wrapper:focus-within .search-icon { transform: translateY(-50%) scale(1.1); color: var(--secondary-color); filter: drop-shadow(0 2px 6px rgba(139, 92, 246, 0.5)); }

        /* دوران لطيف لزر مسح البحث */
        .clear-search i { transition: transform 0.25s ease; }
        .clear-search:hover i { transform: rotate(90deg); }

        /* تفاعل أيقونات الفلاتر */
        .filter-btn i { transition: transform 0.25s ease, color 0.25s ease; }
        .filter-btn:hover i { transform: translateY(-1px) rotate(8deg); color: var(--accent-color); }

        /* أنيميشن دخول للبطاقات */
        .anime-card { animation: cardFade 0.6s ease both; }
        @keyframes cardFade { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* نبضة لأيقونة المفضلة عند التفعيل */
        .anime-card .favorite-btn i { transition: transform 0.2s ease; }
        .anime-card .favorite-btn:active i, .anime-card .favorite-btn.active i { transform: scale(1.15); }

        /* تعويم خفيف لعناصر الإحصاءات */
        .stats .stat-item { animation: floatY 10s ease-in-out infinite; }
        .stats .stat-item:nth-child(2) { animation-delay: 1.5s; }
        .stats .stat-item:nth-child(3) { animation-delay: 3s; }
        @keyframes floatY { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }

        /* شريط علوي */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            background: var(--gradient-primary);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: var(--shadow-blue);
            z-index: 100;
            backdrop-filter: blur(20px);
        }
        
        .top-nav::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.9) 0%, 
                rgba(139, 92, 246, 0.9) 100%);
            z-index: -1;
        }
        
        .top-nav::after { 
            content: ''; 
            position: absolute; 
            bottom: 0; 
            left: 0; 
            right: 0; 
            height: 3px; 
            background: linear-gradient(90deg, var(--accent-color), var(--success-color), var(--warning-color)); 
            opacity: 0.9;
            animation: rainbowShift 3s ease-in-out infinite;
        }
        
        @keyframes rainbowShift {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(180deg); }
        }

        .top-nav .nav-title { color: #ffffff; font-weight: 900; letter-spacing: 0; font-size: 16px; }

        .nav-icon-btn {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: var(--primary-color);
            width: 44px;
            height: 44px;
            border-radius: 14px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .nav-icon-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s ease;
        }
        
        .nav-icon-btn:hover::before {
            left: 100%;
        }
        
        .nav-icon-btn i {
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
            font-size: 18px;
        }

        .nav-icon-btn:hover { 
            transform: translateY(-3px) scale(1.05); 
            background: rgba(255, 255, 255, 1); 
            border-color: var(--accent-color); 
            color: var(--accent-color); 
            box-shadow: var(--shadow-orange);
        }
        
        .nav-icon-btn:hover i {
            transform: scale(1.2) rotate(5deg);
            filter: drop-shadow(0 0 8px rgba(245, 158, 11, 0.6));
        }
        .nav-icon-btn:focus-visible { outline: none; box-shadow: 0 0 0 4px rgba(99,102,241,0.18); }

        .top-nav .nav-actions { display: flex; align-items: center; gap: 10px; }

        /* شريط علوي متجاوب */
        @media (max-width: 768px) {
            .top-nav { height: 64px; padding: 0 12px; }
            .nav-icon-btn { width: 36px; height: 36px; border-radius: 10px; }
            .top-nav .nav-title { font-size: 14px; font-weight: 800; }
            
            /* تحسين القائمة الجانبية للموبايل */
            .sidebar {
                width: min(92vw, 360px);
                top: 64px;
            }
            
            .sidebar-logo {
                width: 50px;
                height: 50px;
            }
            
            .sidebar-header {
                padding: 16px 12px;
            }
            
            .sidebar-header span {
                font-size: 13px;
            }
            
            .sidebar-close-btn {
                width: 28px;
                height: 28px;
                top: 8px;
                right: 8px;
            }
            
            .sidebar .filter-btn {
                padding: 10px 14px;
                font-size: 13px;
                margin-bottom: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .sidebar {
                width: 95vw;
                top: 64px;
            }
            
            .sidebar-logo {
                width: 45px;
                height: 45px;
            }
            
            .sidebar-header {
                padding: 14px 10px;
            }
            
            .sidebar-header span {
                font-size: 12px;
            }
            
            .sidebar .filter-btn {
                padding: 8px 12px;
                font-size: 12px;
                margin-bottom: 8px;
            }
        }

        /* نافذة البحث كقائمة منسدلة أسفل الشريط العلوي */
        .search-modal-backdrop {
            position: fixed;
            inset: 0;
            background: transparent;
            display: none;
            z-index: 2000;
        }
        .search-modal-backdrop.show { display: block; }

        .search-modal {
            position: fixed;
            top: 78px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(11, 18, 32, 0.95);
            backdrop-filter: blur(25px);
            width: min(800px, 94vw);
            border-radius: 8px;
            border: 1px solid rgba(31, 41, 55, 0.8);
            box-shadow: 0 18px 36px rgba(0,0,0,0.35);
            padding: 14px;
        }
        .search-modal-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
        .search-modal-title { font-weight: 800; color: #f9fafb; }
        .search-close-btn { background: transparent; color: #e5e7eb; border: 1px solid #334155; width: 36px; height: 36px; border-radius: 8px; display: inline-flex; align-items: center; justify-content: center; cursor: pointer; }
        .search-close-btn:hover { background: #111827; }

        .search-modal .search-wrapper { position: relative; width: 100%; }
        .search-modal .search-input { width: 100%; padding: 14px 44px 14px 14px; border: 1px solid #334155; border-radius: 8px; outline: none; font-size: 14px; color: #e5e7eb; background: #0f172a; }
        .search-modal .search-input::placeholder { color: #94a3b8; }
        .search-modal .search-input:focus { border-color: var(--primary-color); box-shadow: 0 0 0 4px rgba(99,102,241,0.15); }
        .search-modal .search-icon { left: auto; right: 14px; top: 50%; transform: translateY(-50%); color: #94a3b8; }
        .search-modal .clear-search { position: absolute; left: 10px; right: auto; top: 50%; transform: translateY(-50%); color: #94a3b8; }
        .search-modal .clear-search:hover { color: #e5e7eb; }
        .search-modal .search-suggestions { position: static; box-shadow: none; border: 1px solid #1f2937; background: #0f172a; margin-top: 10px; display: block; max-height: 260px; border-radius: 8px; overflow: hidden; }
        .search-modal .suggestion-item { background: transparent; color: #e5e7eb; border-bottom: 1px solid #1f2937; }
        .search-modal .suggestion-item:hover { background: #111827; }
        .search-modal .suggestion-item:last-child { border-bottom: none; }

        @media (max-width: 768px) {
            .search-modal { top: 70px; width: 94vw; border-radius: 8px; }
        }

        /* القائمة الجانبية */
        .sidebar {
            position: fixed;
            top: 70px;
            right: 0;
            width: min(90vw, 350px);
            height: calc(100vh - 70px);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(30px);
            box-shadow: var(--shadow-purple);
            transform: translateX(100%);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 101;
            display: flex;
            flex-direction: column;
            border-left: 2px solid rgba(139, 92, 246, 0.3);
            border-top-left-radius: 20px;
            border-bottom-left-radius: 20px;
            overflow: hidden;
        }
        
        .sidebar.open {
            transform: translateX(0);
            box-shadow: var(--shadow-purple), 0 0 50px rgba(139, 92, 246, 0.2);
        }

        .sidebar.open { transform: translateX(0); }

        .sidebar-header { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            padding: 20px 16px; 
            border-bottom: 1px solid var(--gray-200); 
            text-align: center;
        }
        
        .sidebar-logo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-bottom: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 3px solid rgba(99, 102, 241, 0.2);
        }
        
        .sidebar-logo:hover {
            transform: scale(1.1);
            border-color: var(--primary-color);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.3);
        }
        
        .sidebar-header span { 
            font-weight: 800; 
            color: var(--gray-800); 
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .sidebar-close-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            color: #ef4444;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .sidebar-close-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.4);
            transform: scale(1.1);
        }

        .sidebar-content { padding: 12px; overflow-y: auto; }
        .sidebar .filter-btn {
            width: 100%;
            margin-bottom: 16px;
            justify-content: flex-start;
            background: var(--gradient-light);
            color: var(--gray-700);
            border: 2px solid var(--gray-200);
            padding: 16px 20px;
            border-radius: 16px;
            font-size: clamp(14px, 1.8vw, 16px);
            font-weight: 600;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .sidebar .filter-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.1), transparent);
            transition: left 0.6s ease;
        }
        
        .sidebar .filter-btn:hover::before {
            left: 100%;
        }
        
        .sidebar .filter-btn i {
            width: 22px;
            text-align: center;
            margin-left: 14px;
            font-size: clamp(16px, 2.8vw, 20px);
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
        }

        /* Responsive scaling for sidebar filter content */
        .sidebar .filter-btn .filter-icon-box {
            width: clamp(36px, 7vw, 44px);
            height: clamp(36px, 7vw, 44px);
        }

        .sidebar .filter-btn .filter-icon {
            font-size: clamp(16px, 2.8vw, 20px);
        }

        .sidebar .filter-btn .filter-title {
            font-size: clamp(14px, 2.2vw, 18px);
            line-height: 1.2;
        }

        .sidebar .filter-btn .filter-subtitle {
            font-size: clamp(11px, 1.8vw, 14px);
        }

        .sidebar .filter-btn .filter-badge {
            font-size: clamp(10px, 1.6vw, 12px);
            padding: clamp(4px, 0.9vw, 6px) clamp(8px, 1.2vw, 12px);
            border-radius: 9999px;
        }
        
        .sidebar .filter-btn:hover {
            background: var(--white);
            border-color: var(--purple-300);
            transform: translateX(-5px) scale(1.02);
            box-shadow: var(--shadow-purple);
        }
        
        .sidebar .filter-btn:hover i {
            transform: scale(1.2) rotate(8deg);
            color: var(--purple-600);
            filter: drop-shadow(0 0 8px rgba(139, 92, 246, 0.4));
        }
        
        .sidebar .filter-btn.active { 
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); 
            color: white; 
            border-color: transparent; 
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
            transform: translateX(-5px) scale(1.02);
            position: relative;
            overflow: hidden;
        }
        
        .sidebar .filter-btn.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: activeShine 2s ease-in-out infinite;
        }
        
        .sidebar .filter-btn.active i {
            transform: scale(1.1);
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
            animation: activeIconPulse 2s ease-in-out infinite;
            color: white;
        }
        
        .sidebar .filter-btn.active span {
            color: white;
            font-weight: 700;
        }
        
        /* تحسينات إضافية للقائمة الجانبية */
        .sidebar {
            scrollbar-width: thin;
            scrollbar-color: rgba(14, 165, 233, 0.3) transparent;
        }
        
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }
        
        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(14, 165, 233, 0.3);
            border-radius: 3px;
        }
        
        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(14, 165, 233, 0.5);
        }
        
        /* تحسينات الفلاتر */
        .filter-btn {
            position: relative;
            overflow: hidden;
        }
        
        .filter-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .filter-btn:hover::before {
            left: 100%;
        }
        
        .filter-btn.active::before {
            animation: activeShine 2s infinite;
        }
        
        /* تحسينات الإحصائيات */
        .sidebar .grid > div {
            position: relative;
            overflow: hidden;
        }
        
        .sidebar .grid > div::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
        
        .sidebar .grid > div:hover::after {
            transform: translateX(100%);
        }
        
        @keyframes activeShine {
            0% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
            100% { transform: translateX(100%); }
        }
        
        @keyframes activeIconPulse {
            0%, 100% { transform: scale(1.1); }
            50% { transform: scale(1.2); }
        }

        .sidebar-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.45);
            backdrop-filter: blur(2px);
            z-index: 100;
            display: none;
        }
        .sidebar-backdrop.show { display: block; }

        /* تحسينات التجاوب للقائمة الجانبية */
        @media (max-width: 1024px) {
            .sidebar {
                width: min(95vw, 380px);
                top: 60px;
                height: calc(100vh - 60px);
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100vw;
                top: 0;
                height: 100vh;
                border-radius: 0;
                border-left: none;
            }
            
            .sidebar-header {
                padding: 16px 12px;
            }
            
            .sidebar-logo {
                width: 50px;
                height: 50px;
            }
            
            .sidebar-content {
                padding: 16px 12px;
            }
        }

        @media (max-width: 640px) {
            .sidebar {
                width: 100vw;
            }
            
            .sidebar-header {
                padding: 14px 10px;
            }
            
            .sidebar-content {
                padding: 14px 10px;
            }
        }

        @media (max-width: 480px) {
            .sidebar {
                width: 100vw;
            }
            
            .sidebar-header {
                padding: 12px 8px;
            }
            
            .sidebar-content {
                padding: 12px 8px;
            }
        }

        /* تحسينات خاصة بالأجهزة اللوحية */
        @media (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
            .sidebar {
                width: min(85vw, 400px);
                top: 50px;
                height: calc(100vh - 50px);
            }
        }

        @media (min-width: 768px) and (max-width: 1024px) and (orientation: portrait) {
            .sidebar {
                width: min(92vw, 360px);
                top: 65px;
                height: calc(100vh - 65px);
            }
        }

        /* ===== أنميات صفحة تفاصيل الأنمي المحسنة ===== */
        .anime-details-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            overflow-y: auto;
            z-index: 2000;
        }

        .anime-details-header {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 10;
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
            backdrop-filter: blur(20px);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1.5rem;
        }

        .back-btn {
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 600;
            font-size: 0.95rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.25);
            transform: translateX(0.5rem);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .anime-title h1 {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            font-weight: 900;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
            text-align: center;
            flex: 1;
            line-height: 1.2;
        }

        .favorite-btn-header {
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .favorite-btn-header:hover {
            background: rgba(255,255,255,0.25);
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .favorite-btn-header.active {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-color: #ef4444;
            animation: heartBeat 1.5s ease-in-out infinite;
        }

        /* ===== حاوية الأزرار ===== */
        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* ===== زر الإعجاب ===== */
        .like-btn-header {
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .like-btn-header:hover {
            background: rgba(255,255,255,0.25);
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .like-btn-header.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-color: #10b981;
            animation: likePulse 1.5s ease-in-out infinite;
        }

        .like-btn-header.active i {
            color: white;
        }

        @keyframes likePulse {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1.15); }
            75% { transform: scale(1.1); }
        }

        /* ===== رسالة الإعجاب ===== */
        .like-toast {
            position: fixed;
            top: 100px;
            right: 20px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 2rem;
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 600;
            font-size: 1rem;
            z-index: 10000;
            transform: translateX(400px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .like-toast.show {
            transform: translateX(0);
        }

        .like-toast i {
            font-size: 1.125rem;
            animation: bounce 0.6s ease-in-out;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1.15); }
            75% { transform: scale(1.1); }
        }

        .anime-details-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2.5rem 1.5rem;
        }

        .anime-hero-section {
            display: grid;
            grid-template-columns: minmax(300px, 400px) 1fr;
            gap: 3rem;
            margin-bottom: 3rem;
            align-items: start;
        }

        .anime-cover-large {
            position: relative;
            overflow: hidden;
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .anime-cover-large img {
            width: 100%;
            height: 500px;
            object-fit: cover;
            border-radius: 1.5rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .anime-cover-large:hover img {
            transform: scale(1.05);
        }

        .anime-cover-large::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .anime-cover-large:hover::after {
            opacity: 1;
        }

        .no-image-large {
            width: 100%;
            height: 500px;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border-radius: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 4rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border: 2px dashed #cbd5e1;
        }

        .anime-info-panel {
            background: rgba(255,255,255,0.95);
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.4);
            transition: all 0.3s ease;
        }

        .anime-info-panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .anime-meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 1.5rem;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 1rem;
            border: 2px solid #e2e8f0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .meta-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .meta-item:hover::before {
            left: 100%;
        }

        .meta-item:hover {
            border-color: #3b82f6;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.15);
        }

        .meta-item i {
            font-size: 1.75rem;
            color: #3b82f6;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
        }

        .meta-item:hover i {
            transform: scale(1.1);
            color: #2563eb;
        }

        .meta-label {
            font-size: 0.875rem;
            color: #64748b;
            margin-bottom: 0.5rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .meta-value {
            font-size: 1.125rem;
            font-weight: 700;
            color: #1e293b;
            position: relative;
            z-index: 2;
        }

        .meta-value.ongoing {
            color: #059669;
        }

        .meta-value.completed {
            color: #dc2626;
        }

        .rating-value {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .stars-inline {
            display: flex;
            gap: 0.25rem;
        }

        .stars-inline .star {
            color: #fbbf24;
            font-size: 1rem;
            filter: drop-shadow(0 1px 3px rgba(251, 191, 36, 0.3));
        }

        .rating-number {
            font-size: 1.25rem;
            color: #f59e0b;
            font-weight: 800;
        }

        /* قسم التصنيفات */
        .anime-genres-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
            border-radius: 1rem;
            border: 1px solid rgba(59, 130, 246, 0.1);
            transition: all 0.3s ease;
        }

        .anime-genres-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.1);
        }

        .anime-genres-section h3 {
            color: #374151;
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .anime-genres-section h3 i {
            color: #3b82f6;
        }

        .genres-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .genre-tag {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
            border: 2px solid transparent;
            cursor: pointer;
        }

        .genre-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .genre-tag:active {
            transform: translateY(0);
        }

        .anime-story-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid #e2e8f0;
        }

        .anime-story-section h3 {
            color: #1e293b;
            font-size: 1.5rem;
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 800;
        }

        .anime-story-section h3 i {
            color: #3b82f6;
            font-size: 1.25rem;
        }

        .anime-story-section p {
            color: #475569;
            line-height: 1.8;
            font-size: 1.125rem;
            text-align: justify;
            font-weight: 500;
        }

        .episodes-section {
            background: rgba(255,255,255,0.95);
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.4);
            transition: all 0.3s ease;
        }

        /* ===== شريط البحث عن الحلقات ===== */
        .episodes-search-container {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 1rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .episodes-search-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            background: white;
            border-radius: 2rem;
            padding: 0.75rem 1.25rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .episodes-search-wrapper:focus-within {
            border-color: #3b82f6;
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
            transform: translateY(-2px);
        }

        .episodes-search-icon {
            color: #64748b;
            font-size: 1.125rem;
            margin-right: 0.75rem;
            transition: all 0.3s ease;
        }

        .episodes-search-wrapper:focus-within .episodes-search-icon {
            color: #3b82f6;
            transform: scale(1.1);
        }

        .episodes-search-input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 1rem;
            color: #1e293b;
            background: transparent;
            font-weight: 500;
        }

        .episodes-search-input::placeholder {
            color: #94a3b8;
            font-weight: 400;
        }

        .episodes-clear-search {
            background: #f1f5f9;
            border: none;
            color: #64748b;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            margin-right: 0.5rem;
        }

        .episodes-clear-search:hover {
            background: #e2e8f0;
            color: #475569;
            transform: scale(1.1);
        }

        .episodes-clear-search i {
            font-size: 0.875rem;
        }

        .episodes-search-stats {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            background: white;
            border-radius: 1rem;
            border: 1px solid #e2e8f0;
        }

        .episodes-found-count,
        .episodes-filtered-count {
            font-size: 0.875rem;
            font-weight: 600;
            color: #64748b;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .episodes-found-count::before {
            content: '📺';
            font-size: 1rem;
        }

        .episodes-filtered-count::before {
            content: '🔍';
            font-size: 1rem;
        }

        .episodes-filtered-count.active {
            color: #059669;
        }

        .episodes-found-count.active {
            color: #3b82f6;
        }

        /* ===== رسالة عدم وجود نتائج ===== */
        .no-results-message {
            text-align: center;
            color: #64748b;
            padding: 3rem 2rem;
            grid-column: 1 / -1;
            background: #f8fafc;
            border-radius: 1rem;
            border: 2px dashed #cbd5e1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .no-results-message i {
            font-size: 3rem;
            color: #94a3b8;
            margin-bottom: 0.5rem;
        }

        .no-results-message p {
            font-size: 1.125rem;
            font-weight: 500;
            margin: 0;
        }

        .clear-search-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .clear-search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .clear-search-btn i {
            font-size: 0.875rem;
        }

        .episodes-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #e2e8f0;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .section-header h2 {
            color: #1e293b;
            font-size: 1.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 800;
        }

        .section-header h2 i {
            color: #3b82f6;
            font-size: 1.5rem;
        }

        .episodes-count {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            font-weight: 700;
            font-size: 0.875rem;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .episodes-count i {
            font-size: 1rem;
        }

        .episodes-grid-enhanced {
            display: flex;
            overflow-x: auto;
            gap: 1rem;
            padding: 1rem;
            scroll-behavior: smooth;
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 #f1f5f9;
            -webkit-overflow-scrolling: touch;
            scroll-snap-type: x mandatory;
            position: relative;
            width: 100%;
        }

        .episodes-grid-enhanced::-webkit-scrollbar {
            height: 8px;
        }

        .episodes-grid-enhanced::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .episodes-grid-enhanced::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .episodes-grid-enhanced::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .episodes-grid-enhanced::-webkit-scrollbar {
            height: 8px;
        }

        .episodes-grid-enhanced::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .episodes-grid-enhanced::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .episodes-grid-enhanced::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .episodes-grid-enhanced .episode-card {
            flex: 0 0 auto;
            min-width: 280px;
            max-width: 320px;
            scroll-snap-align: start;
            transition: transform 0.2s ease;
        }

        .episodes-grid-enhanced .episode-card:hover {
            transform: translateY(-2px);
        }

        /* ===== حاوية تمرير الحلقات ===== */
        .episodes-scroll-container {
            position: relative;
            display: block;
            width: 100%;
        }

        .episodes-scroll-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            border: none;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            flex-shrink: 0;
            z-index: 5;
        }

        .episodes-scroll-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .episodes-scroll-btn:active {
            transform: scale(0.95);
        }

        .episodes-scroll-btn i {
            font-size: 1.125rem;
            font-weight: 700;
        }

        .episodes-scroll-btn:disabled {
            background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
            cursor: not-allowed;
            opacity: 0.6;
            transform: none;
            box-shadow: none;
        }

        .episodes-scroll-btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        /* تحسينات إضافية لأزرار التمرير */
        .episodes-scroll-btn:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }

        .episodes-scroll-btn:active:not(:disabled) {
            transform: scale(0.95);
        }

        .episode-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
            aspect-ratio: 2/3;
            min-height: 280px;
        }

        .episode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.05), transparent);
            transition: left 0.6s ease;
        }

        /* ===== صورة الحلقة ===== */
        .episode-image {
            position: relative;
            width: 100%;
            height: 60%;
            overflow: hidden;
            border-radius: 1rem 1rem 0 0;
        }

        .episode-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .episode-card:hover .episode-image img {
            transform: scale(1.1);
        }

        .episode-image-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 2rem;
        }

        .episode-content {
            flex: 1;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .episode-card:hover::before {
            left: 100%;
        }

        .episode-card:hover {
            border-color: #3b82f6;
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(59, 130, 246, 0.15);
        }

        .episode-number {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1rem;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            transition: all 0.3s ease;
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            z-index: 10;
        }

        .episode-card:hover .episode-number {
            transform: scale(1.1);
        }

        /* الأيقونة الدائرية للحلقة */
        .episode-circle-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
            scroll-snap-align: start;
        }

        .episode-circle-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }

        .episode-circle-btn:active {
            transform: scale(0.95);
        }

        .episode-circle-icon {
            font-size: 1.5rem;
            margin-bottom: 2px;
            color: white;
        }

        .episode-number-text {
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }

        /* رسالة عدم وجود نتائج */
        .no-results-message {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
            color: #6b7280;
            width: 100%;
            grid-column: 1 / -1;
        }

        .no-results-message i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #9ca3af;
        }

        .no-results-message p {
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            color: #4b5563;
        }

        .clear-search-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .clear-search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        /* رسالة الإعجاب */
        .like-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
            z-index: 9999;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 600;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .like-toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .like-toast i {
            font-size: 1.25rem;
        }

        .like-toast span {
            font-size: 0.95rem;
        }

        /* تحسين تجاوب header للشاشات الصغيرة جداً */
        @media (max-width: 360px) {
            .anime-details-page .bg-gradient-to-r {
                padding: 0.25rem;
            }
            
            .anime-details-page h1 {
                font-size: 1rem;
            }
            
            .anime-details-page .text-primary-100 {
                font-size: 0.75rem;
            }
            
            .anime-details-page button {
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
            }
            
            .anime-details-page .fas,
            .anime-details-page .far {
                font-size: 0.875rem;
            }

            /* تحسين أزرار الإعجاب والمفضلة للشاشات الصغيرة */
            .anime-details-page button[onclick*="toggleLike"],
            .anime-details-page button[onclick*="toggleFavorite"] {
                width: 2.5rem;
                height: 2.5rem;
            }

            .anime-details-page button[onclick*="toggleLike"] i,
            .anime-details-page button[onclick*="toggleFavorite"] i {
                font-size: 1rem;
            }
        }

        /* تحسين تجاوب صفحة السيرفرات للشاشات المختلفة */
        @media (max-width: 1200px) {
            .episode-servers-modal {
                max-width: 90vw;
                margin: 20px;
            }

            .episode-servers-header {
                padding: 25px;
            }

            .anime-title {
                font-size: 1.6rem;
                margin-bottom: 15px;
            }

            .episode-number-badge {
                padding: 8px 16px;
                font-size: 0.9rem;
                margin-bottom: 15px;
            }

            .episode-servers-count {
                padding: 7px 14px;
                font-size: 0.9rem;
            }

            .server-item {
                padding: 22px;
                margin-bottom: 18px;
            }

            .server-icon {
                width: 70px;
                height: 70px;
                font-size: 1.7rem;
            }

            .server-name {
                font-size: 1.25rem;
            }

            .server-description {
                font-size: 0.95rem;
            }

            .feature-badge {
                padding: 6px 12px;
                font-size: 0.8rem;
            }

            .watch-server-btn {
                padding: 15px 22px;
                font-size: 0.95rem;
            }
        }

        @media (max-width: 992px) {
            .episode-servers-modal {
                max-width: 92vw;
                margin: 18px;
            }

            .episode-servers-header {
                padding: 22px;
            }

            .anime-title {
                font-size: 1.5rem;
                margin-bottom: 14px;
            }

            .episode-number-badge {
                padding: 7px 15px;
                font-size: 0.85rem;
                margin-bottom: 14px;
            }

            .episode-servers-count {
                padding: 6px 13px;
                font-size: 0.85rem;
            }

            .server-item {
                padding: 20px;
                margin-bottom: 16px;
            }

            .server-icon {
                width: 65px;
                height: 65px;
                font-size: 1.6rem;
            }

            .server-name {
                font-size: 1.2rem;
            }

            .server-description {
                font-size: 0.9rem;
            }

            .feature-badge {
                padding: 5px 10px;
                font-size: 0.75rem;
            }

            .watch-server-btn {
                padding: 14px 20px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 768px) {
            .episode-servers-modal {
                max-width: 95vw;
                margin: 15px;
            }

            .episode-servers-header {
                padding: 20px;
            }

            .anime-title {
                font-size: 1.4rem;
                margin-bottom: 12px;
            }

            .episode-number-badge {
                padding: 6px 12px;
                font-size: 0.8rem;
                margin-bottom: 12px;
            }

            .episode-servers-count {
                padding: 5px 10px;
                font-size: 0.8rem;
            }

            .server-item {
                padding: 18px;
                margin-bottom: 15px;
                flex-direction: column;
                gap: 18px;
                text-align: center;
            }

            .server-info {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .server-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
                margin: 0 auto;
            }

            .server-name {
                font-size: 1.1rem;
                justify-content: center;
            }

            .server-description {
                font-size: 0.85rem;
                text-align: center;
            }

            .server-features {
                justify-content: center;
                gap: 6px;
            }

            .feature-badge {
                padding: 4px 8px;
                font-size: 0.7rem;
            }

            .watch-server-btn {
                width: 100%;
                justify-content: center;
                padding: 12px 18px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .episode-servers-modal {
                max-width: 98vw;
                margin: 10px;
            }

            .episode-servers-header {
                padding: 15px;
            }

            .anime-title {
                font-size: 1.3rem;
                margin-bottom: 10px;
            }

            .episode-number-badge {
                padding: 5px 10px;
                font-size: 0.75rem;
                margin-bottom: 10px;
            }

            .episode-servers-count {
                padding: 4px 8px;
                font-size: 0.75rem;
            }

            .server-item {
                padding: 15px;
                margin-bottom: 12px;
                gap: 12px;
            }

            .server-icon {
                width: 55px;
                height: 55px;
                font-size: 1.4rem;
            }

            .server-name {
                font-size: 1rem;
            }

            .server-description {
                font-size: 0.8rem;
            }

            .server-features {
                gap: 4px;
            }

            .feature-badge {
                padding: 3px 6px;
                font-size: 0.65rem;
            }

            .watch-server-btn {
                padding: 10px 16px;
                font-size: 0.85rem;
            }
        }

        @media (max-width: 360px) {
            .episode-servers-modal {
                max-width: 99vw;
                margin: 8px;
            }

            .episode-servers-header {
                padding: 12px;
            }

            .anime-title {
                font-size: 1.2rem;
                margin-bottom: 8px;
            }

            .episode-number-badge {
                padding: 4px 8px;
                font-size: 0.7rem;
                margin-bottom: 8px;
            }

            .episode-servers-count {
                padding: 3px 6px;
                font-size: 0.7rem;
            }

            .server-item {
                padding: 12px;
                margin-bottom: 10px;
                gap: 10px;
            }

            .server-icon {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
            }

            .server-name {
                font-size: 0.95rem;
            }

            .server-description {
                font-size: 0.75rem;
            }

            .feature-badge {
                padding: 2px 5px;
                font-size: 0.6rem;
            }

            .watch-server-btn {
                padding: 8px 14px;
                font-size: 0.8rem;
            }
        }

        /* تحسين تجاوب صفحة المشاهدة للشاشات المختلفة */
        @media (max-width: 1200px) {
            .watch-episode-modal {
                max-width: 90vw;
                margin: 20px;
            }

            .watch-episode-header {
                padding: 25px;
            }

            .episode-title-section h2 {
                font-size: 1.6rem;
                margin-bottom: 18px;
            }

            .episode-number-badge,
            .server-name-badge {
                padding: 8px 16px;
                font-size: 0.9rem;
            }

            .btn-secondary {
                padding: 12px 20px;
                font-size: 0.9rem;
            }

            .close-modal-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }

            .watch-episode-content {
                padding: 25px;
            }

            .video-container {
                margin-bottom: 30px;
                border-radius: 18px;
            }

            .episode-controls {
                gap: 25px;
            }

            .episode-navigation {
                gap: 20px;
            }

            .btn-nav {
                padding: 14px 22px;
                font-size: 1rem;
            }

            .episode-info-panel {
                padding: 20px;
            }

            .episode-stats {
                gap: 18px;
            }
        }

        @media (max-width: 992px) {
            .watch-episode-modal {
                max-width: 92vw;
                margin: 18px;
            }

            .watch-episode-header {
                padding: 22px;
            }

            .episode-title-section h2 {
                font-size: 1.5rem;
                margin-bottom: 16px;
            }

            .episode-number-badge,
            .server-name-badge {
                padding: 7px 14px;
                font-size: 0.85rem;
            }

            .btn-secondary {
                padding: 11px 18px;
                font-size: 0.85rem;
            }

            .close-modal-btn {
                width: 42px;
                height: 42px;
                font-size: 1rem;
            }

            .watch-episode-content {
                padding: 22px;
            }

            .video-container {
                margin-bottom: 28px;
            }

            .episode-controls {
                gap: 22px;
            }

            .btn-nav {
                padding: 13px 20px;
                font-size: 0.95rem;
            }

            .episode-info-panel {
                padding: 18px;
            }
        }

        @media (max-width: 768px) {
            .watch-episode-modal {
                max-width: 95vw;
                max-height: 98vh;
                margin: 15px;
            }

            .watch-episode-header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
                padding: 20px;
            }

            .episode-title-section h2 {
                font-size: 1.4rem;
                margin-bottom: 15px;
            }

            .episode-meta {
                justify-content: center;
                gap: 10px;
            }

            .episode-number-badge,
            .server-name-badge {
                padding: 6px 12px;
                font-size: 0.8rem;
            }

            .episode-actions {
                flex-direction: column;
                gap: 15px;
                width: 100%;
            }

            .btn-secondary {
                width: 100%;
                justify-content: center;
                padding: 12px 18px;
                font-size: 0.85rem;
            }

            .close-modal-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }

            .watch-episode-content {
                padding: 20px;
            }

            .video-container {
                margin-bottom: 25px;
                border-radius: 15px;
            }

            .video-placeholder i {
                font-size: 3rem;
                margin-bottom: 15px;
                font-size: 0.9rem;
            }

            .episode-controls {
                gap: 20px;
            }

            .episode-navigation {
                flex-direction: column;
                gap: 15px;
            }

            .btn-nav {
                width: 100%;
                min-width: auto;
                padding: 12px 18px;
                font-size: 0.9rem;
            }

            .episode-info-panel {
                padding: 15px;
            }

            .episode-stats {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .stat-item {
                justify-content: center;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .watch-episode-modal {
                max-width: 98vw;
                margin: 10px;
            }

            .watch-episode-header {
                padding: 15px;
                gap: 15px;
            }

            .episode-title-section h2 {
                font-size: 1.3rem;
                margin-bottom: 12px;
            }

            .episode-meta {
                gap: 8px;
            }

            .episode-number-badge,
            .server-name-badge {
                padding: 5px 10px;
                font-size: 0.75rem;
            }

            .episode-actions {
                gap: 12px;
            }

            .btn-secondary {
                padding: 10px 16px;
                font-size: 0.8rem;
            }

            .close-modal-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }

            .watch-episode-content {
                padding: 15px;
            }

            .video-container {
                margin-bottom: 20px;
                border-radius: 12px;
            }

            .video-placeholder i {
                font-size: 2.5rem;
                margin-bottom: 12px;
            }

            .video-placeholder p {
                font-size: 0.9rem;
            }

            .episode-controls {
                gap: 15px;
            }

            .episode-navigation {
                gap: 12px;
            }

            .btn-nav {
                padding: 10px 16px;
                font-size: 0.85rem;
            }

            .episode-info-panel {
                padding: 12px;
                font-size: 0.85rem;
            }

            .episode-stats {
                gap: 12px;
            }

            .stat-item {
                font-size: 0.85rem;
            }
        }

        @media (max-width: 360px) {
            .watch-episode-modal {
                max-width: 99vw;
                margin: 8px;
            }

            .watch-episode-header {
                padding: 12px;
                gap: 12px;
            }

            .episode-title-section h2 {
                font-size: 1.2rem;
                margin-bottom: 10px;
            }

            .episode-number-badge,
            .server-name-badge {
                padding: 4px 8px;
                font-size: 0.7rem;
            }

            .episode-actions {
                gap: 10px;
            }

            .btn-secondary {
                padding: 8px 14px;
                font-size: 0.75rem;
            }

            .close-modal-btn {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }

            .watch-episode-content {
                padding: 12px;
            }

            .video-container {
                margin-bottom: 18px;
                border-radius: 10px;
            }

            .video-placeholder i {
                font-size: 2rem;
                margin-bottom: 10px;
            }

            .video-placeholder p {
                font-size: 0.8rem;
            }

            .episode-controls {
                gap: 12px;
            }

            .episode-navigation {
                gap: 10px;
            }

            .btn-nav {
                padding: 8px 14px;
                font-size: 0.8rem;
            }

            .episode-info-panel {
                padding: 10px;
            }

            .episode-stats {
                gap: 10px;
            }

            .stat-item {
                font-size: 0.8rem;
            }
        }

        .episode-info {
            flex: 1;
            position: relative;
            z-index: 2;
        }

        .episode-info h4 {
            color: #1e293b;
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .episode-servers {
            color: #64748b;
            font-size: 0.875rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .episode-servers i {
            color: #3b82f6;
            font-size: 0.875rem;
        }

        .episode-action {
            flex-shrink: 0;
            position: relative;
            z-index: 2;
        }

        .watch-now-btn {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            box-shadow: 0 4px 15px rgba(5, 150, 105, 0.3);
            width: 100%;
        }

        .watch-now-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(5, 150, 105, 0.4);
        }

        .watch-now-btn i {
            font-size: 1rem;
        }

        .no-episodes-message {
            text-align: center;
            color: #64748b;
            font-style: italic;
            padding: 4rem 2rem;
            grid-column: 1 / -1;
            font-size: 1.125rem;
            background: #f8fafc;
            border-radius: 1rem;
            border: 2px dashed #cbd5e1;
        }

        .no-episodes-message i {
            font-size: 3rem;
            color: #94a3b8;
            margin-bottom: 1rem;
            display: block;
        }

        /* ===== قسم الأنميات المشابهة ===== */
        .similar-animes-section {
            background: rgba(255,255,255,0.95);
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.4);
            margin-top: 2rem;
            transition: all 0.3s ease;
        }

        .similar-animes-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .similar-animes-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .similar-animes-header h2 {
            color: #1e293b;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 800;
        }

        .similar-animes-header h2 i {
            color: #3b82f6;
            font-size: 1.25rem;
        }

        .similar-animes-count {
            background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 1.5rem;
            font-weight: 700;
            font-size: 0.75rem;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .similar-animes-count i {
            font-size: 0.875rem;
        }

        .similar-animes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.25rem;
        }

        .similar-anime-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 1rem;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            position: relative;
            aspect-ratio: 2/3;
        }

        .similar-anime-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.05), transparent);
            transition: left 0.6s ease;
        }

        .similar-anime-card:hover::before {
            left: 100%;
        }

        .similar-anime-card:hover {
            border-color: #8b5cf6;
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.15);
        }

        .similar-anime-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .similar-anime-card:hover .similar-anime-image {
            transform: scale(1.1);
        }

        .similar-anime-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, 
                rgba(0,0,0,0.8) 0%, 
                rgba(0,0,0,0.6) 40%, 
                rgba(0,0,0,0.3) 70%, 
                rgba(0,0,0,0) 100%);
            color: white;
            padding: 1rem;
            backdrop-filter: blur(10px);
        }

        .similar-anime-title {
            font-size: 0.875rem;
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: 0.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .similar-anime-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .similar-anime-stars {
            display: flex;
            gap: 0.125rem;
        }

        .similar-anime-stars .star {
            color: #fbbf24;
            font-size: 0.75rem;
        }

        .similar-anime-rating-text {
            font-size: 0.75rem;
            font-weight: 600;
        }

        .similar-anime-status {
            position: absolute;
            top: 0.75rem;
            left: 0.75rem;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.75rem;
            font-size: 0.625rem;
            font-weight: 700;
            backdrop-filter: blur(10px);
        }

        .similar-anime-status.completed {
            background: rgba(239, 68, 68, 0.9);
        }

        .anime-details-modal {
            background: var(--white);
            border-radius: 20px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-2xl);
            position: relative;
        }

        .anime-details-header {
            background: var(--gradient-primary);
            color: white;
            padding: 25px;
            border-radius: 20px 20px 0 0;
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
        }

        .anime-details-logo img {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            border: 3px solid rgba(255,255,255,0.3);
        }

        .anime-details-info h2 {
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .anime-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .anime-status, .anime-type, .anime-episodes {
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .anime-status.ongoing {
            background: rgba(16, 185, 129, 0.3);
            border-color: var(--success-color);
        }

        .anime-status.completed {
            background: rgba(239, 68, 68, 0.3);
            border-color: var(--danger-color);
        }

        .anime-rating {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .anime-rating .stars {
            display: flex;
            gap: 3px;
        }

        .anime-rating .star {
            color: #fbbf24;
            font-size: 16px;
        }

        .anime-rating .rating-text {
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .favorite-btn-modal {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            margin-right: auto;
        }

        .favorite-btn-modal:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        .favorite-btn-modal.active {
            background: var(--gradient-danger);
            border-color: var(--danger-color);
        }

        .anime-details-content {
            padding: 25px;
        }

        .anime-cover-section {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 25px;
            margin-bottom: 30px;
            align-items: start;
        }

        .anime-cover img {
            width: 100%;
            height: 280px;
            object-fit: cover;
            border-radius: 15px;
            box-shadow: var(--shadow-lg);
        }

        .no-image {
            width: 100%;
            height: 280px;
            background: var(--gray-100);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-400);
            font-size: 3rem;
        }

        .anime-story h3 {
            color: var(--gray-800);
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .anime-story p {
            color: var(--gray-600);
            line-height: 1.7;
            font-size: 1rem;
        }

        .anime-episodes-section h3 {
            color: var(--gray-800);
            font-size: 1.3rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .episodes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }

        .episode-item {
            background: var(--white);
            border: 2px solid var(--gray-200);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        .episode-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .episode-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .episode-header i {
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        .episode-title {
            font-weight: 700;
            color: var(--gray-800);
            font-size: 1.1rem;
        }

        .episode-servers-count {
            background: var(--gray-100);
            color: var(--gray-600);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .episode-actions {
            display: flex;
            justify-content: flex-end;
        }

        .watch-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .watch-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-blue);
        }

        .no-episodes {
            text-align: center;
            color: var(--gray-500);
            font-style: italic;
            padding: 40px;
            grid-column: 1 / -1;
        }

        .close-modal-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.3);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .close-modal-btn:hover {
            background: rgba(0,0,0,0.5);
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .close-modal-btn:active {
            transform: scale(0.95);
        }

        .close-modal-btn:focus {
            outline: 2px solid rgba(255, 255, 255, 0.5);
            outline-offset: 2px;
        }

        .close-modal-btn i {
            pointer-events: none;
        }

        /* ===== تجاوب زر الإغلاق ===== */
        @media (max-width: 768px) {
            .close-modal-btn {
                top: 15px;
                right: 15px;
                width: 35px;
                height: 35px;
            }
        }

        @media (max-width: 480px) {
            .close-modal-btn {
                top: 10px;
                right: 10px;
                width: 32px;
                height: 32px;
            }
        }

        /* ===== زر الإغلاق في صفحة المشاهدة ===== */
        .watch-close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1001;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .watch-close-btn:hover {
            background: rgba(0, 0, 0, 0.9);
            border-color: rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
        }

        .watch-close-btn:active {
            transform: scale(0.95);
        }

        .watch-close-btn:focus {
            outline: 2px solid rgba(255, 255, 255, 0.7);
            outline-offset: 3px;
        }

        /* ===== تجاوب زر الإغلاق في صفحة المشاهدة ===== */
        @media (max-width: 768px) {
            .watch-close-btn {
                top: 15px;
                right: 15px;
                width: 35px;
                height: 35px;
            }
        }

        @media (max-width: 480px) {
            .watch-close-btn {
                top: 10px;
                right: 10px;
                width: 32px;
                height: 32px;
            }
        }

        /* ===== أنميات نافذة السيرفرات المحسنة ===== */
        .episode-servers-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(20px);
            padding: 1.5rem;
        }

        .episode-servers-modal {
            background: white;
            border-radius: 1.5rem;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            position: relative;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .episode-servers-header {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            padding: 2rem;
            border-radius: 1.5rem 1.5rem 0 0;
            position: relative;
            overflow: hidden;
        }

        .episode-servers-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .episode-info {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            position: relative;
            z-index: 2;
        }

        .episode-cover {
            position: relative;
            overflow: hidden;
            border-radius: 1rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            border: 3px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
        }

        .episode-cover:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 35px rgba(0,0,0,0.3);
        }

        .episode-cover img {
            width: 5rem;
            height: 7.5rem;
            object-fit: cover;
            border-radius: 1rem;
            transition: all 0.3s ease;
        }

        .episode-details h2 {
            font-size: clamp(1.25rem, 3vw, 1.75rem);
            font-weight: 900;
            margin-bottom: 0.75rem;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
            line-height: 1.2;
        }

        .episode-number {
            font-size: 1.125rem;
            margin-bottom: 1rem;
            opacity: 0.9;
            font-weight: 600;
        }

        .episode-meta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .episode-servers-count {
            background: rgba(16, 185, 129, 0.25);
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 700;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(16, 185, 129, 0.4);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
        }

        .episode-servers-count:hover {
            background: rgba(16, 185, 129, 0.35);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        .episode-servers-count i {
            color: #10b981;
            font-size: 1rem;
        }

        .servers-list {
            padding: 2rem;
        }

        .server-item {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 1.25rem;
            padding: 2rem;
            margin-bottom: 1.5rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            position: relative;
            overflow: hidden;
            gap: 1.5rem;
        }

        .server-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.08), transparent);
            transition: left 0.8s ease;
        }

        .server-item:hover::before {
            left: 100%;
        }

        .server-item:hover {
            border-color: #3b82f6;
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(59, 130, 246, 0.15);
        }

        .server-info {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            flex: 1;
        }

        .server-icon {
            width: 4rem;
            height: 4rem;
            border-radius: 1.125rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 2;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .server-icon.mega-server {
            background: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);
            color: white;
        }

        .server-icon.vk-server {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
        }

        .server-icon.videa-server {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            color: white;
        }

        .server-icon.voe-server {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .server-icon.max-server {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .server-icon.default-server {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
            color: white;
        }

        .server-item:hover .server-icon {
            transform: scale(1.15) rotate(8deg);
            box-shadow: 0 8px 25px rgba(0,0,0,0.25);
        }

        .server-details {
            flex: 1;
            position: relative;
            z-index: 2;
        }

        .server-name {
            color: #1e293b;
            font-size: 1.375rem;
            font-weight: 800;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .server-name i {
            font-size: 1.125rem;
            color: #3b82f6;
        }

        .server-description {
            color: #64748b;
            font-size: 1rem;
            margin-bottom: 1rem;
            font-weight: 500;
            line-height: 1.5;
        }

        .server-features {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .feature-badge {
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.75rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .feature-badge.no-ads {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
            border-color: rgba(16, 185, 129, 0.3);
        }

        .feature-badge.hd {
            background: rgba(59, 130, 246, 0.1);
            color: #2563eb;
            border-color: rgba(59, 130, 246, 0.3);
        }

        .feature-badge.stable {
            background: rgba(6, 182, 212, 0.1);
            color: #0891b2;
            border-color: rgba(6, 182, 212, 0.3);
        }

        .feature-badge.free {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
            border-color: rgba(245, 158, 11, 0.3);
        }

        .feature-badge.easy {
            background: rgba(139, 92, 246, 0.1);
            color: #7c3aed;
            border-color: rgba(139, 92, 246, 0.3);
        }

        .feature-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .server-action {
            flex-shrink: 0;
            position: relative;
            z-index: 2;
        }

        .watch-server-btn {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1rem;
            box-shadow: 0 6px 20px rgba(5, 150, 105, 0.3);
            min-width: 140px;
            justify-content: center;
        }

        .watch-server-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(5, 150, 105, 0.4);
        }

        .watch-server-btn:active {
            transform: translateY(-2px);
        }

        .watch-server-btn i {
            font-size: 1.25rem;
        }

        .no-servers {
            text-align: center;
            color: #64748b;
            font-style: italic;
            padding: 3rem 2rem;
            background: #f8fafc;
            border-radius: 1rem;
            border: 2px dashed #cbd5e1;
            margin: 1rem;
        }

        .no-servers i {
            font-size: 3rem;
            color: #94a3b8;
            margin-bottom: 1rem;
            display: block;
        }

        .no-servers p {
            font-size: 1.125rem;
            font-weight: 500;
        }

        /* ===== أنميات نافذة المشاهدة المحسنة ===== */
        .watch-episode-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            backdrop-filter: blur(25px);
            padding: 1.5rem;
        }

        .watch-episode-modal {
            background: white;
            border-radius: 1.5rem;
            width: 100%;
            max-width: 1400px;
            max-height: 95vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            position: relative;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .watch-episode-header {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            padding: 2rem 2.5rem;
            border-radius: 1.5rem 1.5rem 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .watch-episode-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .episode-title-section {
            position: relative;
            z-index: 2;
        }

        .episode-title-section h2 {
            font-size: clamp(1.25rem, 3vw, 1.75rem);
            font-weight: 900;
            margin-bottom: 1rem;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
            line-height: 1.2;
        }

        .episode-meta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .episode-number-badge {
            background: rgba(255,255,255,0.15);
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 700;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .episode-number-badge:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }

        .episode-number-badge i {
            font-size: 0.875rem;
        }

        .server-name-badge {
            background: rgba(16, 185, 129, 0.25);
            padding: 0.75rem 1.5rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 700;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(16, 185, 129, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .server-name-badge:hover {
            background: rgba(16, 185, 129, 0.35);
            transform: translateY(-2px);
        }

        .server-name-badge i {
            font-size: 0.875rem;
            color: #10b981;
        }

        .episode-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.875rem 1.5rem;
            border-radius: 2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.875rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255,255,255,0.2);
        }

        .btn-text {
            font-size: 0.875rem;
            font-weight: 600;
        }

        .close-modal-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid rgba(239, 68, 68, 0.3);
            color: white;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .close-modal-btn:hover {
            background: rgba(239, 68, 68, 0.3);
            border-color: rgba(239, 68, 68, 0.5);
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.3);
        }

        .watch-episode-content {
            padding: 2.5rem;
        }

        .video-container {
            width: 100%;
            aspect-ratio: 16/9;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border-radius: 1.5rem;
            overflow: hidden;
            margin-bottom: 2.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            position: relative;
            border: 2px solid rgba(59, 130, 246, 0.2);
        }

        .video-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            z-index: 1;
        }

        .video-placeholder i {
            font-size: clamp(3rem, 8vw, 5rem);
            margin-bottom: 1.5rem;
            color: #3b82f6;
            animation: pulse 2s ease-in-out infinite;
            filter: drop-shadow(0 4px 8px rgba(59, 130, 246, 0.3));
        }

        .video-placeholder p {
            font-size: 1.125rem;
            font-weight: 600;
            color: #cbd5e1;
        }

        .episode-video {
            width: 100%;
            height: 100%;
            border: none;
            display: none;
            border-radius: 1.5rem;
        }

        .episode-controls {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .episode-navigation {
            display: flex;
            justify-content: space-between;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .btn-nav {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 1.25rem 2rem;
            border-radius: 2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            min-width: 180px;
            justify-content: center;
            font-size: 1rem;
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn-nav::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s ease;
        }

        .btn-nav:hover::before {
            left: 100%;
        }

        .btn-nav:hover:not(:disabled) {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(59, 130, 246, 0.4);
        }

        .btn-nav:disabled {
            background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
            cursor: not-allowed;
            opacity: 0.7;
            transform: none;
            box-shadow: none;
        }

        .btn-nav span {
            position: relative;
            z-index: 2;
        }

        .btn-nav i {
            position: relative;
            z-index: 2;
            font-size: 1.125rem;
        }

        .episode-info-panel {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 1.25rem;
            padding: 2rem;
            border: 2px solid #e2e8f0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .episode-info-panel:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.1);
        }

        .episode-stats {
            display: flex;
            gap: 2rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: #475569;
            font-weight: 600;
            font-size: 1rem;
            padding: 1rem 1.5rem;
            background: white;
            border-radius: 1rem;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .stat-item:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15);
        }

        .stat-item i {
            color: #3b82f6;
            font-size: 1.125rem;
        }

        /* ===== التجاوب ===== */
        @media (max-width: 1200px) {
            .anime-hero-section {
                grid-template-columns: 300px 1fr;
                gap: 30px;
            }

            .anime-cover-large img,
            .no-image-large {
                height: 400px;
            }

            .anime-meta-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
        }

        @media (max-width: 992px) {
            .anime-hero-section {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .anime-cover-large img,
            .no-image-large {
                width: 300px;
                height: 400px;
                margin: 0 auto;
            }

            .anime-info-panel {
                padding: 25px;
            }

            .anime-meta-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .episodes-grid-enhanced {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 15px;
            }

            /* ===== تجاوب صفحة المشاهدة للشاشات المتوسطة ===== */
            .watch-episode-modal {
                max-width: 95vw;
                margin: 15px;
            }

            .watch-episode-header {
                padding: 20px 25px;
            }

            .episode-title-section h2 {
                font-size: 1.5rem;
            }

            .btn-secondary {
                padding: 10px 18px;
            }

            .btn-nav {
                padding: 16px 25px;
                min-width: 160px;
            }

            .video-container {
                margin-bottom: 25px;
            }
        }

        @media (max-width: 768px) {
            .anime-details-modal,
            .episode-servers-modal,
            .watch-episode-modal {
                max-width: 95vw;
                margin: 10px;
            }

            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .anime-title h1 {
                font-size: 1.6rem;
            }

            .back-btn {
                padding: 10px 16px;
                font-size: 0.9rem;
            }

            .anime-details-content {
                padding: 20px 15px;
            }

            .anime-cover-large img,
            .no-image-large {
                width: 250px;
                height: 350px;
            }

            .anime-info-panel {
                padding: 20px;
            }

            .anime-meta-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .meta-item {
                padding: 15px;
            }

            .anime-genres-section {
                padding: 15px;
                margin-bottom: 20px;
            }

            .anime-genres-section h3 {
                font-size: 1rem;
                margin-bottom: 10px;
            }

            .genres-grid {
                gap: 8px;
            }

            .genre-tag {
                padding: 8px 12px;
                font-size: 0.8rem;
            }

            .episodes-section {
                padding: 20px;
            }

            .section-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .episodes-grid-enhanced {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .episode-card {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .episode-number {
                width: 60px;
                height: 60px;
                font-size: 1.4rem;
            }

            .episode-info h4 {
                font-size: 1.2rem;
            }

            .watch-now-btn {
                width: 100%;
                justify-content: center;
            }

            .anime-cover-section {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .anime-cover img,
            .no-image {
                width: 200px;
                height: 280px;
                margin: 0 auto;
            }

            .episodes-grid {
                grid-template-columns: 1fr;
            }

            .episode-info {
                flex-direction: column;
                text-align: center;
            }

            .episode-cover img {
                width: 60px;
                height: 90px;
            }

            /* ===== تجاوب صفحة السيرفرات ===== */
            @media (max-width: 1200px) {
                .episode-servers-modal {
                    max-width: 95vw;
                    margin: 20px;
                }

                .episode-servers-header {
                    padding: 25px;
                }

                .anime-title {
                    font-size: 1.5rem;
                    margin-bottom: 12px;
                }

                .episode-number-badge {
                    padding: 8px 16px;
                    font-size: 0.95rem;
                    margin-bottom: 12px;
                }

                .episode-servers-count {
                    padding: 7px 14px;
                    font-size: 0.95rem;
                }

                .server-item {
                    padding: 22px;
                    margin-bottom: 18px;
                }

                .server-icon {
                    width: 55px;
                    height: 55px;
                    font-size: 1.4rem;
                }

                .server-name {
                    font-size: 1.2rem;
                }

                .server-description {
                    font-size: 0.95rem;
                }

                .feature-badge {
                    padding: 5px 10px;
                    font-size: 0.8rem;
                }

                .watch-server-btn {
                    padding: 14px 22px;
                    font-size: 0.95rem;
                }
            }

            @media (max-width: 992px) {
                .episode-servers-modal {
                    max-width: 95vw;
                    margin: 18px;
                }

                .episode-servers-header {
                    padding: 22px;
                }

                .anime-title {
                    font-size: 1.4rem;
                    margin-bottom: 12px;
                }

                .episode-number-badge {
                    padding: 8px 15px;
                    font-size: 0.9rem;
                    margin-bottom: 12px;
                }

                .episode-servers-count {
                    padding: 6px 13px;
                    font-size: 0.9rem;
                }

                .server-item {
                    padding: 20px;
                    margin-bottom: 16px;
                }

                .server-icon {
                    width: 52px;
                    height: 52px;
                    font-size: 1.3rem;
                }

                .server-name {
                    font-size: 1.15rem;
                }

                .server-description {
                    font-size: 0.9rem;
                }

                .feature-badge {
                    padding: 5px 9px;
                    font-size: 0.75rem;
                }

                .watch-server-btn {
                    padding: 13px 20px;
                    font-size: 0.9rem;
                }
            }

            @media (max-width: 768px) {
                .episode-servers-modal {
                    max-width: 95vw;
                    margin: 15px;
                }

                .episode-servers-header {
                    padding: 20px;
                }

                .anime-title {
                    font-size: 1.3rem;
                    margin-bottom: 12px;
                }

                .episode-number-badge {
                    padding: 7px 14px;
                    font-size: 0.85rem;
                    margin-bottom: 12px;
                }

                .episode-servers-count {
                    padding: 6px 12px;
                    font-size: 0.85rem;
                }

                .server-item {
                    padding: 18px;
                    margin-bottom: 15px;
                    flex-direction: column;
                    gap: 18px;
                    text-align: center;
                }

                .server-info {
                    flex-direction: column;
                    gap: 15px;
                    text-align: center;
                }

                .server-icon {
                    width: 65px;
                    height: 65px;
                    font-size: 1.6rem;
                    margin: 0 auto;
                }

                .server-name {
                    font-size: 1.1rem;
                    justify-content: center;
                }

                .server-description {
                    font-size: 0.9rem;
                    text-align: center;
                }

                .server-features {
                    justify-content: center;
                    gap: 6px;
                }

                .feature-badge {
                    padding: 5px 10px;
                    font-size: 0.75rem;
                }

                .watch-server-btn {
                    width: 100%;
                    justify-content: center;
                    padding: 14px 20px;
                    font-size: 0.95rem;
                }
            }

            @media (max-width: 480px) {
                .episode-servers-modal {
                    max-width: 98vw;
                    margin: 10px;
                }

                .episode-servers-header {
                    padding: 15px;
                }

                .anime-title {
                    font-size: 1.2rem;
                    margin-bottom: 10px;
                }

                .episode-number-badge {
                    padding: 6px 12px;
                    font-size: 0.8rem;
                    margin-bottom: 10px;
                }

                .episode-servers-count {
                    padding: 5px 10px;
                    font-size: 0.8rem;
                }

                .server-item {
                    padding: 15px;
                    margin-bottom: 12px;
                    gap: 15px;
                }

                .server-icon {
                    width: 60px;
                    height: 60px;
                    font-size: 1.5rem;
                }

                .server-name {
                    font-size: 1.05rem;
                }

                .server-description {
                    font-size: 0.85rem;
                }

                .server-features {
                    gap: 5px;
                }

                .feature-badge {
                    padding: 4px 8px;
                    font-size: 0.7rem;
            }

                .watch-server-btn {
                    padding: 12px 18px;
                    font-size: 0.9rem;
                }

                .anime-genres-section {
                    padding: 10px;
                    margin-bottom: 15px;
                }

                .anime-genres-section h3 {
                    font-size: 0.9rem;
                    margin-bottom: 8px;
                }

                .genres-grid {
                    gap: 6px;
                }

                .genre-tag {
                    padding: 6px 10px;
                    font-size: 0.7rem;
                    border-radius: 1.5rem;
                }
            }

            @media (max-width: 360px) {
                .episode-servers-modal {
                    max-width: 99vw;
                    margin: 8px;
                }

                .episode-servers-header {
                    padding: 12px;
                }

                .anime-title {
                    font-size: 1.1rem;
                    margin-bottom: 8px;
                }

                .episode-number-badge {
                    padding: 5px 10px;
                    font-size: 0.75rem;
                    margin-bottom: 8px;
                }

                .episode-servers-count {
                    padding: 4px 8px;
                    font-size: 0.75rem;
                }

                .server-item {
                    padding: 12px;
                    margin-bottom: 10px;
                    gap: 12px;
                }

                .anime-genres-section {
                    padding: 8px;
                    margin-bottom: 12px;
                }

                .anime-genres-section h3 {
                    font-size: 0.8rem;
                    margin-bottom: 6px;
                }

                .genres-grid {
                    gap: 4px;
                }

                .genre-tag {
                    padding: 4px 8px;
                    font-size: 0.65rem;
                    border-radius: 1.25rem;
                }
                }

                .server-icon {
                    width: 55px;
                    height: 55px;
                    font-size: 1.4rem;
                }

                .server-name {
                    font-size: 1rem;
                }

                .server-description {
                    font-size: 0.8rem;
                }

                .server-features {
                    gap: 4px;
                }

                .feature-badge {
                    padding: 3px 6px;
                    font-size: 0.65rem;
                }

                .watch-server-btn {
                    padding: 10px 16px;
                    font-size: 0.85rem;
                }
            }

            /* ===== تجاوب صفحة المشاهدة ===== */
            @media (max-width: 1200px) {
                .watch-episode-modal {
                    max-width: 95vw;
                    max-height: 98vh;
                    margin: 20px;
                }

                .watch-episode-header {
                    padding: 25px;
                }

                .episode-title-section h2 {
                    font-size: 1.6rem;
                    margin-bottom: 18px;
                }

                .episode-meta {
                    gap: 15px;
                }

                .episode-number-badge,
                .server-name-badge {
                    padding: 8px 16px;
                    font-size: 1rem;
                }

                .episode-actions {
                    gap: 15px;
                }

                .btn-secondary {
                    padding: 12px 20px;
                    font-size: 0.95rem;
                }

                .close-modal-btn {
                    width: 45px;
                    height: 45px;
                    font-size: 1.1rem;
                }

                .watch-episode-content {
                    padding: 25px;
                }

                .video-container {
                    margin-bottom: 30px;
                    border-radius: 18px;
                }

                .episode-controls {
                    gap: 25px;
                }

                .episode-navigation {
                    gap: 20px;
                }

                .btn-nav {
                    padding: 14px 22px;
                    font-size: 1rem;
                }

                .episode-info-panel {
                    padding: 20px;
                }

                .episode-stats {
                    gap: 18px;
                }
            }

            @media (max-width: 992px) {
                .watch-episode-modal {
                    max-width: 95vw;
                    margin: 18px;
                }

                .watch-episode-header {
                    padding: 22px;
                }

                .episode-title-section h2 {
                    font-size: 1.5rem;
                    margin-bottom: 16px;
                }

                .episode-number-badge,
                .server-name-badge {
                    padding: 7px 14px;
                    font-size: 0.95rem;
                }

                .btn-secondary {
                    padding: 11px 18px;
                    font-size: 0.9rem;
                    width: auto;
                }

                .close-modal-btn {
                    width: 42px;
                    height: 42px;
                    font-size: 1rem;
                }

                .watch-episode-content {
                    padding: 22px;
                }

                .video-container {
                    margin-bottom: 28px;
                }

                .episode-controls {
                    gap: 22px;
                }

                .btn-nav {
                    padding: 13px 20px;
                    font-size: 0.95rem;
                }

                .episode-info-panel {
                    padding: 18px;
                }
            }

            @media (max-width: 768px) {
                .watch-episode-modal {
                    max-width: 95vw;
                    max-height: 98vh;
                    margin: 15px;
                }

                .watch-episode-header {
                    flex-direction: column;
                    gap: 20px;
                    text-align: center;
                    padding: 20px;
                }

                .episode-title-section h2 {
                    font-size: 1.4rem;
                    margin-bottom: 15px;
                }

                .episode-meta {
                    justify-content: center;
                    gap: 10px;
                }

                .episode-number-badge,
                .server-name-badge {
                    padding: 6px 12px;
                    font-size: 0.9rem;
                }

                .episode-actions {
                    flex-direction: column;
                    gap: 15px;
                    width: 100%;
                }

                .btn-secondary {
                    width: 100%;
                    justify-content: center;
                    padding: 15px 20px;
                }

                .close-modal-btn {
                    width: 50px;
                    height: 50px;
                    font-size: 1.2rem;
                }

                .watch-episode-content {
                    padding: 20px;
                }

                .video-container {
                    margin-bottom: 25px;
                    border-radius: 15px;
                }

                .video-placeholder i {
                    font-size: 3rem;
                    margin-bottom: 15px;
                }

                .video-placeholder p {
                    font-size: 1rem;
                }

                .episode-controls {
                    gap: 20px;
                }

                .episode-navigation {
                    flex-direction: column;
                    gap: 15px;
                }

                .btn-nav {
                    width: 100%;
                    min-width: auto;
                    padding: 15px 20px;
                    font-size: 0.95rem;
                }

                .episode-info-panel {
                    padding: 15px;
                }

                .episode-stats {
                    flex-direction: column;
                    gap: 15px;
                    text-align: center;
                }

                .stat-item {
                    justify-content: center;
                }
            }

            @media (max-width: 480px) {
                .watch-episode-modal {
                    max-width: 98vw;
                    margin: 10px;
                }

                .watch-episode-header {
                    padding: 15px;
                    gap: 15px;
                }

                .episode-title-section h2 {
                    font-size: 1.3rem;
                    margin-bottom: 12px;
                }

                .episode-meta {
                    gap: 8px;
                }

                .episode-number-badge,
                .server-name-badge {
                    padding: 5px 10px;
                    font-size: 0.85rem;
                }

                .episode-actions {
                    gap: 12px;
                }

                .btn-secondary {
                    padding: 12px 18px;
                    font-size: 0.9rem;
                }

                .close-modal-btn {
                    width: 45px;
                    height: 45px;
                    font-size: 1.1rem;
                }

                .watch-episode-content {
                    padding: 15px;
                }

                .video-container {
                    margin-bottom: 20px;
                    border-radius: 12px;
                }

                .video-placeholder i {
                    font-size: 2.5rem;
                    margin-bottom: 12px;
                }

                .video-placeholder p {
                    font-size: 0.9rem;
                }

                .episode-controls {
                    gap: 15px;
                }

                .episode-navigation {
                    gap: 12px;
                }

                .btn-nav {
                    padding: 12px 18px;
                    font-size: 0.9rem;
                }

                .episode-info-panel {
                    padding: 12px;
                }

                .episode-stats {
                    gap: 12px;
                }

                .stat-item {
                    font-size: 0.9rem;
                }
            }

            @media (max-width: 360px) {
                .watch-episode-modal {
                    max-width: 99vw;
                    margin: 8px;
                }

                .watch-episode-header {
                    padding: 12px;
                    gap: 12px;
                }

                .episode-title-section h2 {
                    font-size: 1.2rem;
                    margin-bottom: 10px;
                }

                .episode-number-badge,
                .server-name-badge {
                    padding: 4px 8px;
                    font-size: 0.8rem;
                }

                .episode-actions {
                    gap: 10px;
                }

                .btn-secondary {
                    padding: 10px 16px;
                    font-size: 0.85rem;
                }

                .close-modal-btn {
                    width: 40px;
                    height: 40px;
                    font-size: 1rem;
                }

                .watch-episode-content {
                    padding: 12px;
                }

                .video-container {
                    margin-bottom: 18px;
                    border-radius: 10px;
                }

                .video-placeholder i {
                    font-size: 2.2rem;
                    margin-bottom: 10px;
                }

                .video-placeholder p {
                    font-size: 0.85rem;
                }

                .episode-controls {
                    gap: 12px;
                }

                .episode-navigation {
                    gap: 10px;
                }

                .btn-nav {
                    padding: 10px 16px;
                    font-size: 0.85rem;
                }

                .episode-info-panel {
                    padding: 10px;
                }

                .episode-stats {
                    gap: 10px;
                }

                .stat-item {
                    font-size: 0.85rem;
                }
            }

        @media (max-width: 480px) {
            .anime-details-header {
                padding: 15px 0;
            }

            .header-content {
                padding: 0 15px;
            }

            .anime-title h1 {
                font-size: 1.4rem;
            }

            .back-btn {
                padding: 8px 12px;
                font-size: 0.8rem;
            }

            .anime-details-content {
                padding: 15px 10px;
            }

            .anime-cover-large img,
            .no-image-large {
                width: 200px;
                height: 280px;
            }

            .anime-info-panel {
                padding: 15px;
            }

            .meta-item {
                padding: 12px;
            }

            .meta-item i {
                font-size: 1.2rem;
            }

            .meta-label {
                font-size: 0.8rem;
            }

            .meta-value {
                font-size: 1rem;
            }

            .episodes-section {
                padding: 15px;
            }

            .section-header h2 {
                font-size: 1.4rem;
            }

            .episodes-count {
                padding: 6px 12px;
                font-size: 0.8rem;
            }

            .episode-card {
                padding: 15px;
            }

            .episode-number {
                width: 50px;
                height: 50px;
                font-size: 1.1rem;
            }

            .episode-info h4 {
                font-size: 1.1rem;
            }

            .episode-servers {
                font-size: 0.8rem;
            }

            .watch-now-btn {
                padding: 10px 16px;
                font-size: 0.9rem;
            }

            /* ===== تجاوب الأنميات المشابهة ===== */
            .similar-animes-section {
                padding: 1.25rem;
                margin-top: 1.5rem;
            }

            .similar-animes-header h2 {
                font-size: 1.25rem;
            }

            .similar-animes-count {
                padding: 0.375rem 0.75rem;
                font-size: 0.7rem;
            }

            .similar-animes-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 1rem;
            }

            .similar-anime-card {
                aspect-ratio: 2/3;
            }

            .similar-anime-overlay {
                padding: 0.75rem;
            }

            .similar-anime-title {
                font-size: 0.8rem;
                margin-bottom: 0.375rem;
            }

            .similar-anime-rating {
                gap: 0.375rem;
            }

            .similar-anime-stars .star {
                font-size: 0.7rem;
            }

            .similar-anime-rating-text {
                font-size: 0.7rem;
            }

            .similar-anime-status {
                top: 0.5rem;
                left: 0.5rem;
                padding: 0.25rem 0.5rem;
                font-size: 0.6rem;
            }
        }

        /* تحسين تجاوب إضافي للشاشات الصغيرة */
        @media (max-width: 640px) {
            .episodes-section {
                padding: 0.75rem;
            }
            
            .episodes-search-container {
                margin-bottom: 0.75rem;
            }
            
            .episodes-search-input {
                padding: 0.5rem;
                font-size: 0.8rem;
            }
            
            .episodes-grid-enhanced {
                gap: 0.75rem;
                padding: 0.75rem;
            }
            
            .episode-card {
                padding: 0.75rem;
            }
            
            .episode-image {
                width: 50px;
                height: 50px;
            }
            
            .episode-number {
                width: 35px;
                height: 35px;
                font-size: 0.8rem;
            }
            
            .episode-info h4 {
                font-size: 0.8rem;
            }
            
            .episode-info p {
                font-size: 0.7rem;
            }
            
            .watch-now-btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.7rem;
            }

            .similar-animes-section {
                padding: 1rem;
                margin-top: 1rem;
            }
            
            .similar-animes-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 0.75rem;
            }
        }

        @media (max-width: 480px) {
            .episodes-section {
                padding: 0.5rem;
            }
            
            .episodes-search-input {
                padding: 0.4rem;
                font-size: 0.75rem;
            }
            
            .episodes-grid-enhanced {
                gap: 0.5rem;
                padding: 0.5rem;
            }
            
            .episode-card {
                padding: 0.5rem;
            }
            
            .episode-image {
                width: 45px;
                height: 45px;
            }
            
            .episode-number {
                width: 30px;
                height: 30px;
                font-size: 0.75rem;
            }
            
            .episode-info h4 {
                font-size: 0.75rem;
            }
            
            .episode-info p {
                font-size: 0.65rem;
            }
            
            .watch-now-btn {
                padding: 0.3rem 0.6rem;
                font-size: 0.65rem;
            }

            /* تحسين الأيقونة الدائرية للشاشات الصغيرة */
            .episode-circle-btn {
                width: 60px;
                height: 60px;
            }

            .episode-circle-icon {
                font-size: 1.2rem;
            }

            .episode-number-text {
                font-size: 0.7rem;
            }

            .similar-animes-section {
                padding: 0.75rem;
            }
            
            .similar-animes-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 0.5rem;
            }
            
            .similar-anime-overlay {
                padding: 0.5rem;
            }
            
            .similar-anime-title {
                font-size: 0.7rem;
            }
        }

                    /* ===== تجاوب محسن لجميع الأجهزة ===== */
        
        /* ===== تجاوب الشبكة الرئيسية ===== */
        @media (max-width: 1400px) {
            .anime-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 1.5rem;
            }
        }
        
        @media (max-width: 1200px) {
            .anime-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 1.25rem;
            }
            
            .anime-card {
                aspect-ratio: 2/3;
            }
            
            .anime-title {
                font-size: 0.875rem;
            }
        }

        @media (max-width: 992px) {
            .anime-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 1.125rem;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .anime-card {
                aspect-ratio: 2/3;
            }
            
            .anime-title {
                font-size: 0.875rem;
            }
            
            .episode-badge {
                width: 2.5rem;
                height: 2.5rem;
                font-size: 0.75rem;
            }
            
            .anime-card .favorite-btn {
                width: 2.5rem;
                height: 2.5rem;
            }
            
            .anime-card .status-badge {
                font-size: 0.75rem;
                padding: 0.375rem 0.75rem;
            }
        }

        @media (max-width: 768px) {
            .anime-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .logo {
                width: 3.75rem;
                height: 3.75rem;
            }
            
            .search-input {
                padding: 0.875rem 1.5rem;
                font-size: 0.875rem;
            }
            
            .filters {
                gap: 0.75rem;
            }
            
            .filter-btn {
                padding: 0.75rem 1.25rem;
                font-size: 0.8rem;
            }

            .stats {
                gap: 1.5rem;
            }

            .stat-item {
                padding: 0.875rem 1.25rem;
            }

            .stat-item span:first-of-type {
                font-size: 1.5rem;
            }
            
            .anime-card {
                aspect-ratio: 3/4;
            }
            
            .anime-title {
                font-size: 0.8rem;
                -webkit-line-clamp: 2;
            }
            
            .rating-container {
                gap: 0.25rem;
            }
            
            .stars {
                gap: 0.125rem;
            }
            
            .star {
                font-size: 0.75rem;
            }
            
            .rating-text {
                font-size: 0.75rem;
            }
            
            .episode-badge {
                width: 2.5rem;
                height: 2.5rem;
                font-size: 0.75rem;
                bottom: 0.5rem;
                right: 0.5rem;
            }
            
            .anime-card .favorite-btn {
                width: 2.5rem;
                height: 2.5rem;
                top: 0.5rem;
                right: 0.5rem;
            }
            
            .anime-card .status-badge {
                top: 0.5rem;
                left: 0.5rem;
                font-size: 0.7rem;
                padding: 0.25rem 0.5rem;
            }
        }

        @media (max-width: 480px) {
            .anime-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            
            body {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.75rem;
            }
            
            .search-input {
                width: 100%;
                padding: 0.75rem 1.25rem;
                font-size: 0.875rem;
            }
            
            .filters {
                flex-direction: column;
                align-items: center;
            }
            
            .filter-btn {
                width: 12.5rem;
            }
            
            .anime-card {
                aspect-ratio: 2/3;
            }
            
            .anime-title {
                font-size: 0.75rem;
                margin-bottom: 0.375rem;
            }
            
            .anime-info {
                padding: 0.75rem;
            }
            
            .episode-badge {
                width: 2.25rem;
                height: 2.25rem;
                font-size: 0.7rem;
                bottom: 0.375rem;
                right: 0.375rem;
            }
            
            .anime-card .favorite-btn {
                width: 2.25rem;
                height: 2.25rem;
                top: 0.375rem;
                right: 0.375rem;
            }
            
            .anime-card .favorite-btn i {
                font-size: 0.75rem;
            }
            
            .anime-card .status-badge {
                top: 0.375rem;
                left: 0.375rem;
                font-size: 0.6rem;
                padding: 0.25rem 0.5rem;
            }
            
            .stats {
                gap: 1rem;
            }
            
            .stat-item {
                padding: 0.625rem 1rem;
            }
            
            .stat-item span:first-of-type {
                font-size: 1.25rem;
            }
            
            .stat-item span:last-of-type {
                font-size: 0.75rem;
            }
        }
        
        @media (max-width: 360px) {
            .anime-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .anime-card {
                aspect-ratio: 2/3;
            }
            
            .anime-title {
                font-size: 0.7rem;
            }
            
            .episode-badge {
                width: 2rem;
                height: 2rem;
                font-size: 0.6rem;
                bottom: 0.375rem;
                right: 0.375rem;
            }
            
            .anime-card .favorite-btn {
                width: 2rem;
                height: 2rem;
                top: 0.375rem;
                right: 0.375rem;
            }
            
            .anime-card .status-badge {
                top: 0.375rem;
                left: 0.375rem;
                font-size: 0.55rem;
                padding: 0.125rem 0.375rem;
            }
        }

        /* ===== تجاوب صفحة المشاهدة للشاشات الصغيرة ===== */
        .watch-episode-modal {
            max-width: 98vw;
            max-height: 99vh;
            margin: 5px;
            border-radius: 15px;
        }

        /* ===== تجاوب محسن لقسم الأنميات المشابهة ===== */
        @media (max-width: 1200px) {
            .similar-animes-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
                gap: 1.25rem;
            }
        }

        @media (max-width: 992px) {
            .similar-animes-section {
                padding: 1.75rem;
                margin-top: 1.75rem;
            }

            .similar-animes-header h2 {
                font-size: 1.375rem;
            }

            .similar-animes-count {
                padding: 0.625rem 1.25rem;
                font-size: 0.8rem;
            }

            .similar-animes-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 1.125rem;
            }
        }

        @media (max-width: 768px) {
            .similar-animes-section {
                padding: 1.5rem;
                margin-top: 1.5rem;
            }

            .similar-animes-header h2 {
                font-size: 1.25rem;
            }

            .similar-animes-count {
                padding: 0.5rem 1rem;
                font-size: 0.75rem;
            }

            .similar-animes-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
                gap: 1rem;
            }

            .similar-anime-card {
                aspect-ratio: 2/3;
            }

            .similar-anime-overlay {
                padding: 0.875rem;
            }

            .similar-anime-title {
                font-size: 0.8rem;
                margin-bottom: 0.5rem;
            }

            .similar-anime-rating {
                gap: 0.5rem;
            }

            .similar-anime-stars .star {
                font-size: 0.7rem;
            }

            .similar-anime-rating-text {
                font-size: 0.7rem;
            }

            .similar-anime-status {
                top: 0.625rem;
                left: 0.625rem;
                padding: 0.25rem 0.5rem;
                font-size: 0.6rem;
            }

            /* ===== تجاوب شريط البحث عن الحلقات ===== */
            .episodes-search-container {
                padding: 1.25rem;
                margin-bottom: 1.5rem;
            }

            .episodes-search-wrapper {
                padding: 0.625rem 1rem;
            }

            .episodes-search-input {
                font-size: 0.9rem;
            }

            .episodes-search-stats {
                flex-direction: column;
                gap: 0.5rem;
                text-align: center;
            }

            .episodes-found-count,
            .episodes-filtered-count {
                font-size: 0.8rem;
            }

            /* ===== تجاوب شريط تمرير الحلقات ===== */
            .episodes-scroll-container {
                gap: 0.75rem;
            }

            .episodes-scroll-btn {
                width: 2.5rem;
                height: 2.5rem;
            }

            .episodes-scroll-btn i {
                font-size: 1rem;
            }

            .episodes-grid-enhanced .episode-card {
                min-width: 250px;
                max-width: 280px;
            }
        }

        @media (max-width: 480px) {
            .similar-animes-section {
                padding: 1.25rem;
                margin-top: 1.25rem;
            }

            .similar-animes-header h2 {
                font-size: 1.125rem;
            }

            .similar-animes-count {
                padding: 0.375rem 0.75rem;
                font-size: 0.7rem;
            }

            .similar-animes-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 0.875rem;
            }

            .similar-anime-card {
                aspect-ratio: 2/3;
            }

            .similar-anime-overlay {
                padding: 0.75rem;
            }

            .similar-anime-title {
                font-size: 0.75rem;
                margin-bottom: 0.375rem;
            }

            .similar-anime-rating {
                gap: 0.375rem;
            }

            .similar-anime-stars .star {
                font-size: 0.65rem;
            }

            .similar-anime-rating-text {
                font-size: 0.65rem;
            }

            .similar-anime-status {
                top: 0.5rem;
                left: 0.5rem;
                padding: 0.25rem 0.5rem;
                font-size: 0.55rem;
            }

            /* ===== تجاوب شريط البحث عن الحلقات ===== */
            .episodes-search-container {
                padding: 1rem;
                margin-bottom: 1.25rem;
            }

            .episodes-search-wrapper {
                padding: 0.5rem 0.875rem;
            }

            .episodes-search-input {
                font-size: 0.875rem;
            }

            .episodes-search-stats {
                padding: 0.5rem 0.75rem;
            }

            .episodes-found-count,
            .episodes-filtered-count {
                font-size: 0.75rem;
            }

            .no-results-message {
                padding: 2rem 1.5rem;
            }

            .no-results-message i {
                font-size: 2.5rem;
            }

            .no-results-message p {
                font-size: 1rem;
            }

            .clear-search-btn {
                padding: 0.625rem 1.25rem;
                font-size: 0.8rem;
            }

            /* ===== تجاوب شريط تمرير الحلقات للأجهزة الصغيرة ===== */
            .episodes-scroll-container {
                gap: 0.5rem;
            }

            .episodes-scroll-btn {
                width: 2.25rem;
                height: 2.25rem;
            }

            .episodes-scroll-btn i {
                font-size: 0.875rem;
            }

            .episodes-grid-enhanced .episode-card {
                min-width: 220px;
                max-width: 250px;
            }
        }

        @media (max-width: 360px) {
            .similar-animes-section {
                padding: 1rem;
                margin-top: 1rem;
            }

            .similar-animes-header h2 {
                font-size: 1rem;
            }

            .similar-animes-count {
                padding: 0.25rem 0.5rem;
                font-size: 0.65rem;
            }

            .similar-animes-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 0.75rem;
            }

            .similar-anime-card {
                aspect-ratio: 2/3;
            }

            .similar-anime-overlay {
                padding: 0.625rem;
            }

            .similar-anime-title {
                font-size: 0.7rem;
                margin-bottom: 0.25rem;
            }

            .similar-anime-rating {
                gap: 0.25rem;
            }

            .similar-anime-stars .star {
                font-size: 0.6rem;
            }

            .similar-anime-rating-text {
                font-size: 0.6rem;
            }

            .similar-anime-status {
                top: 0.375rem;
                left: 0.375rem;
                padding: 0.125rem 0.375rem;
                font-size: 0.5rem;
            }

            /* ===== تجاوب شريط تمرير الحلقات للأجهزة الصغيرة جداً ===== */
            .episodes-scroll-container {
                gap: 0.375rem;
            }

            .episodes-scroll-btn {
                width: 2rem;
                height: 2rem;
            }

            .episodes-scroll-btn i {
                font-size: 0.75rem;
            }

            .episodes-grid-enhanced .episode-card {
                min-width: 200px;
                max-width: 220px;
            }

            /* ===== تجاوب أزرار الهيدر ===== */
            .header-actions {
                gap: 0.75rem;
            }

            .like-btn-header,
            .favorite-btn-header {
                width: 3rem;
                height: 3rem;
            }

            .like-btn-header i,
            .favorite-btn-header i {
                font-size: 1rem;
            }
        }

            .watch-episode-header {
                padding: 15px;
                gap: 15px;
            }

            .episode-title-section h2 {
                font-size: 1.2rem;
                margin-bottom: 10px;
            }

            .episode-meta {
                gap: 8px;
            }

            .episode-number-badge,
            .server-name-badge {
                padding: 5px 10px;
                font-size: 0.8rem;
            }

            .btn-secondary {
                padding: 12px 16px;
                font-size: 0.9rem;
            }

            .close-modal-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }

            .watch-episode-content {
                padding: 15px;
            }

            .video-container {
                margin-bottom: 20px;
                border-radius: 12px;
            }

            .video-placeholder i {
                font-size: 2.5rem;
                margin-bottom: 12px;
            }

            .video-placeholder p {
                font-size: 0.9rem;
            }

            .episode-controls {
                gap: 15px;
            }

            .episode-navigation {
                gap: 12px;
            }

            .btn-nav {
                padding: 12px 16px;
                font-size: 0.9rem;
            }

            .episode-info-panel {
                padding: 12px;
            }

            .episode-stats {
                gap: 12px;
            }

            .stat-item {
                font-size: 0.9rem;
            }

            .stat-item i {
                font-size: 1rem;
            }

        /* تحسين تجاوب صفحة التفاصيل الجديدة */
        @media (max-width: 1024px) {
            .anime-details-page .max-w-7xl {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            .anime-details-page .grid {
                gap: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .anime-details-page .bg-gradient-to-r {
                padding: 1rem;
            }
            
            .anime-details-page h1 {
                font-size: 1.5rem;
            }
            
            .anime-details-page .flex-col {
                gap: 1rem;
            }
            
            .anime-details-page .sticky {
                position: static;
            }
            
            .anime-details-page .grid-cols-1 {
                gap: 1rem;
            }
            
            .anime-details-page .bg-white {
                padding: 1rem;
            }
            
            .anime-details-page .grid-cols-1.md\\:grid-cols-2 {
                grid-template-columns: 1fr;
            }
            
            .anime-details-page .grid-cols-1.sm\\:grid-cols-2 {
                grid-template-columns: 1fr;
            }
            
            .anime-details-page .grid-cols-1.sm\\:grid-cols-2.lg\\:grid-cols-3 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .anime-details-page .max-w-7xl {
                padding-left: 0.75rem;
                padding-right: 0.75rem;
            }
            
            .anime-details-page .bg-gradient-to-r {
                padding: 0.75rem;
            }
            
            .anime-details-page h1 {
                font-size: 1.25rem;
            }
            
            .anime-details-page .bg-white {
                padding: 0.75rem;
            }
            
            .anime-details-page .grid-cols-1.sm\\:grid-cols-2.lg\\:grid-cols-3 {
                grid-template-columns: 1fr;
            }
            
            .anime-details-page .grid-cols-1.sm\\:grid-cols-2.lg\\:grid-cols-3.xl\\:grid-cols-4 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .anime-details-page .max-w-7xl {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            .anime-details-page .bg-gradient-to-r {
                padding: 0.5rem;
            }
            
            .anime-details-page h1 {
                font-size: 1.125rem;
            }
            
            .anime-details-page .bg-white {
                padding: 0.5rem;
            }
            
            .anime-details-page .grid-cols-1.sm\\:grid-cols-2.lg\\:grid-cols-3.xl\\:grid-cols-4 {
                grid-template-columns: 1fr;
            }
            
            .anime-details-page .w-10.h-10 {
                width: 2rem;
                height: 2rem;
            }
            
            .anime-details-page .text-xl {
                font-size: 1rem;
            }

            /* تحسين حجم الصورة للشاشات الصغيرة */
            .anime-details-page .max-w-xs {
                max-width: 200px;
            }
            
            /* aspect-ratio for cover on small screens */
            .anime-details-page .max-w-xs {
                aspect-ratio: 3 / 4;
            }
        }

        @media (max-width: 640px) {
            /* تحسين حجم الصورة للشاشات المتوسطة */
            .anime-details-page .max-w-xs {
                max-width: 250px;
            }
        

        @media (max-width: 768px) {
            /* تحسين حجم الصورة للشاشات الكبيرة */
            .anime-details-page .max-w-xs {
                max-width: 280px;
            }
        }
            .anime-genres-section {
                padding: 1rem;
                margin-bottom: 1.5rem;
            }

            .anime-genres-section h3 {
                font-size: 1rem;
                margin-bottom: 0.75rem;
            }

            .genres-grid {
                gap: 0.375rem;
            }

            .genre-tag {
                padding: 0.375rem 0.75rem;
                font-size: 0.75rem;
            }
        }

        @media (max-width: 480px) {
            .anime-genres-section {
                padding: 0.75rem;
            }

            .genres-grid {
                gap: 0.25rem;
            }

            .genre-tag {
                padding: 0.25rem 0.5rem;
                font-size: 0.7rem;
                border-radius: 1.5rem;
            }
        }

        /* إخفاء الهيدر القديم وزيادة مسافة أعلى المحتوى */
        .header { display: none; }
        .container { margin-top: 84px; }
    </style>
</head>
<body>
    <div class="bg-aurora"></div>
    <!-- القائمة العلوية المحسنة مع Tailwind CSS -->
    <div class="fixed top-0 left-0 right-0 z-40 bg-white/80 backdrop-blur-xl border-b border-gray-200/50 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- الجانب الأيسر - زر القائمة والشعار -->
                <div class="flex items-center gap-4">
                    <button class="w-12 h-12 bg-gradient-to-r from-primary-500 to-secondary-500 hover:from-primary-600 hover:to-secondary-600 text-white rounded-xl flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl" id="openSidebar" title="القائمة">
                        <i class="fas fa-bars text-lg"></i>
                    </button>
                    
                    <div class="flex items-center gap-3">
                       
                        <div class="hidden sm:block">
                    
                        </div>
                    </div>
                </div>

                <!-- الوسط - عنوان الصفحة -->
                <div class="flex-1 flex justify-center">
                    <div class="text-center">
                       
                        <div class="flex items-center justify-center gap-2 text-sm text-gray-600">
                          
                          
                        </div>
                    </div>
                </div>

                <!-- الجانب الأيمن - الإجراءات -->
                <div class="flex items-center gap-3">
                    <!-- زر البحث -->
                    <a href="search.html" class="w-12 h-12 bg-gradient-to-r from-accent-500 to-orange-500 hover:from-accent-600 hover:to-orange-600 text-white rounded-xl flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl" title="بحث">
                        <i class="fas fa-search text-lg"></i>
                    </a>
                    

                    

                    
                    <!-- زر تلجرام -->
                    <a href="https://t.me/EgyptianHokage" target="_blank" class="w-12 h-12 bg-gradient-to-r from-blue-400 to-blue-500 hover:from-blue-500 hover:to-blue-600 text-white rounded-xl flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl" title="انضم إلينا على تلجرام">
                        <i class="fab fa-telegram-plane text-lg"></i>
                    </a>
                    
                    <!-- زر يوتيوب -->
                    <a href="https://youtube.com/@khaled-egyptianhokage?si=BoBUUHOMRMr_T2-f" target="_blank" class="w-12 h-12 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-xl flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl" title="تابعنا على يوتيوب">
                        <i class="fab fa-youtube text-lg"></i>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- شريط التقدم -->
        <div class="h-1 bg-gradient-to-r from-primary-500 via-secondary-500 to-accent-500 animate-pulse"></div>
    </div>

    <!-- القائمة الجانبية المحسنة مع Tailwind CSS -->
    <div class="fixed top-0 right-0 h-full w-80 bg-gradient-to-b from-white via-gray-50 to-white shadow-lg transform translate-x-full transition-transform duration-150 ease-in-out z-50 border-l border-gray-200/50 flex flex-col" id="sidebar">
        <!-- رأس القائمة -->
        <div class="flex items-center justify-between p-6 border-b border-gray-200/50 bg-gradient-to-r from-primary-500 to-secondary-500">
            <div class="flex items-center gap-3">
                <img src="anime4u.png" alt="شعار أنمي فور يو" class="w-10 h-10 rounded-xl shadow-lg">
                <span class="text-white font-bold text-lg">القائمة</span>
            </div>
            <button class="w-10 h-10 bg-white/20 hover:bg-white/30 text-white rounded-full flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg" id="closeSidebar">
                <i class="fas fa-times text-lg"></i>
            </button>
        </div>
        
        <!-- محتوى القائمة -->
        <div class="p-6 space-y-4 overflow-y-auto flex-1">
            <!-- معلومات المستخدم -->
            <div id="userInfo" class="mb-6" style="display: none;">
                <div class="bg-gradient-to-r from-primary-50 to-secondary-50 rounded-xl p-4 border border-primary-200 shadow-lg">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="relative">
                            <img id="userProfileImage" src="anime4u.png" alt="صورة المستخدم" class="w-16 h-16 rounded-full border-3 border-primary-300 object-cover shadow-lg hover:scale-105 transition-transform duration-300">
                            <div class="absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 border-2 border-white rounded-full"></div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h4 id="userUsername" class="font-bold text-gray-800 text-lg truncate">اسم المستخدم</h4>
                            <p id="userEmail" class="text-gray-600 text-sm truncate">البريد الإلكتروني</p>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-primary-100 text-primary-800">
                                    <i class="fas fa-user-circle ml-1"></i>
                                    مستخدم نشط
                                </span>
                    </div>
                        </div>
                    </div>
                    
                    <!-- أزرار الإجراءات -->
                    <div class="space-y-2">
                        <button onclick="logout()" class="w-full bg-red-500 hover:bg-red-600 text-white py-2.5 px-4 rounded-lg text-sm font-semibold transition-all duration-200 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]">
                        <i class="fas fa-sign-out-alt ml-2"></i>
                        تسجيل الخروج
                    </button>
                    
                    <!-- زر لوحة التحكم للأدمن -->
                        <button id="adminPanelBtnUserInfo" onclick="window.location.href='admin.html'" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2.5 px-4 rounded-lg text-sm font-semibold transition-all duration-200 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]" style="display: none;">
                        <i class="fas fa-user-shield ml-2"></i>
                        لوحة التحكم
                    </button>
                    </div>
                </div>
            </div>

            <!-- تسجيل الدخول -->
            <div id="loginSection" class="mb-6">
                <h3 class="text-gray-700 font-bold text-sm uppercase tracking-wider mb-4 flex items-center gap-2">
                    <i class="fas fa-user-lock text-primary-500"></i>
                    تسجيل الدخول
                </h3>
                
                <!-- زر تسجيل الدخول -->
                <button onclick="window.location.href='login.html'" class="w-full flex items-center gap-3 px-4 py-3.5 rounded-xl bg-gradient-to-r from-primary-50 to-primary-100 text-primary-700 font-semibold border-2 border-primary-200 hover:bg-gradient-to-r hover:from-primary-100 hover:to-primary-200 hover:text-primary-800 hover:border-primary-300 shadow-lg hover:shadow-xl transition-all duration-300 group hover:scale-[1.02] active:scale-[0.98]">
                    <div class="flex items-center justify-center w-11 h-11 bg-primary-200 rounded-xl group-hover:bg-primary-300 transition-all duration-300 group-hover:scale-110">
                        <i class="fas fa-sign-in-alt text-lg text-primary-600 group-hover:text-primary-700"></i>
                    </div>
                    <div class="flex-1 text-right">
                        <div class="font-bold text-gray-800 text-lg">تسجيل الدخول</div>
                        <div class="text-primary-600 text-sm opacity-90">دخول إلى حسابك</div>
                    </div>
                    <div class="opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <i class="fas fa-arrow-left text-primary-500"></i>
                    </div>
                </button>
                
                <!-- زر إنشاء حساب جديد -->
                <button onclick="window.location.href='register.html'" class="w-full flex items-center gap-3 px-4 py-3.5 rounded-xl bg-gradient-to-r from-secondary-50 to-secondary-100 text-secondary-700 font-semibold border-2 border-secondary-200 hover:bg-gradient-to-r hover:from-secondary-100 hover:to-secondary-200 hover:text-secondary-800 hover:border-secondary-300 shadow-lg hover:shadow-xl transition-all duration-300 group hover:scale-[1.02] active:scale-[0.98] mt-3">
                    <div class="flex items-center justify-center w-11 h-11 bg-secondary-200 rounded-xl group-hover:bg-secondary-300 transition-all duration-300 group-hover:scale-110">
                        <i class="fas fa-user-plus text-lg text-secondary-600 group-hover:text-secondary-700"></i>
                    </div>
                    <div class="flex-1 text-right">
                        <div class="font-bold text-gray-800 text-lg">إنشاء حساب</div>
                        <div class="text-secondary-600 text-sm opacity-90">انضم إلينا الآن</div>
                    </div>
                    <div class="opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <i class="fas fa-arrow-left text-secondary-500"></i>
                    </div>
                </button>
                
                <!-- زر لوحة التحكم للأدمن -->
                <button id="adminPanelBtn" onclick="window.location.href='admin.html'" class="w-full flex items-center gap-3 px-4 py-3.5 rounded-xl bg-gradient-to-r from-purple-50 to-purple-100 text-purple-700 font-semibold border-2 border-purple-200 hover:bg-gradient-to-r hover:from-purple-100 hover:to-purple-200 hover:text-purple-800 hover:border-purple-300 shadow-lg hover:shadow-xl transition-all duration-300 group hover:scale-[1.02] active:scale-[0.98] mt-3" style="display: none;">
                    <div class="flex items-center justify-center w-11 h-11 bg-purple-200 rounded-xl group-hover:bg-purple-300 transition-all duration-300 group-hover:scale-110">
                        <i class="fas fa-user-shield text-lg text-purple-600 group-hover:text-purple-700"></i>
                    </div>
                    <div class="flex-1 text-right">
                        <div class="font-bold text-gray-800 text-lg">لوحة التحكم</div>
                        <div class="text-purple-600 text-sm opacity-90">إدارة الموقع</div>
                    </div>
                    <div class="opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <i class="fas fa-arrow-left text-purple-500"></i>
                    </div>
                </button>
            </div>

            <!-- قسم الفلاتر -->
            <div class="space-y-3">
                <h3 class="text-gray-700 font-bold text-sm uppercase tracking-wider mb-4 flex items-center gap-2">
                    <i class="fas fa-filter text-primary-500"></i>
                    الفلاتر
                </h3>
                
                <!-- فلتر الكل -->
                <button class="filter-btn w-full flex items-center gap-3 px-4 py-3.5 rounded-xl bg-gradient-to-r from-gray-50 to-gray-100 text-gray-700 font-semibold border-2 border-gray-200 hover:bg-gradient-to-r hover:from-gray-100 hover:to-gray-200 hover:text-gray-800 hover:border-gray-300 shadow-lg hover:shadow-xl transition-all duration-300 group hover:scale-[1.02] active:scale-[0.98] active" data-filter="all">
                    <div class="flex items-center justify-center bg-gray-200 rounded-xl group-hover:bg-gray-300 transition-all duration-300 group-hover:scale-110 filter-icon-box">
                        <i class="fas fa-th-large text-gray-700 filter-icon"></i>
                    </div>
                    <div class="flex-1 text-right">
                        <div class="font-bold text-gray-800 filter-title">الكل</div>
                        <div class="text-gray-600 opacity-90 filter-subtitle">جميع الأنميات</div>
                    </div>
                    <div class="bg-gray-200 text-gray-700 rounded-full font-medium backdrop-blur-sm group-hover:bg-gray-300 transition-all duration-300 filter-badge">جميع الأنميات</div>
                </button>
                
                <!-- فلتر يعرض الآن -->
                <button class="filter-btn w-full flex items-center gap-3 px-4 py-3.5 rounded-xl bg-gradient-to-r from-success-50 to-success-100 text-success-700 font-semibold border-2 border-success-200 hover:bg-gradient-to-r hover:from-success-100 hover:to-success-200 hover:text-success-800 hover:border-success-300 shadow-lg hover:shadow-xl transition-all duration-300 group hover:scale-[1.02] active:scale-[0.98]" data-filter="ongoing">
                    <div class="flex items-center justify-center bg-success-200 rounded-xl group-hover:bg-success-300 transition-all duration-300 group-hover:scale-110 filter-icon-box">
                        <i class="fas fa-broadcast-tower text-success-600 filter-icon"></i>
                    </div>
                    <div class="flex-1 text-right">
                        <div class="font-bold text-gray-800 filter-title">يعرض الآن</div>
                        <div class="text-success-600 opacity-90 filter-subtitle">مباشر</div>
                    </div>
                    <div class="bg-success-200 text-success-600 rounded-full font-medium group-hover:bg-success-300 transition-all duration-300 filter-badge">مباشر</div>
                </button>
                
                <!-- فلتر مكتمل -->
                <button class="filter-btn w-full flex items-center gap-3 px-4 py-3.5 rounded-xl bg-gradient-to-r from-green-50 to-green-100 text-green-700 font-semibold border-2 border-green-200 hover:bg-gradient-to-r hover:from-green-100 hover:to-green-200 hover:text-green-800 hover:border-green-300 shadow-lg hover:shadow-xl transition-all duration-300 group hover:scale-[1.02] active:scale-[0.98]" data-filter="completed">
                    <div class="flex items-center justify-center bg-green-200 rounded-xl group-hover:bg-green-300 transition-all duration-300 group-hover:scale-110 filter-icon-box">
                        <i class="fas fa-check-circle text-green-600 filter-icon"></i>
                    </div>
                    <div class="flex-1 text-right">
                        <div class="font-bold text-gray-800 filter-title">مكتمل</div>
                        <div class="text-green-600 opacity-90 filter-subtitle">منتهي</div>
                    </div>
                    <div class="bg-green-200 text-green-600 rounded-full font-medium group-hover:bg-green-300 transition-all duration-300 filter-badge">منتهي</div>
                </button>
                
                <!-- فلتر أفلام -->
                <button class="filter-btn w-full flex items-center gap-3 px-4 py-3.5 rounded-xl bg-gradient-to-r from-orange-50 to-orange-100 text-orange-700 font-semibold border-2 border-orange-200 hover:bg-gradient-to-r hover:from-orange-100 hover:to-orange-200 hover:text-orange-800 hover:border-orange-300 shadow-lg hover:shadow-xl transition-all duration-300 group hover:scale-[1.02] active:scale-[0.98]" data-filter="movie">
                    <div class="flex items-center justify-center bg-orange-200 rounded-xl group-hover:bg-orange-300 transition-all duration-300 group-hover:scale-110 filter-icon-box">
                        <i class="fas fa-film text-orange-600 filter-icon"></i>
                    </div>
                    <div class="flex-1 text-right">
                        <div class="font-bold text-gray-800 filter-title">أفلام</div>
                        <div class="text-orange-600 opacity-90 filter-subtitle">سينما</div>
                    </div>
                    <div class="bg-orange-200 text-orange-600 rounded-full font-medium group-hover:bg-orange-300 transition-all duration-300 filter-badge">سينما</div>
                </button>
                
                <!-- فلتر المفضلة -->
                <button class="filter-btn w-full flex items-center gap-3 px-4 py-3.5 rounded-xl bg-gradient-to-r from-red-50 to-red-100 text-red-700 font-semibold border-2 border-red-200 hover:bg-gradient-to-r hover:from-red-100 hover:to-red-200 hover:text-red-800 hover:border-red-300 shadow-lg hover:shadow-xl transition-all duration-300 group hover:scale-[1.02] active:scale-[0.98]" data-filter="favorite">
                    <div class="flex items-center justify-center bg-red-200 rounded-xl group-hover:bg-red-300 transition-all duration-300 group-hover:scale-110 filter-icon-box">
                        <i class="fas fa-heart text-red-600 filter-icon"></i>
                    </div>
                    <div class="flex-1 text-right">
                        <div class="font-bold text-gray-800 filter-title">المفضلة</div>
                        <div class="text-red-600 opacity-90 filter-subtitle">أنميات محفوظة</div>
                    </div>
                    <div class="bg-red-200 text-red-600 rounded-full font-medium group-hover:bg-red-300 transition-all duration-300 filter-badge">أنميات محفوظة</div>
                </button>
            </div>

        </div>
        
        <!-- تذييل القائمة -->
        <div class="mt-auto p-5 sm:p-6 bg-gradient-to-t from-gray-50 to-transparent border-t border-gray-200/50">
            <div class="text-center group">
                <div class="flex items-center justify-center gap-2 mb-2">
                    <img src="anime4u.png" alt="شعار أنمي فور يو" class="rounded-lg opacity-80 group-hover:opacity-100 transition-opacity duration-300"
                         style="width: clamp(18px, 2.2vw, 24px); height: clamp(18px, 2.2vw, 24px);">
                    <div class="font-bold text-gray-700 group-hover:text-primary-600 transition-colors duration-300"
                         style="font-size: clamp(12px, 1.8vw, 14px);">أنمي فور يو</div>
                </div>
                <div class="text-gray-400 group-hover:text-gray-500 transition-colors duration-300"
                     style="font-size: clamp(10px, 1.6vw, 12px);">أفضل تطبيق لمشاهدة الأنميات</div>
            </div>
        </div>
    </div>
    
    <!-- خلفية القائمة -->
    <div class="fixed inset-0 bg-black/50 backdrop-blur-sm opacity-0 pointer-events-none transition-opacity duration-300 z-40" id="sidebarBackdrop"></div>
    <div class="container">
        <div class="header"></div>

        

        <div id="animeContainer">
            <div class="flex flex-col items-center justify-center min-h-[60vh] p-20 text-center bg-gradient-to-br from-white/20 via-primary-50/30 to-secondary-50/20 rounded-3xl backdrop-blur-xl border border-white/30 shadow-2xl relative overflow-hidden group">
                <!-- تأثيرات الخلفية المتحركة -->
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-primary-500/20 to-transparent animate-shimmer"></div>
                <div class="absolute inset-0 bg-gradient-to-br from-primary-400/10 via-transparent to-secondary-400/10 animate-pulse-slow"></div>
                
                <!-- دوائر متحركة في الخلفية -->
                <div class="absolute top-10 left-10 w-20 h-20 bg-primary-400/20 rounded-full animate-bounce-slow"></div>
                <div class="absolute bottom-10 right-10 w-16 h-16 bg-secondary-400/20 rounded-full animate-bounce-slow" style="animation-delay: 0.5s;"></div>
                <div class="absolute top-1/2 left-1/4 w-12 h-12 bg-accent-400/20 rounded-full animate-pulse-slow"></div>
                
                <!-- النص الرئيسي -->
                <div class="relative z-10 mb-6">
                    <!-- شعار التطبيق مع أيقونة التحميل -->
                    <div class="mb-6 text-center">
                        <div class="relative inline-block">
                            <!-- صورة الشعار -->
                            <img src="anime4u.png" alt="شعار أنمي 4U" class="w-20 h-20 rounded-2xl shadow-2xl hover:scale-110 transition-transform duration-500">
                            

                        </div>
                    </div>
                    
                    <h2 class="text-3xl md:text-4xl font-black bg-gradient-to-r from-primary-600 via-secondary-600 to-accent-600 bg-clip-text text-transparent mb-2 drop-shadow-lg">
                        جاري تحميل الأنميات
                    </h2>
                    <p class="text-lg text-gray-600 font-medium opacity-80">
                        يرجى الانتظار قليلاً...
                    </p>
                </div>
                
                <!-- شريط التقدم -->
                <div class="relative z-10">
                    <div class="bg-white/20 backdrop-blur-sm px-8 py-4 rounded-2xl border border-white/30 shadow-lg">
                        <div class="flex items-center gap-3">
                            <div class="w-4 h-4 bg-primary-500 rounded-full animate-pulse"></div>
                            <span class="text-lg font-semibold text-gray-700 bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent">
                                جاري التحميل...
                            </span>
                            <div class="w-4 h-4 bg-secondary-500 rounded-full animate-pulse" style="animation-delay: 0.3s;"></div>
                        </div>
                    </div>
                </div>
                
                <!-- رسالة إضافية -->
                <div class="relative z-10 mt-6">
                    <div class="bg-gradient-to-r from-primary-100/50 to-secondary-100/50 px-6 py-3 rounded-full border border-primary-200/30">
                        <span class="text-sm font-medium text-primary-700">
                            <i class="fas fa-info-circle mr-2"></i>
                            يتم تحميل البيانات من قاعدة البيانات
                        </span>
                    </div>
                </div>
                
                <!-- أيقونة التحميل الرئيسية -->
                <div class="relative z-10 mt-8">
                    <div class="relative">
                        <!-- دائرة خارجية متحركة -->
                        <div class="absolute inset-0 w-24 h-24 border-4 border-primary-200/30 rounded-full animate-spin-slow"></div>
                        <div class="absolute inset-0 w-24 h-24 border-4 border-transparent border-t-primary-500 rounded-full animate-spin"></div>
                        <div class="absolute inset-0 w-24 h-24 border-4 border-transparent border-r-secondary-500 rounded-full animate-spin" style="animation-direction: reverse; animation-duration: 2s;"></div>
                        
                        <!-- الأيقونة المركزية -->
                        <div class="w-24 h-24 bg-gradient-to-br from-primary-500 to-secondary-500 rounded-full flex items-center justify-center shadow-2xl group-hover:shadow-primary-500/50 transition-all duration-500 transform group-hover:scale-110">
                            <i class="fas fa-spinner fa-spin text-3xl text-white drop-shadow-lg"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/all_images.js"></script>
    <script src="js/anime-image-loader.js"></script>
    <script>

        let allAnimes = [];
        let filteredAnimes = [];
        let favorites = JSON.parse(localStorage.getItem('anime4u_favorites') || '[]');

        // فحص الاتصال بالإنترنت
        function checkInternetConnection() {
            return navigator.onLine;
        }

        // عرض صفحة عدم وجود اتصال بالإنترنت
        function showNoInternetPage() {
            const container = document.getElementById('animeContainer');
            container.innerHTML = `
                <div class="flex flex-col items-center justify-center min-h-[80vh] p-8 text-center">
                    <!-- أيقونة عدم الاتصال -->
                    <div class="mb-8">
                        <div class="w-24 h-24 bg-red-500 rounded-full flex items-center justify-center mx-auto">
                            <i class="fas fa-wifi-slash text-4xl text-white"></i>
                        </div>
                    </div>
                    
                    <!-- النص الرئيسي -->
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-red-600 mb-4">
                            لا يوجد اتصال بالإنترنت
                        </h2>
                        <p class="text-lg text-gray-700 mb-6 max-w-md">
                            يبدو أن اتصالك بالإنترنت قد انقطع. يرجى التحقق من اتصالك والمحاولة مرة أخرى.
                        </p>
                    </div>
                    
                    <!-- معلومات إضافية -->
                    <div class="mb-8">
                        <div class="bg-gray-100 px-6 py-4 rounded-lg border border-gray-300 max-w-md">
                            <div class="space-y-3 text-left">
                                <div class="flex items-center gap-3 text-gray-700">
                                    <i class="fas fa-exclamation-triangle text-red-500"></i>
                                    <span>لا يمكن تحميل البيانات من الخادم</span>
                                </div>
                                <div class="flex items-center gap-3 text-gray-700">
                                    <i class="fas fa-wifi text-orange-500"></i>
                                    <span>تحقق من اتصال Wi-Fi أو البيانات الخلوية</span>
                                </div>
                                <div class="flex items-center gap-3 text-gray-700">
                                    <i class="fas fa-router text-blue-500"></i>
                                    <span>أعد تشغيل المودم أو الراوتر</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- أزرار الإجراءات -->
                    <div class="flex flex-col sm:flex-row gap-4">
                        <button onclick="retryConnection()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors duration-200 flex items-center gap-2">
                            <i class="fas fa-redo-alt"></i>
                            إعادة المحاولة
                        </button>
                        <button onclick="checkConnectionStatus()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors duration-200 flex items-center gap-2">
                            <i class="fas fa-info-circle"></i>
                            فحص الاتصال
                        </button>
                    </div>
                    
                    <!-- رسالة إضافية -->
                    <div class="mt-6">
                        <div class="bg-gray-100 px-4 py-2 rounded-full border border-gray-300">
                            <span class="text-sm text-gray-600">
                                <i class="fas fa-clock mr-2"></i>
                                سيتم إعادة المحاولة تلقائياً عند عودة الاتصال
                            </span>
                        </div>
                    </div>
                </div>
            `;
        }

        // إعادة محاولة الاتصال
        function retryConnection() {
            if (checkInternetConnection()) {
                loadAnimeData();
            } else {
                showNoInternetPage();
            }
        }

        // فحص حالة الاتصال
        function checkConnectionStatus() {
            const isOnline = checkInternetConnection();
            if (isOnline) {
                showToast('تم استعادة الاتصال بالإنترنت!', 'success');
                loadAnimeData();
            } else {
                showToast('لا يزال الاتصال مفقوداً', 'error');
            }
        }

        // عرض رسالة منبثقة
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 z-50 p-4 rounded-lg text-white font-semibold transition-all duration-300 ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 
                'bg-blue-500'
            } transform translate-x-full`;
            
            toast.innerHTML = `
                <div class="flex items-center gap-3">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            // إظهار الرسالة
            setTimeout(() => {
                toast.classList.remove('translate-x-full');
            }, 100);
            
            // إخفاء الرسالة بعد 3 ثوانٍ
            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        // تحميل البيانات
        async function loadAnimeData() {
            try { localStorage.setItem('anime4u_initial_load_done','1'); document.documentElement.setAttribute('data-initial-loaded','true'); } catch(e) {}
            // فحص الاتصال أولاً
            if (!checkInternetConnection()) {
                showNoInternetPage();
                return;
            }

            const origin = window.location.origin || '';
            const path = window.location.pathname || '';
            const dir = path.endsWith('/') ? path : path.substring(0, path.lastIndexOf('/') + 1);
            const likelyBases = [
                origin + '/anime4u/www/',
                origin + '/anime4u/',
                origin + dir,
            ];
            const candidates = [
                // مطلقة مع قواعد شائعة في هذا المشروع
                ...likelyBases.map(b => b + 'anime_data.json'),
                // نسبية
                'anime_data.json',
                './anime_data.json',
                '../anime_data.json',
                '../../anime_data.json',
                '/anime4u/www/anime_data.json',
                '/anime4u/anime_data.json',
                '/anime_data.json',
                // مسارات Android assets
                'file:///android_asset/www/anime_data.json',
                'android_asset/www/anime_data.json',
                'assets/www/anime_data.json',
                'file:///android_asset/anime_data.json',
                'file:///assets/anime_data.json',
                // مسارات إضافية للتطبيق
                'file:///android_asset/www/anime_data.json',
                'android_asset/www/anime_data.json'
            ];
            const uniqueCandidates = Array.from(new Set(candidates));
            let lastError = null;
            for (const url of uniqueCandidates) {
                try {
                    const response = await fetch(url, { cache: 'no-cache' });
                    if (!response.ok) throw new Error(`HTTP ${response.status} for ${url}`);
                    let data;
                    try {
                        data = await response.json();
                    } catch (parseErr) {
                        // محاولة تنظيف النص ثم التحويل إلى JSON
                        let text = await response.clone().text();
                        text = text.replace(/^\uFEFF/, '').trim();
                        // إزالة الفواصل الزائدة المحتملة
                        text = text.replace(/,\s*([}\]])/g, '$1');
                        data = JSON.parse(text);
                    }
                allAnimes = Object.values(data);
                filteredAnimes = [...allAnimes];
                displayAnimes();
                updateStats();
                    // فتح التفاصيل عبر ?anime=
                    try {
                        const params = new URLSearchParams(window.location.search);
                        const requestedAnime = params.get('anime');
                        if (requestedAnime) {
                            showAnimeDetails(decodeURIComponent(requestedAnime));
                            if (history && history.replaceState) {
                                history.replaceState(null, '', window.location.pathname);
                            }
                        }
                    } catch (_) {}
                    return; // نجاح
                } catch (err) {
                    lastError = err;
                    console.warn('فشل تحميل:', url, err);
                }
            }
            console.error('خطأ في تحميل البيانات:', lastError);
                document.getElementById('animeContainer').innerHTML = `
                    <div class="flex flex-col items-center justify-center min-h-[40vh] p-12 text-center">
                        <div class="bg-white rounded-2xl shadow-xl border border-gray-200 p-8 max-w-md">
                        <i class="fas fa-exclamation-triangle text-5xl text-red-500 mb-4"></i>
                            <h3 class="text-xl font-bold text-gray-800 mb-2">حدث خطأ في تحميل البيانات</h3>
                        <p class="text-gray-600">تعذر تحميل ملف <span class="font-semibold">anime_data.json</span>. تأكد من تشغيل الصفحة من المسار الصحيح أو ضع الملف في نفس مجلد الصفحة.</p>
                        </div>
                    </div>
                `;
        }

        // عرض الأنميات بشكل تدريجي لتجنب التعليق
        function displayAnimesInBatches() {
            const container = document.getElementById('animeContainer');
            const batchSize = 20; // عرض 20 أنمي في كل مرة
            let currentIndex = 0;
            
            // إظهار رسالة التحميل المحسنة مع Tailwind CSS
            container.innerHTML = `
                <div class="flex flex-col items-center justify-center min-h-[60vh] p-20 text-center bg-gradient-to-br from-white/20 via-primary-50/30 to-secondary-50/20 rounded-3xl backdrop-blur-xl border border-white/30 shadow-2xl relative overflow-hidden group">
                    <!-- تأثيرات الخلفية المتحركة -->
                    <div class="absolute inset-0 bg-gradient-to-r from-transparent via-primary-500/20 to-transparent animate-shimmer"></div>
                    <div class="absolute inset-0 bg-gradient-to-br from-primary-400/10 via-transparent to-secondary-400/10 animate-pulse-slow"></div>
                    
                    <!-- دوائر متحركة في الخلفية -->
                    <div class="absolute top-10 left-10 w-20 h-20 bg-primary-400/20 rounded-full animate-bounce-slow"></div>
                    <div class="absolute bottom-10 right-10 w-16 h-16 bg-secondary-400/20 rounded-full animate-bounce-slow" style="animation-delay: 0.5s;"></div>
                    <div class="absolute top-1/2 left-1/4 w-12 h-12 bg-accent-400/20 rounded-full animate-pulse-slow"></div>
                    
                    <!-- النص الرئيسي -->
                    <div class="relative z-10 mb-6">
                        <!-- شعار التطبيق مع أيقونة التحميل -->
                        <div class="mb-6 text-center">
                            <div class="relative inline-block">
                                <!-- صورة الشعار -->
                                <img src="anime4u.png" alt="شعار أنمي 4U" class="w-20 h-20 rounded-2xl shadow-2xl hover:scale-110 transition-transform duration-500">
                                

                            </div>
                        </div>
                        
                        <h2 class="text-3xl md:text-4xl font-black bg-gradient-to-r from-primary-600 via-secondary-600 to-accent-600 bg-clip-text text-transparent mb-2 drop-shadow-lg">
                            جاري تحميل الأنميات
                        </h2>
                        <p class="text-lg text-gray-600 font-medium opacity-80">
                            يتم معالجة البيانات...
                        </p>
                    </div>
                    
                    <!-- شريط التقدم -->
                    <div class="relative z-10">
                        <div class="bg-white/20 backdrop-blur-sm px-8 py-4 rounded-2xl border border-white/30 shadow-lg">
                            <div class="flex items-center gap-3">
                                <div class="w-4 h-4 bg-primary-500 rounded-full animate-pulse"></div>
                                <span class="text-lg font-semibold text-gray-700 bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent">
                                    0/${filteredAnimes.length}
                                </span>
                                <div class="w-4 h-4 bg-secondary-500 rounded-full animate-pulse" style="animation-delay: 0.3s;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- رسالة إضافية -->
                    <div class="relative z-10 mt-6">
                        <div class="bg-gradient-to-r from-primary-100/50 to-secondary-100/50 px-6 py-3 rounded-full border border-primary-200/30">
                            <span class="text-sm font-medium text-primary-700">
                                <i class="fas fa-chart-line mr-2"></i>
                                جاري معالجة ${filteredAnimes.length} أنمي
                            </span>
                        </div>
                    </div>
                    
                    <!-- أيقونة التحميل الرئيسية -->
                    <div class="relative z-10 mt-8">
                        <div class="relative">
                            <!-- دائرة خارجية متحركة -->
                            <div class="absolute inset-0 w-24 h-24 border-4 border-primary-200/30 rounded-full animate-spin-slow"></div>
                            <div class="absolute inset-0 w-24 h-24 border-4 border-transparent border-t-primary-500 rounded-full animate-spin"></div>
                            <div class="absolute inset-0 w-24 h-24 border-4 border-transparent border-r-secondary-500 rounded-full animate-spin" style="animation-direction: reverse; animation-duration: 2s;"></div>
                            
                            <!-- الأيقونة المركزية -->
                            <div class="w-24 h-24 bg-gradient-to-br from-primary-500 to-secondary-500 rounded-full flex items-center justify-center shadow-2xl group-hover:shadow-primary-500/50 transition-all duration-500 transform group-hover:scale-110">
                                <i class="fas fa-spinner fa-spin text-3xl text-white drop-shadow-lg"></i>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            function processBatch() {
                const batch = filteredAnimes.slice(currentIndex, currentIndex + batchSize);
                
                if (batch.length === 0) {
                    // انتهى التحميل
                    return;
                }
                
                // إنشاء HTML للدفعة الحالية
                const batchHTML = batch.map(anime => createAnimeCard(anime)).join('');
                
                // إضافة الدفعة إلى الحاوية مع Tailwind CSS
                if (currentIndex === 0) {
                    container.innerHTML = `<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6 lg:gap-8 p-4">${batchHTML}</div>`;
                } else {
                    const grid = container.querySelector('.grid');
                    if (grid) {
                        grid.insertAdjacentHTML('beforeend', batchHTML);
                    }
                }
                
                currentIndex += batchSize;
                
                // تحديث رسالة التحميل
                const loadingEl = container.querySelector('.loading');
                if (loadingEl) {
                    const progressEl = loadingEl.querySelector('.loading-progress');
                    if (progressEl) {
                        progressEl.textContent = `${Math.min(currentIndex, filteredAnimes.length)}/${filteredAnimes.length}`;
                    }
                }
                
                // معالجة الدفعة التالية بعد فترة قصيرة
                if (currentIndex < filteredAnimes.length) {
                    setTimeout(processBatch, 50); // تأخير 50ms بين كل دفعة
                } else {
                    // إزالة رسالة التحميل
                    if (loadingEl) {
                        loadingEl.remove();
                    }
                }
            }
            
            // بدء المعالجة
            processBatch();
        }

        // إنشاء بطاقة أنمي واحدة
        function createAnimeCard(anime) {
            const foundImagePath = (typeof findBestImage === 'function') ? findBestImage(anime.name) : null;
            const imagePath = foundImagePath || (anime.image ? `img/${anime.image}` : '');
            const episodes = anime.episodes ? anime.episodes.length : 0;
            const rating = 5;
            const isFavorite = favorites.includes(anime.name);
            const status = anime['حالة الأنمي'] || anime['الحالة'] || '';

            return `
                <div class="group bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 border-2 border-gray-100 hover:border-primary-300 overflow-hidden cursor-pointer transform hover:scale-105" onclick="window.location.href='details.html?anime=${encodeURIComponent(anime.name)}'">
                    <div class="relative aspect-[2/3] overflow-hidden">
                        ${imagePath ? `<img src="${imagePath}" alt="${anime.name}" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110" loading="lazy" decoding="async" onerror="this.style.display='none'; var ph=this.closest('.relative').querySelector('.img-placeholder'); if(ph) ph.style.display='flex';">` : ''}
                        <div class="img-placeholder absolute inset-0 flex items-center justify-center bg-gray-100 text-gray-400 text-4xl" style="${imagePath ? 'display:none;' : 'display:flex;'}"><i class="fas fa-image"></i></div>
                        
                        <!-- شارة الحلقات -->
                        <div class="absolute top-3 right-3 bg-gradient-to-r from-primary-500 to-secondary-500 text-white text-sm font-bold w-8 h-8 rounded-full flex items-center justify-center shadow-lg">
                            ${episodes}
                        </div>
                        

                        
                        <!-- شارة الحالة -->
                        ${status ? `
                            <div class="absolute bottom-3 left-3 bg-gradient-to-r ${status.includes('يعرض') ? 'from-success-500 to-emerald-500' : 'from-danger-500 to-red-600'} text-white text-xs sm:text-sm md:text-base font-bold px-2 py-1 sm:px-3 sm:py-1 md:px-4 md:py-2 rounded-full shadow-lg flex items-center gap-1 transition-all duration-300 hover:scale-105">
                                <i class="${status.includes('يعرض') ? 'fas fa-broadcast-tower' : 'fas fa-check'} text-xs sm:text-sm md:text-base"></i>
                                <span class="hidden xs:inline">${status.includes('يعرض') ? 'يعرض الآن' : 'مكتمل'}</span>
                                <span class="xs:hidden">${status.includes('يعرض') ? 'يعرض' : 'مكتمل'}</span>
                            </div>
                        ` : ''}
                        
                        <!-- طبقة التدرج -->
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    </div>
                    
                    <div class="p-4 space-y-3">
                        <div class="text-gray-800 font-bold text-sm leading-tight line-clamp-2 group-hover:text-primary-600 transition-colors duration-300">
                            ${anime.name}
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-1 text-yellow-500">
                                ${createStars(rating)}
                            </div>
                            <span class="text-gray-600 font-semibold text-sm">${rating.toFixed(1)}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // تحديث الإحصائيات
        function updateStats() {
            const totalAnimes = allAnimes.length;
            const favoriteCount = favorites.length;
            const totalEpisodes = allAnimes.reduce((sum, anime) => sum + (anime.episodes ? anime.episodes.length : 0), 0);
            
            // تحديث الإحصائيات في الهيدر الرئيسي
            const totalAnimesEl = document.getElementById('totalAnimes');
            if (totalAnimesEl) totalAnimesEl.textContent = totalAnimes;
            const favoriteCountEl = document.getElementById('favoriteCount');
            if (favoriteCountEl) favoriteCountEl.textContent = favoriteCount;
            const totalEpisodesEl = document.getElementById('totalEpisodes');
            if (totalEpisodesEl) totalEpisodesEl.textContent = totalEpisodes;
            
            // تحديث الإحصائيات في القائمة الجانبية
            const totalAnimesSidebar = document.getElementById('totalAnimesSidebar');
            const favoriteCountSidebar = document.getElementById('favoriteCountSidebar');
            const totalEpisodesSidebar = document.getElementById('totalEpisodesSidebar');
            
            // قد لا تكون عناصر الإحصائيات موجودة في القائمة الجانبية
            if (totalAnimesSidebar) totalAnimesSidebar.textContent = totalAnimes;
            if (favoriteCountSidebar) favoriteCountSidebar.textContent = favoriteCount;
            if (totalEpisodesSidebar) totalEpisodesSidebar.textContent = totalEpisodes;
            
            // تحديث الإحصائيات في القائمة العلوية
            const favoriteCountTop = document.getElementById('favoriteCountTop');
            if (favoriteCountTop) favoriteCountTop.textContent = favoriteCount;
        }

        // إنشاء النجوم مع Tailwind CSS
        function createStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            let starsHTML = '';
            
            for (let i = 0; i < 5; i++) {
                if (i < fullStars) {
                    starsHTML += '<i class="fas fa-star text-yellow-400 drop-shadow-sm"></i>';
                } else if (i === fullStars && hasHalfStar) {
                    starsHTML += '<i class="fas fa-star-half-alt text-yellow-400 drop-shadow-sm"></i>';
                } else {
                    starsHTML += '<i class="far fa-star text-gray-300"></i>';
                }
            }
            
            return starsHTML;
        }

        // عرض الأنميات
        function displayAnimes() {
            // التحقق من أن البيانات تم تحميلها
            if (allAnimes.length === 0) {
                // البيانات لم تُحمّل بعد، عرض رسالة التحميل
                const container = document.getElementById('animeContainer');
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center min-h-[60vh] p-20 text-center bg-gradient-to-br from-white/20 via-primary-50/30 to-secondary-50/20 rounded-3xl backdrop-blur-xl border border-white/30 shadow-2xl relative overflow-hidden group">
                        <!-- تأثيرات الخلفية المتحركة -->
                        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-primary-500/20 to-transparent animate-shimmer"></div>
                        <div class="absolute inset-0 bg-gradient-to-br from-primary-400/10 via-transparent to-secondary-400/10 animate-pulse-slow"></div>
                        
                        <!-- دوائر متحركة في الخلفية -->
                        <div class="absolute top-10 left-10 w-20 h-20 bg-primary-400/20 rounded-full animate-bounce-slow"></div>
                        <div class="absolute bottom-10 right-10 w-16 h-16 bg-secondary-400/20 rounded-full animate-bounce-slow" style="animation-delay: 0.5s;"></div>
                        <div class="absolute top-1/2 left-1/4 w-12 h-12 bg-accent-400/20 rounded-full animate-pulse-slow"></div>
                        
                        <!-- النص الرئيسي -->
                        <div class="relative z-10 mb-6">
                            <!-- شعار التطبيق مع أيقونة التحميل -->
                            <div class="mb-6 text-center">
                                <div class="relative inline-block">
                                    <!-- صورة الشعار -->
                                    <img src="anime4u.png" alt="شعار أنمي 4U" class="w-20 h-20 rounded-2xl shadow-2xl hover:scale-110 transition-transform duration-500">
                                    

                                </div>
                            </div>
                            
                            <h2 class="text-3xl md:text-4xl font-black bg-gradient-to-r from-primary-600 via-secondary-600 to-accent-600 bg-clip-text text-transparent mb-2 drop-shadow-lg">
                                جاري تحميل الأنميات
                            </h2>
                            <p class="text-lg text-gray-600 font-medium opacity-80">
                                يرجى الانتظار قليلاً...
                            </p>
                        </div>
                        
                        <!-- شريط التقدم -->
                        <div class="relative z-10">
                            <div class="bg-white/20 backdrop-blur-sm px-8 py-4 rounded-2xl border border-white/30 shadow-lg">
                                <div class="flex items-center gap-3">
                                    <div class="w-4 h-4 bg-primary-500 rounded-full animate-pulse"></div>
                                    <span class="text-lg font-semibold text-gray-700 bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent">
                                        جاري التحميل...
                                    </span>
                                    <div class="w-4 h-4 bg-secondary-500 rounded-full animate-pulse" style="animation-delay: 0.3s;"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- رسالة إضافية -->
                        <div class="relative z-10 mt-6">
                            <div class="bg-gradient-to-r from-primary-100/50 to-secondary-100/50 px-6 py-3 rounded-full border border-primary-200/30">
                                <span class="text-sm font-medium text-primary-700">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    يتم تحميل البيانات من قاعدة البيانات
                                </span>
                            </div>
                        </div>
                        
                        <!-- أيقونة التحميل الرئيسية -->
                        <div class="relative z-10 mt-8">
                            <div class="relative">
                                <!-- دائرة خارجية متحركة -->
                                <div class="absolute inset-0 w-24 h-24 border-4 border-primary-200/30 rounded-full animate-spin-slow"></div>
                                <div class="absolute inset-0 w-24 h-24 border-4 border-transparent border-t-primary-500 rounded-full animate-spin"></div>
                                <div class="absolute inset-0 w-24 h-24 border-4 border-transparent border-r-secondary-500 rounded-full animate-spin" style="animation-direction: reverse; animation-duration: 2s;"></div>
                                
                                <!-- الأيقونة المركزية -->
                                <div class="w-24 h-24 bg-gradient-to-br from-primary-500 to-secondary-500 rounded-full flex items-center justify-center shadow-2xl group-hover:shadow-primary-500/50 transition-all duration-500 transform group-hover:scale-110">
                                    <i class="fas fa-spinner fa-spin text-3xl text-white drop-shadow-lg"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                return;
            }
            
            // التحقق من أن هناك نتائج بعد التصفية
            if (filteredAnimes.length === 0) {
                const container = document.getElementById('animeContainer');
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center min-h-[40vh] p-12 text-center">
                        <div class="bg-white rounded-2xl shadow-xl border border-gray-200 p-8 max-w-md">
                            <i class="fas fa-search text-5xl text-primary-500 mb-4"></i>
                            <h3 class="text-xl font-bold text-gray-800 mb-2">لا توجد أنميات مطابقة للبحث</h3>
                            <p class="text-gray-600">جرب تغيير معايير البحث أو الفلتر</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            // استخدام النظام الجديد للعرض التدريجي
            displayAnimesInBatches();
        }

        // البحث (محسن)
        function filterAnimes() {
            const inputEl = document.getElementById('searchInput');
            const searchTerm = (inputEl && typeof inputEl.value === 'string') ? inputEl.value.toLowerCase() : '';
            const activeBtn = document.querySelector('.filter-btn.active');
            const activeFilter = activeBtn && activeBtn.dataset ? activeBtn.dataset.filter : 'all';

            // إضافة تأخير للبحث لتجنب التعليق
            clearTimeout(window.searchTimeout);
            window.searchTimeout = setTimeout(() => {
                filteredAnimes = allAnimes.filter(anime => {
                    const matchesSearch = anime.name.toLowerCase().includes(searchTerm);
                    const matchesFilter = filterByType(anime, activeFilter);
                    return matchesSearch && matchesFilter;
                });

                displayAnimes();
                updateStats();
            }, 300); // تأخير 300ms للبحث
        }

        // البحث الذكي مع الاقتراحات (محسن)
        function showSearchSuggestions(searchTerm) {
            const suggestionsContainer = document.getElementById('searchSuggestions');
            
            if (!suggestionsContainer) {
                return; // العنصر غير موجود
            }
            
            if (!searchTerm.trim()) {
                suggestionsContainer.style.display = 'none';
                return;
            }

            // إضافة تأخير للبحث الذكي لتجنب التعليق
            clearTimeout(window.suggestionsTimeout);
            window.suggestionsTimeout = setTimeout(() => {
                const suggestions = allAnimes
                    .filter(anime => anime.name.toLowerCase().includes(searchTerm.toLowerCase()))
                    .slice(0, 5);

                if (suggestions.length === 0) {
                    suggestionsContainer.style.display = 'none';
                    return;
                }

                                 const suggestionsHTML = suggestions.map(anime => {
                     const sFound = (typeof findBestImage === 'function') ? findBestImage(anime.name) : null;
                     const sImage = sFound || (anime.image ? `img/${anime.image}` : '');
                     return `
                         <div class="flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition-all duration-300 border border-gray-200 hover:border-primary-300" onclick="selectSuggestion('${anime.name}')">
                             ${sImage ? `<img src="${sImage}" alt="${anime.name}" class="w-12 h-12 rounded-lg object-cover shadow-md" loading="lazy" decoding="async" onerror="this.style.display='none'">` : '<div class="w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center"><i class="fas fa-image text-gray-400"></i></div>'}
                             <span class="font-medium text-gray-800">${anime.name}</span>
                         </div>
                     `;
                 }).join('');

                const suggestionsContent = document.getElementById('searchSuggestionsContent');
                if (suggestionsContent) {
                    suggestionsContent.innerHTML = suggestionsHTML;
                }
                if (suggestionsContainer) {
                    suggestionsContainer.style.display = 'block';
                }
            }, 200); // تأخير 200ms للاقتراحات
        }

        // اختيار اقتراح
        function selectSuggestion(animeName) {
            const searchInput = document.getElementById('searchInput');
            const searchSuggestions = document.getElementById('searchSuggestions');
            
            if (searchInput) {
                searchInput.value = animeName;
            }
            
            if (searchSuggestions) {
                searchSuggestions.style.display = 'none';
            }
            
            filterAnimes();
        }

        // تصفية حسب النوع
        function filterByType(anime, filter) {
            if (filter === 'all') return true;
            
            const status = anime['حالة الأنمي'] || anime['الحالة'] || '';
            const type = anime['النوع'] || '';

            switch (filter) {
                case 'ongoing':
                    return status.includes('يعرض') || status.includes('ongoing');
                case 'completed':
                    return status.includes('مكتمل') || status.includes('completed');
                case 'movie':
                    return type.includes('Movie') || type.includes('فيلم');
                case 'favorite':
                    return favorites.includes(anime.name);
                default:
                    return true;
            }
        }

        // إيجاد الأنميات المشابهة
        function findSimilarAnimes(anime, count = 6) {
            const currentType = anime['النوع'] || '';
            const currentStatus = anime['حالة الأنمي'] || '';
            
            // إنشاء مصفوفة من جميع الأنميات (باستثناء الحالي)
            let allPossibleAnimes = allAnimes.filter(a => a.name !== anime.name);
            
            // خلط عشوائي كامل للمصفوفة
            allPossibleAnimes.sort(() => Math.random() - 0.5);
            
            // تقسيم الأنميات إلى مجموعات
            let similarAnimes = [];
            let randomAnimes = [];
            
            // تصنيف الأنميات حسب التشابه
            allPossibleAnimes.forEach(a => {
                const aType = a['النوع'] || '';
                const aStatus = a['حالة الأنمي'] || '';
                
                let similarityScore = 0;
                
                // نفس النوع
                if (aType && currentType && aType.includes(currentType)) {
                    similarityScore += 3;
                }
                
                // نفس الحالة
                if (aStatus && currentStatus && aStatus === currentStatus) {
                    similarityScore += 2;
                }
                
                // نفس عدد الحلقات تقريباً
                const currentEpisodes = anime.episodes ? anime.episodes.length : 0;
                const aEpisodes = a.episodes ? a.episodes.length : 0;
                if (Math.abs(currentEpisodes - aEpisodes) <= 5) {
                    similarityScore += 1;
                }
                
                if (similarityScore > 0) {
                    similarAnimes.push(a);
                } else {
                    randomAnimes.push(a);
                }
            });
            
            // خلط عشوائي لكل مجموعة
            similarAnimes.sort(() => Math.random() - 0.5);
            randomAnimes.sort(() => Math.random() - 0.5);
            
            // دمج النتائج مع أولوية للأنميات المشابهة
            let finalAnimes = [];
            
            // إضافة 3 أنميات مشابهة (إذا وجدت)
            finalAnimes.push(...similarAnimes.slice(0, 3));
            
            // إضافة 3 أنميات عشوائية
            finalAnimes.push(...randomAnimes.slice(0, 3));
            
            // إذا لم تكفِ الأنميات، أضف المزيد من العشوائية
            if (finalAnimes.length < count) {
                const remaining = randomAnimes.slice(3, count);
                finalAnimes.push(...remaining);
            }
            
            // خلط نهائي للنتائج
            finalAnimes.sort(() => Math.random() - 0.5);
            
            // إرجاع العدد المطلوب
            return finalAnimes.slice(0, count);
        }

        // تنظيف جميع النوافذ المنبثقة والعناصر المفتوحة
        function cleanupAllModals() {
            // إزالة جميع صفحات التفاصيل المفتوحة
            const existingDetailsPages = document.querySelectorAll('.anime-details-page');
            existingDetailsPages.forEach(page => page.remove());
            
            // إزالة جميع النوافذ المنبثقة المفتوحة
            const existingModals = document.querySelectorAll('.episode-servers-modal-overlay, .watch-episode-modal-overlay');
            existingModals.forEach(modal => modal.remove());
            
            // إزالة أي رسائل منبثقة
            const toasts = document.querySelectorAll('.like-toast');
            toasts.forEach(toast => toast.remove());
        }

        // عرض تفاصيل الأنمي
        function showAnimeDetails(animeName) {
            const anime = allAnimes.find(a => a.name === animeName);
            if (!anime) return;

            const episodes = anime.episodes || [];
            const story = anime.story || 'لا يوجد وصف متاح';
            const isFavorite = favorites.includes(anime.name);
            const status = anime['حالة الأنمي'] || '';
            const type = anime['النوع'] || '';
            const rating = 5;
            const episodeCount = anime['عدد الحلقات'] || episodes.length;
            const foundImagePath = (typeof findBestImage === 'function') ? findBestImage(anime.name) : null;
            const imagePath = foundImagePath || (anime.image ? `img/${anime.image}` : '');
            
                    // إيجاد الأنميات المشابهة (تحديث تلقائي كل مرة)
        const similarAnimes = findSimilarAnimes(anime, 6);

        // تنظيف جميع العناصر المفتوحة
        cleanupAllModals();

        // إخفاء الصفحة الرئيسية
        const container = document.querySelector('.container');
        if (container) {
            container.style.display = 'none';
        }

            // إنشاء صفحة التفاصيل
            const detailsPage = document.createElement('div');
            detailsPage.className = 'anime-details-page';
            detailsPage.innerHTML = `
                <!-- Header Section -->
                <div class="bg-gradient-to-r from-primary-500 to-secondary-500 text-white shadow-2xl">
                    <div class="max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-4 sm:py-6">
                        <div class="flex flex-col gap-4 sm:gap-6">
                            <!-- Top Row - Back Button & Action Buttons -->
                            <div class="flex items-center justify-between">
                                <button onclick="goBackToMain()" class="flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-white/20 hover:bg-white/30 rounded-xl transition-all duration-300 hover:scale-105 backdrop-blur-sm text-sm sm:text-base">
                                    <i class="fas fa-arrow-right text-base sm:text-lg"></i>
                                    <span class="font-semibold hidden xs:inline">العودة للرئيسية</span>
                                    <span class="font-semibold xs:hidden">رجوع</span>
                                </button>
                                
                                <div class="flex items-center gap-2 sm:gap-3">
                                    <button onclick="toggleLike('${anime.name}')" class="flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 bg-white/20 hover:bg-white/30 rounded-xl transition-all duration-300 hover:scale-105 backdrop-blur-sm" title="إعجاب">
                                        <i class="far fa-thumbs-up text-lg sm:text-xl"></i>
                                    </button>
                                    <button onclick="toggleFavorite('${anime.name}')" class="flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 ${isFavorite ? 'bg-red-500/80 hover:bg-red-600/80' : 'bg-white/20 hover:bg-white/30'} rounded-xl transition-all duration-300 hover:scale-105 backdrop-blur-sm" title="مفضلة">
                                        <i class="${isFavorite ? 'fas' : 'far'} fa-heart text-lg sm:text-xl"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Bottom Row - Title & Subtitle -->
                            <div class="text-center sm:text-left">
                                <h1 class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold leading-tight break-words">${anime.name}</h1>
                                <p class="text-primary-100 mt-2 text-xs sm:text-sm md:text-base opacity-90">${type || 'أنمي'} • ${status || 'غير متوفر'}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Left Column - Cover & Basic Info -->
                        <div class="lg:col-span-1">
                            <div class="sticky top-8">
                                <!-- Cover Image -->
                                <div class="bg-white rounded-2xl shadow-xl overflow-hidden mb-6">
                                    <div class="max-w-xs mx-auto">
                                        <div class="aspect-[3/4] relative overflow-hidden rounded-xl">
                                            ${imagePath ? 
                                                `<img src="${imagePath}" alt="${anime.name}" class="w-full h-full object-cover transition-transform duration-300 hover:scale-105" loading="lazy">` : 
                                                '<div class="w-full h-full bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center"><i class="fas fa-image text-4xl text-gray-400"></i></div>'
                                            }
                                            <!-- Status Badge -->
                                            <div class="absolute top-3 right-3">
                                                <span class="px-2 py-1 rounded-full text-xs font-bold ${status.includes('يعرض') ? 'bg-green-500 text-white' : 'bg-red-500 text-white'}">
                                                    ${status || 'غير متوفر'}
                                                </span>
                                            </div>
                                            <!-- Episode Count Badge -->
                                            <div class="absolute top-3 left-3">
                                                <span class="px-2 py-1 rounded-full text-xs font-bold bg-primary-500 text-white">
                                                    ${episodeCount} حلقة
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Quick Stats -->
                                <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
                                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                                        <i class="fas fa-chart-bar text-primary-500"></i>
                                        إحصائيات سريعة
                                    </h3>
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">التقييم:</span>
                                            <div class="flex items-center gap-2">
                                                <div class="flex text-yellow-400">
                                                    ${createStars(rating)}
                                                </div>
                                                <span class="font-bold text-gray-800">${rating.toFixed(1)}</span>
                                            </div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">النوع:</span>
                                            <span class="font-semibold text-gray-800">${type || 'غير محدد'}</span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">المصدر:</span>
                                            <span class="font-semibold text-gray-800">${anime['المصدر'] || 'غير محدد'}</span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">مدة الحلقة:</span>
                                            <span class="font-semibold text-gray-800">${anime['مدة الحلقة'] || 'غير محدد'}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column - Details & Episodes -->
                        <div class="lg:col-span-2">
                            <!-- Detailed Info -->
                            <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
                                <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                                    <i class="fas fa-info-circle text-primary-500"></i>
                                    معلومات مفصلة
                                </h3>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div class="space-y-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-calendar-alt text-primary-500"></i>
                                            </div>
                                            <div>
                                                <p class="text-sm text-gray-500">بداية العرض</p>
                                                <p class="font-semibold text-gray-800">${anime['بداية العرض'] || anime['سنة الإنتاج'] || 'غير محدد'}</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-leaf text-green-500"></i>
                                            </div>
                                            <div>
                                                <p class="text-sm text-gray-500">الموسم</p>
                                                <p class="font-semibold text-gray-800">${anime['الموسم'] || anime['موسم العرض'] || 'غير محدد'}</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-book text-purple-500"></i>
                                            </div>
                                            <div>
                                                <p class="text-sm text-gray-500">المصدر</p>
                                                <p class="font-semibold text-gray-800">${anime['المصدر'] || 'غير محدد'}</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="space-y-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-clock text-blue-500"></i>
                                            </div>
                                            <div>
                                                <p class="text-sm text-gray-500">مدة الحلقة</p>
                                                <p class="font-semibold text-gray-800">${anime['مدة الحلقة'] || 'غير محدد'}</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-list text-orange-500"></i>
                                            </div>
                                            <div>
                                                <p class="text-sm text-gray-500">عدد الحلقات</p>
                                                <p class="font-semibold text-gray-800">${episodeCount}</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-broadcast-tower text-red-500"></i>
                                            </div>
                                            <div>
                                                <p class="text-sm text-gray-500">الحالة</p>
                                                <p class="font-semibold text-gray-800">${status || 'غير متوفر'}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Genres Section -->
                            ${anime['التصنيفات'] || anime['الأنواع'] ? `
                            <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
                                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                    <i class="fas fa-tags text-primary-500"></i>
                                    التصنيفات
                                </h3>
                                <div class="flex flex-wrap gap-2">
                                    ${(anime['التصنيفات'] || anime['الأنواع'] || '').split(',').map(genre => 
                                        `<span class="px-3 py-1 bg-gradient-to-r from-primary-500 to-secondary-500 text-white rounded-full text-sm font-medium hover:scale-105 transition-transform duration-200 cursor-pointer">${genre.trim()}</span>`
                                    ).join('')}
                                </div>
                            </div>
                            ` : ''}

                            <!-- Story Section -->
                            <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
                                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                    <i class="fas fa-book-open text-primary-500"></i>
                                    القصة
                                </h3>
                                <p class="text-gray-700 leading-relaxed text-justify">${story}</p>
                            </div>

                    <div class="episodes-section">
                        <div class="section-header">
                            <h2><i class="fas fa-play-circle"></i> الحلقات المتاحة</h2>
                            <span class="episodes-count">${episodes.length} حلقة</span>
                        </div>
                        
                        <!-- شريط البحث عن الحلقات -->
                        <div class="episodes-search-container">
                            <div class="episodes-search-wrapper">
                                <i class="fas fa-search episodes-search-icon"></i>
                                <input 
                                    type="text" 
                                    class="episodes-search-input" 
                                    placeholder="ابحث عن حلقة معينة..."
                                    onkeyup="filterEpisodes(this.value, '${anime.name}')"
                                    onkeydown="if(event.key === 'Enter') { event.preventDefault(); filterEpisodes(this.value, '${anime.name}'); }"
                                >
                                <button class="episodes-clear-search" onclick="clearEpisodesSearch('${anime.name}')" style="display: none;">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="episodes-search-stats">
                                <span class="episodes-found-count">${episodes.length} حلقة متاحة</span>
                                <span class="episodes-filtered-count" style="display: none;">0 حلقة تم العثور عليها</span>
                            </div>
                        </div>
                        
                        <div class="episodes-scroll-container">
                            <div class="episodes-grid-enhanced" id="episodes-grid-${anime.name.replace(/\s+/g, '-')}">
                                ${episodes.length > 0 ? episodes.map(episode => `
                                    <button class="episode-circle-btn" onclick="showEpisodeServers('${anime.name}', '${episode.episode_number}')" title="مشاهدة الحلقة ${episode.episode_number}">
                                        <div class="episode-circle-icon">
                                            <i class="fas fa-play"></i>
                                        </div>
                                        <span class="episode-number-text">${episode.episode_number}</span>
                                    </button>
                                `).join('') : '<div class="no-episodes-message"><i class="fas fa-info-circle"></i> لا توجد حلقات متاحة حالياً</div>'}
                            </div>
                        </div>
                    </div>

                    <!-- قسم الأنميات المشابهة -->
                    <div class="similar-animes-section">
                        <div class="similar-animes-header">
                            <h2><i class="fas fa-thumbs-up"></i> أنميات مشابهة</h2>
                            <span class="similar-animes-count">
                                <i class="fas fa-film"></i>
                                ${similarAnimes.length} أنمي
                            </span>
                        </div>
                        
                        <div class="similar-animes-grid">
                            ${similarAnimes.map(similarAnime => {
                                const similarImagePath = (typeof findBestImage === 'function') ? findBestImage(similarAnime.name) : null;
                                const similarImage = similarImagePath || (similarAnime.image ? `img/${similarAnime.image}` : '');
                                const similarStatus = similarAnime['حالة الأنمي'] || '';
                                const similarRating = 5;
                                
                                return `
                                    <div class="similar-anime-card" onclick="window.location.href='details.html?anime=${encodeURIComponent(similarAnime.name)}'">
                                        ${similarImage ? `<img src="${similarImage}" alt="${similarAnime.name}" class="similar-anime-image" loading="lazy" onerror="this.style.display='none';">` : '<div class="no-image-large" style="height: 100%; font-size: 2rem;"><i class="fas fa-image"></i></div>'}
                                        
                                        ${similarStatus ? `
                                            <div class="similar-anime-status ${similarStatus.includes('يعرض') ? '' : 'completed'}">
                                                ${similarStatus.includes('يعرض') ? 'يعرض الآن' : 'مكتمل'}
                                            </div>
                                        ` : ''}
                                        
                                        <div class="similar-anime-overlay">
                                            <div class="similar-anime-title">${similarAnime.name}</div>
                                            <div class="similar-anime-rating">
                                                <div class="similar-anime-stars">
                                                    ${createStars(similarRating)}
                                                </div>
                                                <span class="similar-anime-rating-text">${similarRating.toFixed(1)}</span>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(detailsPage);
            
            // إضافة مستمع التمرير للحلقات
            addScrollListener(anime.name.replace(/\s+/g, '-'));
        }

        // العودة للصفحة الرئيسية
        function goBackToMain() {
            // إزالة جميع صفحات التفاصيل المفتوحة
            const detailsPages = document.querySelectorAll('.anime-details-page');
            detailsPages.forEach(page => page.remove());
            
            // إزالة جميع النوافذ المنبثقة المفتوحة
            const modals = document.querySelectorAll('.episode-servers-modal-overlay, .watch-episode-modal-overlay');
            modals.forEach(modal => modal.remove());
            
            // إظهار الصفحة الرئيسية
            const container = document.querySelector('.container');
            if (container) {
                container.style.display = 'block';
            }
            
            // إعادة تحميل البيانات إذا لزم الأمر
            if (typeof filterAnimes === 'function') {
                filterAnimes();
            }
            
            // تحديث الإحصائيات
            if (typeof updateStats === 'function') {
                updateStats();
            }
        }

        // تبديل المفضلة
        function toggleFavorite(animeName) {
            const index = favorites.indexOf(animeName);
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(animeName);
            }
            localStorage.setItem('anime4u_favorites', JSON.stringify(favorites));
            
            // تحديث حالة الزر في الواجهة
            updateFavoriteButton(animeName);
            
            filterAnimes();
            updateStats();
        }

        // تحديث حالة زر المفضلة
        function updateFavoriteButton(animeName) {
            const favoriteBtn = document.querySelector(`button[onclick="toggleFavorite('${animeName}')"]`);
            if (!favoriteBtn) return;

            const isFavorite = favorites.includes(animeName);
            
            // تحديث الأيقونة
            const icon = favoriteBtn.querySelector('i');
            if (icon) {
                icon.className = isFavorite ? 'fas fa-heart' : 'far fa-heart';
            }
            
            // تحديث الألوان
            if (isFavorite) {
                favoriteBtn.classList.remove('bg-white/20', 'hover:bg-white/30');
                favoriteBtn.classList.add('bg-red-500/80', 'hover:bg-red-600/80');
            } else {
                favoriteBtn.classList.remove('bg-red-500/80', 'hover:bg-red-600/80');
                favoriteBtn.classList.add('bg-white/20', 'hover:bg-white/30');
            }
        }

        // تبديل الإعجاب
        function toggleLike(animeName) {
            // البحث عن زر الإعجاب في الصفحة الحالية
            const likeBtn = document.querySelector(`button[onclick="toggleLike('${animeName}')"]`);
            if (!likeBtn) return;

            // تبديل حالة الإعجاب
            likeBtn.classList.toggle('active');
            
            // إظهار رسالة الإعجاب
            showLikeMessage(animeName);
            
            // حفظ حالة الإعجاب في التخزين المحلي
            const likedAnimes = JSON.parse(localStorage.getItem('anime4u_liked') || '[]');
            const index = likedAnimes.indexOf(animeName);
            
            if (index > -1) {
                likedAnimes.splice(index, 1);
            } else {
                likedAnimes.push(animeName);
            }
            
            localStorage.setItem('anime4u_liked', JSON.stringify(likedAnimes));
        }

        // إظهار رسالة الإعجاب
        function showLikeMessage(animeName) {
            // البحث عن زر الإعجاب في الصفحة الحالية
            const likeBtn = document.querySelector(`button[onclick="toggleLike('${animeName}')"]`);
            if (!likeBtn) return;

            const isLiked = likeBtn.classList.contains('active');
            const message = isLiked ? 'أعجبني!' : 'تم إلغاء الإعجاب';
            
            // إنشاء رسالة منبثقة
            const toast = document.createElement('div');
            toast.className = 'like-toast';
            toast.innerHTML = `
                <i class="fas ${isLiked ? 'fa-thumbs-up' : 'fa-thumbs-down'}"></i>
                <span>${message}</span>
            `;
            
            // إضافة الرسالة للصفحة
            document.body.appendChild(toast);
            
            // إظهار الرسالة
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            // إخفاء الرسالة بعد 3 ثواني
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        // البحث عن الحلقات
        function filterEpisodes(searchTerm, animeName) {
            const anime = allAnimes.find(a => a.name === animeName);
            if (!anime || !anime.episodes) return;

            const episodesGrid = document.getElementById(`episodes-grid-${animeName.replace(/\s+/g, '-')}`);
            const episodeButtons = episodesGrid.querySelectorAll('.episode-circle-btn');
            const clearButton = document.querySelector('.episodes-clear-search');
            const foundCount = document.querySelector('.episodes-found-count');
            const filteredCount = document.querySelector('.episodes-filtered-count');
            
            if (!episodesGrid) return;

            let visibleCount = 0;
            const searchLower = searchTerm.toLowerCase().trim();

            episodeButtons.forEach(button => {
                const episodeNumberElement = button.querySelector('.episode-number-text');
                if (!episodeNumberElement) {
                    return;
                }
                
                const episodeNumber = episodeNumberElement.textContent;
                const episodeTitle = `الحلقة ${episodeNumber}`;
                
                if (searchLower === '' || 
                    episodeNumber.includes(searchTerm) || 
                    episodeTitle.toLowerCase().includes(searchLower)) {
                    button.style.display = 'flex';
                    visibleCount++;
                } else {
                    button.style.display = 'none';
                }
            });

            // تحديث الإحصائيات
            if (searchTerm.trim() !== '') {
                foundCount.style.display = 'none';
                filteredCount.style.display = 'block';
                filteredCount.textContent = `${visibleCount} حلقة تم العثور عليها`;
                filteredCount.classList.add('active');
                clearButton.style.display = 'flex';
            } else {
                foundCount.style.display = 'block';
                filteredCount.style.display = 'none';
                filteredCount.classList.remove('active');
                clearButton.style.display = 'none';
            }

            // إظهار رسالة إذا لم يتم العثور على نتائج
            const noResultsMessage = episodesGrid.querySelector('.no-results-message');
            if (visibleCount === 0 && searchTerm.trim() !== '') {
                if (!noResultsMessage) {
                    const message = document.createElement('div');
                    message.className = 'no-results-message';
                    message.innerHTML = `
                        <i class="fas fa-search"></i>
                        <p>لم يتم العثور على حلقة تحتوي على "${searchTerm}"</p>
                        <button class="clear-search-btn" onclick="clearEpisodesSearch('${animeName}')">
                            <i class="fas fa-times"></i>
                            مسح البحث
                        </button>
                    `;
                    episodesGrid.appendChild(message);
                }
            } else if (noResultsMessage) {
                noResultsMessage.remove();
            }
        }

        // مسح البحث عن الحلقات
        function clearEpisodesSearch(animeName) {
            const searchInput = document.querySelector('.episodes-search-input');
            const clearButton = document.querySelector('.episodes-clear-search');
            const foundCount = document.querySelector('.episodes-found-count');
            const filteredCount = document.querySelector('.episodes-filtered-count');
            
            if (searchInput) {
                searchInput.value = '';
                searchInput.focus();
            }
            
            if (clearButton) clearButton.style.display = 'none';
            if (foundCount) foundCount.style.display = 'block';
            if (filteredCount) {
                filteredCount.style.display = 'none';
                filteredCount.classList.remove('active');
            }
            
            // إعادة عرض جميع الحلقات
            const episodesGrid = document.getElementById(`episodes-grid-${animeName.replace(/\s+/g, '-')}`);
            if (episodesGrid) {
                const episodeButtons = episodesGrid.querySelectorAll('.episode-circle-btn');
                episodeButtons.forEach(button => {
                    button.style.display = 'flex';
                });
            }
            
            // إزالة رسالة عدم وجود نتائج
            const noResultsMessage = episodesGrid.querySelector('.no-results-message');
            if (noResultsMessage) {
                noResultsMessage.remove();
            }
        }

        // تمرير الحلقات يميناً ويساراً
        function scrollEpisodes(animeId, direction) {
            const episodesGrid = document.getElementById(`episodes-grid-${animeId}`);
            if (!episodesGrid) return;

            const scrollAmount = 300; // مقدار التمرير بالبكسل
            const currentScroll = episodesGrid.scrollLeft;
            let newScroll;
            
            if (direction === 'left') {
                newScroll = Math.max(0, currentScroll - scrollAmount);
            } else if (direction === 'right') {
                const maxScroll = episodesGrid.scrollWidth - episodesGrid.clientWidth;
                newScroll = Math.min(maxScroll, currentScroll + scrollAmount);
            } else {
                return;
            }

            // استخدام scrollLeft مباشرة مع انيميشن سلس
            animateScroll(episodesGrid, currentScroll, newScroll);

            // تحديث حالة أزرار التمرير
            setTimeout(() => {
                updateScrollButtons(animeId);
            }, 300);
        }

        // انيميشن التمرير السلس
        function animateScroll(element, start, end) {
            const duration = 300;
            const startTime = performance.now();
            
            function animate(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // دالة التسهيل (easing function)
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                
                const currentScroll = start + (end - start) * easeOutQuart;
                element.scrollLeft = currentScroll;
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                }
            }
            
            requestAnimationFrame(animate);
        }

        // تحديث حالة أزرار التمرير
        function updateScrollButtons(animeId) {
            const episodesGrid = document.getElementById(`episodes-grid-${animeId}`);
            if (!episodesGrid) return;

            const leftBtn = episodesGrid.parentElement.querySelector('.episodes-scroll-left');
            const rightBtn = episodesGrid.parentElement.querySelector('.episodes-scroll-right');
            
            if (leftBtn && rightBtn) {
                const currentScroll = episodesGrid.scrollLeft;
                const maxScroll = episodesGrid.scrollWidth - episodesGrid.clientWidth;
                
                // تعطيل زر اليسار إذا كنا في البداية
                leftBtn.disabled = currentScroll <= 5; // هامش صغير للدقة
                
                // تعطيل زر اليمين إذا وصلنا للنهاية
                rightBtn.disabled = currentScroll >= (maxScroll - 5); // هامش صغير للدقة
                
                // إضافة تأثيرات بصرية للأزرار المعطلة
                if (leftBtn.disabled) {
                    leftBtn.style.opacity = '0.5';
                    leftBtn.style.cursor = 'not-allowed';
                } else {
                    leftBtn.style.opacity = '1';
                    leftBtn.style.cursor = 'pointer';
                }
                
                if (rightBtn.disabled) {
                    rightBtn.style.opacity = '0.5';
                    rightBtn.style.cursor = 'not-allowed';
                } else {
                    rightBtn.style.opacity = '1';
                    rightBtn.style.cursor = 'pointer';
                }
            }
        }

        // إضافة مستمع لحدث التمرير لتحديث الأزرار
        function addScrollListener(animeId) {
            const episodesGrid = document.getElementById(`episodes-grid-${animeId}`);
            if (!episodesGrid) return;

            // إضافة مستمع التمرير
            episodesGrid.addEventListener('scroll', () => {
                updateScrollButtons(animeId);
            });

            // إضافة مستمع تغيير الحجم
            window.addEventListener('resize', () => {
                updateScrollButtons(animeId);
            });

            // تحديث الأزرار عند التحميل
            setTimeout(() => {
                updateScrollButtons(animeId);
            }, 200);

            // تحديث إضافي بعد تحميل الصور
            setTimeout(() => {
                updateScrollButtons(animeId);
            }, 1000);

            // إضافة دعم التمرير باللمس للأجهزة المحمولة
            addTouchScrollSupport(episodesGrid, animeId);
        }

        // دعم التمرير باللمس للأجهزة المحمولة
        function addTouchScrollSupport(element, animeId) {
            let startX = 0;
            let startY = 0;
            let isScrolling = false;

            element.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                isScrolling = false;
            });

            element.addEventListener('touchmove', (e) => {
                if (!isScrolling) {
                    const deltaX = Math.abs(e.touches[0].clientX - startX);
                    const deltaY = Math.abs(e.touches[0].clientY - startY);
                    
                    if (deltaX > deltaY && deltaX > 10) {
                        isScrolling = true;
                        e.preventDefault();
                    }
                }
            });

            element.addEventListener('touchend', () => {
                setTimeout(() => {
                    updateScrollButtons(animeId);
                }, 100);
            });
        }

        // عرض سيرفرات الحلقة
        function showEpisodeServers(animeName, episodeNumber) {
            const anime = allAnimes.find(a => a.name === animeName);
            if (!anime) return;

            const episode = anime.episodes.find(ep => ep.episode_number === episodeNumber);
            if (!episode) return;

            const servers = episode.watch_servers || [];
            const foundImagePath = (typeof findBestImage === 'function') ? findBestImage(anime.name) : null;
            const imagePath = foundImagePath || (anime.image ? `img/${anime.image}` : '');

            const modal = document.createElement('div');
            modal.className = 'episode-servers-modal-overlay';
            
            let serversHTML = '';
            if (servers.length > 0) {
                serversHTML = servers.map(server => `
                    <div class="server-item" onclick="watchEpisode('${animeName}', '${episodeNumber}', '${server.url}', '${server.name}')">
                        <div class="server-info">
                            <div class="server-icon ${getServerIconClass(server.name)}">
                                <i class="${getServerIcon(server.name)}"></i>
                            </div>
                            <div class="server-details">
                                <h4 class="server-name">${server.name}</h4>
                                <p class="server-description">${getServerDescription(server.name)}</p>
                                <div class="server-features">
                                    ${getServerFeatures(server.name)}
                                </div>
                            </div>
                        </div>
                        <div class="server-action">
                            <button class="watch-server-btn" onclick="event.stopPropagation(); watchEpisode('${animeName}', '${episodeNumber}', '${server.url}', '${server.name}')">
                                <i class="fas fa-play-circle"></i>
                                <span>مشاهدة</span>
                            </button>
                        </div>
                    </div>
                `).join('');
            } else {
                serversHTML = '<div class="no-servers"><i class="fas fa-info-circle"></i><p>لا توجد سيرفرات متاحة لهذه الحلقة</p></div>';
            }

            modal.innerHTML = `
                <div class="episode-servers-modal">
                    <div class="episode-servers-header">
                        <div class="episode-info">
                            <div class="episode-cover">
                                ${imagePath ? `<img src="${imagePath}" alt="${animeName}" loading="lazy">` : '<div class="no-image"><i class="fas fa-image"></i></div>'}
                            </div>
                            <div class="episode-details">
                                <h2 class="anime-title">${animeName}</h2>
                                <div class="episode-number-badge">
                                    <i class="fas fa-play-circle"></i>
                                    <span>الحلقة ${episodeNumber}</span>
                                </div>
                                <div class="episode-meta">
                                    <span class="episode-servers-count">
                                        <i class="fas fa-server"></i>
                                        ${servers.length} سيرفر متاح
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="servers-list">
                        ${serversHTML}
                    </div>
                    <button class="close-modal-btn" onclick="closeServersModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;

            document.body.appendChild(modal);
            
            // إغلاق النافذة عند النقر خارجها
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeServersModal();
                }
            });

            // إغلاق النافذة عند الضغط على Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeServersModal();
                }
            });
        }

        // الحصول على أيقونة السيرفر
        function getServerIcon(serverName) {
            const name = serverName.toLowerCase();
            if (name.includes('mega')) return 'fas fa-bolt';
            if (name.includes('vk')) return 'fab fa-vk';
            if (name.includes('videa')) return 'fas fa-video';
            if (name.includes('voe')) return 'fas fa-play';
            if (name.includes('max')) return 'fas fa-fire';
            return 'fas fa-server';
        }

        // الحصول على فئة أيقونة السيرفر
        function getServerIconClass(serverName) {
            const name = serverName.toLowerCase();
            if (name.includes('mega')) return 'mega-server';
            if (name.includes('vk')) return 'vk-server';
            if (name.includes('videa')) return 'videa-server';
            if (name.includes('voe')) return 'voe-server';
            if (name.includes('max')) return 'max-server';
            return 'default-server';
        }

        // الحصول على وصف السيرفر
        function getServerDescription(serverName) {
            const name = serverName.toLowerCase();
            if (name.includes('mega')) return 'سيرفر سريع بدون إعلانات';
            if (name.includes('vk')) return 'سيرفر روسي مستقر';
            if (name.includes('videa')) return 'سيرفر مجاني عالي الجودة';
            if (name.includes('voe')) return 'سيرفر سهل الاستخدام';
            if (name.includes('max')) return 'سيرفر عالي السرعة';
            return 'سيرفر مشاهدة';
        }

        // الحصول على ميزات السيرفر
        function getServerFeatures(serverName) {
            const name = serverName.toLowerCase();
            let features = [];
            
            if (name.includes('mega') || name.includes('max')) {
                features.push('<span class="feature-badge no-ads"><i class="fas fa-shield-alt"></i> بدون إعلانات</span>');
                features.push('<span class="feature-badge hd"><i class="fas fa-hd-video"></i> HD</span>');
            }
            if (name.includes('vk')) {
                features.push('<span class="feature-badge stable"><i class="fas fa-check-circle"></i> مستقر</span>');
            }
            if (name.includes('videa')) {
                features.push('<span class="feature-badge free"><i class="fas fa-gift"></i> مجاني</span>');
            }
            if (name.includes('voe')) {
                features.push('<span class="feature-badge easy"><i class="fas fa-thumbs-up"></i> سهل الاستخدام</span>');
            }
            
            return features.join('');
        }

        // دالة إغلاق نافذة السيرفرات
        function closeServersModal() {
            const modal = document.querySelector('.episode-servers-modal-overlay');
            if (modal) {
                modal.remove();
            }
        }

        // مشاهدة الحلقة داخل الموقع
        function watchEpisode(animeName, episodeNumber, serverUrl, serverName) {
            const anime = allAnimes.find(a => a.name === animeName);
            if (!anime) return;

            const episode = anime.episodes.find(ep => ep.episode_number === episodeNumber);
            if (!episode) return;

            // إغلاق نافذة السيرفرات
            const serversModal = document.querySelector('.episode-servers-modal-overlay');
            if (serversModal) {
                serversModal.remove();
            }

            // إنشاء نافذة المشاهدة
            const watchModal = document.createElement('div');
            watchModal.className = 'watch-episode-modal-overlay';
            
            watchModal.innerHTML = `
                <div class="watch-episode-modal">
                    <button class="close-modal-btn watch-close-btn" onclick="closeWatchModal()" title="إغلاق">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <div class="watch-episode-header">
                        <div class="episode-info">
                            <div class="episode-title-section">
                                <h2>${animeName}</h2>
                                <div class="episode-meta">
                                    <span class="episode-number-badge">الحلقة ${episodeNumber}</span>
                                    <span class="server-name-badge">${serverName}</span>
                                </div>
                            </div>
                        </div>
                        <div class="episode-actions">
                            <button class="btn-secondary change-server-btn" onclick="changeServer('${animeName}', '${episodeNumber}')">
                                <i class="fas fa-exchange-alt"></i>
                                <span class="btn-text">تغيير السيرفر</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="watch-episode-content">
                        <div class="video-container">
                            <div class="video-placeholder">
                                <i class="fas fa-play-circle"></i>
                                <p>جاري تحميل الفيديو...</p>
                            </div>
                            <iframe src="${serverUrl}" 
                                    frameborder="0" 
                                    allowfullscreen 
                                    allow="autoplay; encrypted-media; picture-in-picture"
                                    class="episode-video"
                                    onload="this.previousElementSibling.style.display='none'; this.style.display='block';">
                            </iframe>
                        </div>
                        
                        <div class="episode-controls">
                            <div class="episode-navigation">
                                <button class="btn-nav prev-episode" onclick="navigateEpisode('${animeName}', '${episodeNumber}', 'prev')" ${episodeNumber <= 1 ? 'disabled' : ''}>
                                    <i class="fas fa-chevron-left"></i>
                                    <span class="btn-text">الحلقة السابقة</span>
                                </button>
                                <button class="btn-nav next-episode" onclick="navigateEpisode('${animeName}', '${episodeNumber}', 'next')" ${episodeNumber >= (anime.episodes ? anime.episodes.length : 0) ? 'disabled' : ''}>
                                    <span class="btn-text">الحلقة التالية</span>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            
                            <div class="episode-info-panel">
                                <div class="episode-stats">
                                    <div class="stat-item">
                                        <i class="fas fa-list"></i>
                                        <span>الحلقة ${episodeNumber} من ${anime.episodes ? anime.episodes.length : 0}</span>
                                    </div>
                                    <div class="stat-item">
                                        <i class="fas fa-server"></i>
                                        <span>السيرفر: ${serverName}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(watchModal);
            
            // إغلاق النافذة عند الضغط على Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeWatchModal();
                }
            });
        }

        // تغيير السيرفر
        function changeServer(animeName, episodeNumber) {
            // إغلاق نافذة المشاهدة الحالية
            const watchModal = document.querySelector('.watch-episode-modal-overlay');
            if (watchModal) {
                watchModal.remove();
            }

            // عرض سيرفرات الحلقة
            showEpisodeServers(animeName, episodeNumber);
        }

        // إغلاق نافذة المشاهدة
        function closeWatchModal() {
            const watchModal = document.querySelector('.watch-episode-modal-overlay');
            if (watchModal) {
                watchModal.remove();
            }
        }

        // التنقل بين الحلقات
        function navigateEpisode(animeName, currentEpisode, direction) {
            const anime = allAnimes.find(a => a.name === animeName);
            if (!anime || !anime.episodes) return;

            const currentIndex = anime.episodes.findIndex(ep => ep.episode_number === currentEpisode);
            if (currentIndex === -1) return;

            let targetEpisode;
            if (direction === 'prev' && currentIndex > 0) {
                targetEpisode = anime.episodes[currentIndex - 1];
            } else if (direction === 'next' && currentIndex < anime.episodes.length - 1) {
                targetEpisode = anime.episodes[currentIndex + 1];
            } else {
                return;
            }

            // إغلاق نافذة المشاهدة الحالية
            const watchModal = document.querySelector('.watch-episode-modal-overlay');
            if (watchModal) {
                watchModal.remove();
            }

            // عرض سيرفرات الحلقة الجديدة
            showEpisodeServers(animeName, targetEpisode.episode_number);
        }

        // فتح سيرفر المشاهدة
        function openServer(url) {
            if (url && url !== '#') {
                window.open(url, '_blank');
            }
        }

        // مراقبة حالة الاتصال بالإنترنت
        window.addEventListener('online', function() {
            showToast('تم استعادة الاتصال بالإنترنت!', 'success');
            loadAnimeData();
        });

        window.addEventListener('offline', function() {
            showToast('انقطع الاتصال بالإنترنت', 'error');
            showNoInternetPage();
        });

        // إعداد الأحداث
        document.addEventListener('DOMContentLoaded', () => {
            // فحص حالة المستخدم
            checkUserStatus();
            
            // تحميل البيانات مع تأخير لتجنب التعليق
            setTimeout(() => {
                // استعادة الفلتر قبل التحميل لضمان عرض صحيح مبدئياً
                const savedFilter = (function(){
                    try { return localStorage.getItem('anime4u_active_filter'); } catch(_) { return null; }
                })();
                if (savedFilter) {
                    const toActivate = document.querySelector(`.filter-btn[data-filter="${savedFilter}"]`);
                    if (toActivate) {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        toActivate.classList.add('active');
                    }
                }
                loadAnimeData();
                
                // فحص حالة المستخدم بعد تحميل البيانات
                setTimeout(() => {
                    checkUserStatus();
                }, 200);
            }, 100);

            // تقرير اختياري في وحدة التحكم للصور المفقودة بعد تحميل البيانات (مؤجل)
            if (typeof generateMissingImagesReport === 'function') {
                setTimeout(() => {
                    try { generateMissingImagesReport(allAnimes); } catch (e) {}
                }, 5000); // تأخير أطول لتجنب التعليق
            }

            // البحث مع الاقتراحات (ضمن نافذة البحث)
            const searchInput = document.getElementById('searchInput');
            const clearSearchBtn = document.getElementById('clearSearch');
            
            if (searchInput) {
                // البحث عند الكتابة
                searchInput.addEventListener('input', (e) => {
                    const value = e.target.value;
                    filterAnimes();
                    if (clearSearchBtn) {
                        if (value.trim()) {
                            clearSearchBtn.style.display = 'block';
                            showSearchSuggestions(value);
                        } else {
                            clearSearchBtn.style.display = 'none';
                            const searchSuggestions = document.getElementById('searchSuggestions');
                            if (searchSuggestions) {
                                searchSuggestions.style.display = 'none';
                            }
                        }
                    }
                });
                
                // البحث عند الضغط على Enter
                searchInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault(); // منع السلوك الافتراضي
                        const value = e.target.value.trim();
                        
                        if (value) {
                            console.log('🔍 البحث عن:', value);
                            
                            // تطبيق البحث
                            filterAnimes();
                            
                            // إخفاء الاقتراحات
                            const searchSuggestions = document.getElementById('searchSuggestions');
                            if (searchSuggestions) {
                                searchSuggestions.style.display = 'none';
                            }
                            

                            
                            // تمرير للصفحة الرئيسية إذا لم تكن موجودة
                            const container = document.querySelector('.container');
                            if (container && container.style.display === 'none') {
                                goBackToMain();
                            }
                            
                            // إضافة تأثير بصري للنتائج
                            const results = document.querySelectorAll('.anime-card');
                            results.forEach((card, index) => {
                                setTimeout(() => {
                                    card.style.transform = 'scale(1.05)';
                                    card.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.2)';
                                    
                                    setTimeout(() => {
                                        card.style.transform = 'scale(1)';
                                        card.style.boxShadow = '';
                                    }, 200);
                                }, index * 100);
                            });
                        }
                    }
                });
            }

            // زر مسح البحث
            if (clearSearchBtn && searchInput) {
                clearSearchBtn.addEventListener('click', () => {
                    searchInput.value = '';
                    clearSearchBtn.style.display = 'none';
                    const searchSuggestions = document.getElementById('searchSuggestions');
                    if (searchSuggestions) {
                        searchSuggestions.style.display = 'none';
                    }
                    filterAnimes();
                });
            }

            // إخفاء الاقتراحات عند النقر خارجها
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.search-container')) {
                    const searchSuggestions = document.getElementById('searchSuggestions');
                    if (searchSuggestions) {
                        searchSuggestions.style.display = 'none';
                    }
                }
            });

            // الفلاتر مع إغلاق القائمة الجانبية + حفظ الفلتر المختار
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    // إزالة الفئة النشطة من جميع الأزرار
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    
                    // إضافة الفئة النشطة للزر المختار
                    e.currentTarget.classList.add('active');

                    // حفظ الفلتر النشط في التخزين المحلي
                    const selectedFilter = e.currentTarget.getAttribute('data-filter');
                    try { localStorage.setItem('anime4u_active_filter', selectedFilter); } catch(_) {}
                    
                    // تطبيق الفلتر
                    filterAnimes();
                    
                    // إغلاق القائمة الجانبية بعد اختيار الفلتر
                    setTimeout(() => {
                        closeSidebar();
                    }, 300); // تأخير بسيط لرؤية التأثير
                });
            });

            // استعادة الفلتر النشط من التخزين المحلي (إن وجد)
            const savedFilter = (function(){
                try { return localStorage.getItem('anime4u_active_filter'); } catch(_) { return null; }
            })();
            if (savedFilter) {
                const toActivate = document.querySelector(`.filter-btn[data-filter="${savedFilter}"]`);
                if (toActivate) {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    toActivate.classList.add('active');
                    // تطبيق الفلترة فوراً إن كانت البيانات جاهزة
                    try { filterAnimes(); } catch(_) {}
                }
            }

            // تحميل المفضلة من التخزين المحلي
            updateStats();

            // دالة تحديد الفلتر النشط
            function highlightActiveFilter() {
                // البحث عن الفلتر النشط في القائمة الرئيسية
                const activeFilterMain = document.querySelector('.filter-btn.active');
                if (activeFilterMain) {
                    const filterType = activeFilterMain.getAttribute('data-filter');
                    
                    // تحديد الفلتر المقابل في القائمة الجانبية
                    const sidebarFilter = document.querySelector(`#sidebar .filter-btn[data-filter="${filterType}"]`);
                    if (sidebarFilter) {
                        // إزالة الفئة النشطة من جميع الأزرار
                        document.querySelectorAll('#sidebar .filter-btn').forEach(btn => btn.classList.remove('active'));
                        
                        // إضافة الفئة النشطة للزر المقابل
                        sidebarFilter.classList.add('active');
                    }
                }
            }
            
            // دالة إغلاق القائمة الجانبية (عامة)
            function closeSidebar() {
                const sidebar = document.getElementById('sidebar');
                const backdrop = document.getElementById('sidebarBackdrop');
                
                if (sidebar) {
                    sidebar.classList.remove('translate-x-0');
                    sidebar.classList.add('translate-x-full');
                }
                
                if (backdrop) {
                    backdrop.classList.remove('opacity-100', 'pointer-events-auto');
                    backdrop.classList.add('opacity-0', 'pointer-events-none');
                }
            }
            
            // دالة فتح القائمة الجانبية (عامة)
            function openSidebar() {
                const sidebar = document.getElementById('sidebar');
                const backdrop = document.getElementById('sidebarBackdrop');
                
                if (sidebar) {
                    sidebar.classList.remove('translate-x-full');
                    sidebar.classList.add('translate-x-0');
                }
                
                if (backdrop) {
                    backdrop.classList.remove('opacity-0', 'pointer-events-none');
                    backdrop.classList.add('opacity-100', 'pointer-events-auto');
                }
                
                // تحديد الفلتر النشط الحالي
                highlightActiveFilter();
            }
            
            // فتح/إغلاق القائمة الجانبية المحسنة
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.getElementById('sidebarBackdrop');
            const openBtn = document.getElementById('openSidebar');
            const closeBtn = document.getElementById('closeSidebar');
            
            if (openBtn && closeBtn && sidebar && backdrop) {
                openBtn.addEventListener('click', openSidebar);
                closeBtn.addEventListener('click', closeSidebar);
                backdrop.addEventListener('click', closeSidebar);
                
                // إغلاق القائمة عند الضغط على ESC
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        closeSidebar();
                    }
                });
            }


        });


        
        // دالة محسنة للبحث عن صورة الأنمي
        function findAnimeImage(animeName) {
            // محاولة أولى باستخدام findBestImage المحسن
            if (typeof findBestImage === 'function') {
                const result = findBestImage(animeName);
                if (result) {
                    console.log(`✅ تم العثور على صورة لـ "${animeName}": ${result}`);
                    return result;
                }
            }
            
            // محاولة ثانية باستخدام findAlternativeImage
            if (typeof findAlternativeImage === 'function') {
                const result = findAlternativeImage(animeName);
                if (result) {
                    console.log(`🔄 تم العثور على صورة بديلة لـ "${animeName}": ${result}`);
                    return result;
                }
            }
            
            // محاولة ثالثة بالبحث المباشر
            if (typeof allImages !== 'undefined') {
                const cleanName = animeName.toLowerCase().replace(/[^a-z0-9]/g, '');
                for (const img of allImages) {
                    const imgName = img.toLowerCase().replace(/[^a-z0-9]/g, '');
                    if (imgName.includes(cleanName) && cleanName.length > 3) {
                        const result = 'img/' + img;
                        console.log(`🔍 تم العثور على صورة بالبحث المباشر لـ "${animeName}": ${result}`);
                        return result;
                    }
                }
            }
            
            console.log(`❌ لم يتم العثور على صورة لـ "${animeName}"`);
            return null;
        }

        // دالة فحص حالة المستخدم
        function checkUserStatus() {
            const userData = localStorage.getItem('anime4u_user');
            if (userData) {
                try {
                    const user = JSON.parse(userData);
                    if (user.isLoggedIn) {
                        showUserInfo(user);
                    } else {
                        showLoginSection();
                    }
                } catch (e) {
                    console.error('خطأ في قراءة بيانات المستخدم:', e);
                    showLoginSection();
                }
            } else {
                showLoginSection();
            }
        }

        // دالة إظهار معلومات المستخدم
        function showUserInfo(user) {
            const userInfo = document.getElementById('userInfo');
            const loginSection = document.getElementById('loginSection');
            const adminPanelBtn = document.getElementById('adminPanelBtn');
            const adminPanelBtnUserInfo = document.getElementById('adminPanelBtnUserInfo');
            
            if (userInfo && loginSection) {
                // إظهار معلومات المستخدم
                userInfo.style.display = 'block';
                loginSection.style.display = 'none';
                
                // تحديث البيانات
                const usernameEl = document.getElementById('userUsername');
                const emailEl = document.getElementById('userEmail');
                const profileImageEl = document.getElementById('userProfileImage');
                
                if (usernameEl) usernameEl.textContent = user.username || 'مستخدم';
                if (emailEl) emailEl.textContent = user.email || '';
                if (profileImageEl && user.profileImage) {
                    profileImageEl.src = user.profileImage;
                }
                
                // إظهار زر لوحة التحكم للأدمن في كلا المكانين
                if (user.isAdmin) {
                    if (adminPanelBtn) adminPanelBtn.style.display = 'block';
                    if (adminPanelBtnUserInfo) adminPanelBtnUserInfo.style.display = 'block';
                }
            }
        }

        // دالة إظهار قسم تسجيل الدخول
        function showLoginSection() {
            const userInfo = document.getElementById('userInfo');
            const loginSection = document.getElementById('loginSection');
            const adminPanelBtn = document.getElementById('adminPanelBtn');
            const adminPanelBtnUserInfo = document.getElementById('adminPanelBtnUserInfo');
            
            if (userInfo && loginSection) {
                userInfo.style.display = 'none';
                loginSection.style.display = 'block';
                
                // إخفاء زر لوحة التحكم في كلا المكانين
                if (adminPanelBtn) adminPanelBtn.style.display = 'none';
                if (adminPanelBtnUserInfo) adminPanelBtnUserInfo.style.display = 'none';
            }
        }

        // دالة تسجيل الخروج
        function logout() {
            localStorage.removeItem('anime4u_user');
            showLoginSection();
            
            // إظهار رسالة تأكيد
            if (typeof showNotification === 'function') {
                showNotification('تم تسجيل الخروج بنجاح', 'success');
            } else {
                alert('تم تسجيل الخروج بنجاح');
            }
        }

        // دالة إظهار إشعار (إذا لم تكن موجودة)
        if (typeof showNotification === 'undefined') {
            function showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `fixed top-4 left-4 z-50 p-4 rounded-lg text-white font-semibold transition-all duration-300 ${
                    type === 'success' ? 'bg-green-500' : 
                    type === 'error' ? 'bg-red-500' : 
                    'bg-blue-500'
                }`;
                notification.textContent = message;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.opacity = '0';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
        }

        // دعم Unity Ads المحسن
        window.showInterstitialAd = function() {
            if (window.unityAdsManager) {
                return window.unityAdsManager.showInterstitialAd();
            } else if (typeof UnityAds !== 'undefined' && UnityAds.showInterstitialAd) {
                UnityAds.showInterstitialAd();
            } else {
                console.log('Unity Ads not available');
                return false;
            }
        };

        window.showRewardedAd = function() {
            if (window.unityAdsManager) {
                return window.unityAdsManager.showRewardedAd();
            } else if (typeof UnityAds !== 'undefined' && UnityAds.showRewardedAd) {
                UnityAds.showRewardedAd();
            } else {
                console.log('Unity Ads not available');
                return false;
            }
        };

        window.rewardUser = function() {
            // منح المكافأة للمستخدم
            if (window.appManager) {
                window.appManager.showNotification('تم منحك مكافأة! 🎉', 'success');
            } else {
                showNotification('تم منحك مكافأة! 🎉', 'success');
            }
            // يمكن إضافة المزيد من المنطق هنا
        };

        // عرض إعلان عند تحميل الصفحة
        setTimeout(() => {
            if (window.unityAdsManager && window.unityAdsManager.isAdReady('interstitial')) {
                window.showInterstitialAd();
            } else if (typeof UnityAds !== 'undefined' && UnityAds.isAdsInitialized && UnityAds.isAdsInitialized()) {
                window.showInterstitialAd();
            }
        }, 3000);

        // إضافة أزرار الإعلانات المكافئة
        function addRewardedAdButtons() {
            const animeCards = document.querySelectorAll('.anime-card');
            animeCards.forEach((card, index) => {
                if (index % 3 === 0) { // كل 3 بطاقات
                    const rewardButton = document.createElement('button');
                    rewardButton.className = 'absolute top-2 right-2 bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-2 py-1 rounded-full text-xs font-bold shadow-lg transform hover:scale-105 transition-all duration-200';
                    rewardButton.innerHTML = '<i class="fas fa-gift mr-1"></i>مكافأة';
                    rewardButton.onclick = function(e) {
                        e.stopPropagation();
                        if (window.showRewardedAd()) {
                            console.log('Showing rewarded ad');
                        } else {
                            showNotification('الإعلان غير متوفر حالياً', 'warning');
                        }
                    };
                    card.appendChild(rewardButton);
                }
            });
        }

        // استدعاء دالة إضافة أزرار الإعلانات المكافئة
        setTimeout(addRewardedAdButtons, 2000);
    </script>
</body>
</html>
